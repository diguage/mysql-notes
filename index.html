<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<meta name="author" content="Dç“œå“¥">
<title>MySQL å­¦ä¹ ç¬”è®°</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>MySQL å­¦ä¹ ç¬”è®°</h1>
<div class="details">
<span id="author" class="author">Dç“œå“¥</span><br>
<span id="email" class="email"><a href="http://www.diguage.com/" class="bare">http://www.diguage.com/</a></span><br>
<span id="revnumber">version 0.1.0,</span>
<span id="revdate">2016-12-11</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">ç›®å½•</div>
<ul class="sectlevel1">
<li><a href="#_å‰è¨€">å‰è¨€</a>
<ul class="sectlevel2">
<li><a href="#_å‹æƒ…æ”¯æŒ">å‹æƒ…æ”¯æŒ</a></li>
<li><a href="#_å®˜ç½‘åŠç‰ˆæœ¬åº“">å®˜ç½‘åŠç‰ˆæœ¬åº“</a></li>
<li><a href="#_ç‰¹åˆ«æé†’">ç‰¹åˆ«æé†’</a></li>
</ul>
</li>
<li><a href="#_schema_è®¾è®¡">1. Schema è®¾è®¡</a>
<ul class="sectlevel2">
<li><a href="#_æ•°æ®ç±»å‹çš„é€‰æ‹©">1.1. æ•°æ®ç±»å‹çš„é€‰æ‹©</a>
<ul class="sectlevel3">
<li><a href="#_æ•´æ•°">1.1.1. æ•´æ•°</a></li>
<li><a href="#_å®æ•°">1.1.2. å®æ•°</a></li>
<li><a href="#_å­—ç¬¦ä¸²ç±»å‹">1.1.3. å­—ç¬¦ä¸²ç±»å‹</a>
<ul class="sectlevel4">
<li><a href="#_blobå’Œtext_ç±»å‹">1.1.3.1. BLOBå’ŒTEXT ç±»å‹</a></li>
<li><a href="#_ä½¿ç”¨æšä¸¾_enum_ä»£æ›¿å­—ç¬¦ä¸²">1.1.3.2. ä½¿ç”¨æšä¸¾ï¼ˆENUMï¼‰ä»£æ›¿å­—ç¬¦ä¸²</a></li>
</ul>
</li>
<li><a href="#_æ—¥æœŸå’Œæ—¶é—´ç±»å‹">1.1.4. æ—¥æœŸå’Œæ—¶é—´ç±»å‹</a></li>
<li><a href="#_ä½æ•°æ®ç±»å‹">1.1.5. ä½æ•°æ®ç±»å‹</a></li>
<li><a href="#_é€‰æ‹©æ ‡è¯†ç¬¦_é”®åˆ—">1.1.6. é€‰æ‹©æ ‡è¯†ç¬¦ï¼ˆé”®åˆ—ï¼‰</a></li>
<li><a href="#_ç‰¹æ®Šç±»å‹æ•°æ®">1.1.7. ç‰¹æ®Šç±»å‹æ•°æ®</a></li>
</ul>
</li>
<li><a href="#_mysql_schema_è®¾è®¡ä¸­çš„é™·é˜±">1.2. MySQL Schema è®¾è®¡ä¸­çš„é™·é˜±</a></li>
<li><a href="#_èŒƒå¼å’ŒåèŒƒå¼">1.3. èŒƒå¼å’ŒåèŒƒå¼</a></li>
<li><a href="#_ç¼“å­˜è¡¨å’Œæ±‡æ€»è¡¨">1.4. ç¼“å­˜è¡¨å’Œæ±‡æ€»è¡¨</a>
<ul class="sectlevel3">
<li><a href="#_ç‰©åŒ–è§†å›¾">1.4.1. ç‰©åŒ–è§†å›¾</a></li>
<li><a href="#_è®¡æ•°å™¨è¡¨">1.4.2. è®¡æ•°å™¨è¡¨</a></li>
</ul>
</li>
<li><a href="#_åŠ å¿«_code_alter_table_code_æ“ä½œçš„é€Ÿåº¦">1.5. åŠ å¿« <code>ALTER TABLE</code> æ“ä½œçš„é€Ÿåº¦</a>
<ul class="sectlevel3">
<li><a href="#_åªä¿®æ”¹_em_frm_em_æ–‡ä»¶">1.5.1. åªä¿®æ”¹ <em>.frm</em> æ–‡ä»¶</a></li>
<li><a href="#_å¿«é€Ÿåˆ›å»º_myisam_ç´¢å¼•">1.5.2. å¿«é€Ÿåˆ›å»º MyISAM ç´¢å¼•</a></li>
</ul>
</li>
<li><a href="#_æ€»ç»“">1.6. æ€»ç»“</a></li>
</ul>
</li>
<li><a href="#_åˆ›å»ºç´¢å¼•">2. åˆ›å»ºç´¢å¼•</a>
<ul class="sectlevel2">
<li><a href="#_è¿½æœ¬æº¯æº">2.1. è¿½æœ¬æº¯æº</a>
<ul class="sectlevel3">
<li><a href="#_å­˜å‚¨é‡‘å­—å¡”">2.1.1. å­˜å‚¨é‡‘å­—å¡”</a></li>
<li><a href="#_æœºæ¢°ç¡¬ç›˜ç»“æ„">2.1.2. æœºæ¢°ç¡¬ç›˜ç»“æ„</a></li>
<li><a href="#_å±€éƒ¨æ€§åŸç†ä¸ç£ç›˜é¢„è¯»">2.1.3. å±€éƒ¨æ€§åŸç†ä¸ç£ç›˜é¢„è¯»</a></li>
<li><a href="#_æ—¶é—´å¤æ‚åº¦">2.1.4. æ—¶é—´å¤æ‚åº¦</a></li>
<li><a href="#_å½’å¹¶æ’åº">2.1.5. å½’å¹¶æ’åº</a></li>
<li><a href="#_äºŒåˆ†æŸ¥æ‰¾">2.1.6. äºŒåˆ†æŸ¥æ‰¾</a></li>
<li><a href="#_æ ‘">2.1.7. æ ‘</a></li>
<li><a href="#_äºŒå‰æŸ¥æ‰¾æ ‘">2.1.8. äºŒå‰æŸ¥æ‰¾æ ‘</a></li>
<li><a href="#_å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘">2.1.9. å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘</a></li>
<li><a href="#_b_tree">2.1.10. B+Tree</a></li>
<li><a href="#_å“ˆå¸Œè¡¨">2.1.11. å“ˆå¸Œè¡¨</a></li>
</ul>
</li>
<li><a href="#_innodb_é€»è¾‘å­˜å‚¨ç»“æ„">2.2. InnoDB é€»è¾‘å­˜å‚¨ç»“æ„ã€‚</a>
<ul class="sectlevel3">
<li><a href="#_è¡Œ">2.2.1. è¡Œ</a></li>
</ul>
</li>
<li><a href="#_ç´¢å¼•åŸºç¡€">2.3. ç´¢å¼•åŸºç¡€</a>
<ul class="sectlevel3">
<li><a href="#_ç´¢å¼•ç±»å‹">2.3.1. ç´¢å¼•ç±»å‹</a>
<ul class="sectlevel4">
<li><a href="#_b_tree_ç´¢å¼•">2.3.1.1. B-Tree ç´¢å¼•</a></li>
<li><a href="#_å“ˆå¸Œç´¢å¼•">2.3.1.2. å“ˆå¸Œç´¢å¼•</a></li>
<li><a href="#_ç©ºé—´æ•°æ®ç´¢å¼•_r_tree">2.3.1.3. ç©ºé—´æ•°æ®ç´¢å¼•ï¼ˆR-Treeï¼‰</a></li>
<li><a href="#_å…¨æ–‡ç´¢å¼•">2.3.1.4. å…¨æ–‡ç´¢å¼•</a></li>
<li><a href="#_åˆ†å½¢æ ‘ç´¢å¼•_fractal_tree_index">2.3.1.5. åˆ†å½¢æ ‘ç´¢å¼•ï¼ˆfractal tree indexï¼‰</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ç´¢å¼•çš„ä¼˜ç‚¹">2.4. ç´¢å¼•çš„ä¼˜ç‚¹</a></li>
<li><a href="#_é«˜æ€§èƒ½çš„ç´¢å¼•ç­–ç•¥">2.5. é«˜æ€§èƒ½çš„ç´¢å¼•ç­–ç•¥</a>
<ul class="sectlevel3">
<li><a href="#_ç‹¬ç«‹çš„åˆ—">2.5.1. ç‹¬ç«‹çš„åˆ—</a></li>
<li><a href="#_å‰ç¼€ç´¢å¼•å’Œç´¢å¼•é€‰æ‹©æ€§">2.5.2. å‰ç¼€ç´¢å¼•å’Œç´¢å¼•é€‰æ‹©æ€§</a></li>
<li><a href="#_å¤šåˆ—ç´¢å¼•">2.5.3. å¤šåˆ—ç´¢å¼•</a></li>
<li><a href="#_é€‰æ‹©åˆé€‚çš„ç´¢å¼•åˆ—é¡ºåº">2.5.4. é€‰æ‹©åˆé€‚çš„ç´¢å¼•åˆ—é¡ºåº</a></li>
<li><a href="#_èšç°‡ç´¢å¼•">2.5.5. èšç°‡ç´¢å¼•</a>
<ul class="sectlevel4">
<li><a href="#_innodb_å’Œ_myisam_çš„æ•°æ®åˆ†å¸ƒå¯¹æ¯”">2.5.5.1. InnoDB å’Œ MyISAM çš„æ•°æ®åˆ†å¸ƒå¯¹æ¯”</a></li>
<li><a href="#_åœ¨_innodb_è¡¨ä¸­æŒ‰ä¸»é”®é¡ºåºæ’å…¥è¡Œ">2.5.5.2. åœ¨ InnoDB è¡¨ä¸­æŒ‰ä¸»é”®é¡ºåºæ’å…¥è¡Œ</a></li>
</ul>
</li>
<li><a href="#_è¦†ç›–ç´¢å¼•">2.5.6. è¦†ç›–ç´¢å¼•</a></li>
<li><a href="#_ä½¿ç”¨ç´¢å¼•æ‰«ææ¥åšæ’åº">2.5.7. ä½¿ç”¨ç´¢å¼•æ‰«ææ¥åšæ’åº</a></li>
<li><a href="#_å‹ç¼©_å‰ç¼€å‹ç¼©_ç´¢å¼•">2.5.8. å‹ç¼©ï¼ˆå‰ç¼€å‹ç¼©ï¼‰ç´¢å¼•</a></li>
<li><a href="#_å†—ä½™å’Œé‡å¤ç´¢å¼•">2.5.9. å†—ä½™å’Œé‡å¤ç´¢å¼•</a></li>
<li><a href="#_æœªä½¿ç”¨çš„ç´¢å¼•">2.5.10. æœªä½¿ç”¨çš„ç´¢å¼•</a></li>
<li><a href="#_ç´¢å¼•å’Œé”">2.5.11. ç´¢å¼•å’Œé”</a></li>
</ul>
</li>
<li><a href="#_ç´¢å¼•æ¡ˆä¾‹å­¦ä¹ ">2.6. ç´¢å¼•æ¡ˆä¾‹å­¦ä¹ </a>
<ul class="sectlevel3">
<li><a href="#_æ”¯æŒå¤šç§è¿‡æ»¤æ¡ä»¶">2.6.1. æ”¯æŒå¤šç§è¿‡æ»¤æ¡ä»¶</a></li>
</ul>
</li>
<li><a href="#_ç»´æŠ¤ç´¢å¼•å’Œè¡¨">2.7. ç»´æŠ¤ç´¢å¼•å’Œè¡¨</a>
<ul class="sectlevel3">
<li><a href="#_æ‰¾åˆ°å¹¶ä¿®å¤æŸåçš„è¡¨">2.7.1. æ‰¾åˆ°å¹¶ä¿®å¤æŸåçš„è¡¨</a></li>
<li><a href="#_æ›´æ–°ç´¢å¼•ç»Ÿè®¡ä¿¡æ¯">2.7.2. æ›´æ–°ç´¢å¼•ç»Ÿè®¡ä¿¡æ¯</a></li>
<li><a href="#_å‡å°‘ç´¢å¼•å’Œæ•°æ®çš„ç¢ç‰‡">2.7.3. å‡å°‘ç´¢å¼•å’Œæ•°æ®çš„ç¢ç‰‡</a></li>
</ul>
</li>
<li><a href="#_æ€»ç»“_2">2.8. æ€»ç»“</a></li>
</ul>
</li>
<li><a href="#_æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–">3. æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–</a>
<ul class="sectlevel2">
<li><a href="#_ä¸ºä»€ä¹ˆæŸ¥è¯¢é€Ÿåº¦ä¼šæ…¢">3.1. ä¸ºä»€ä¹ˆæŸ¥è¯¢é€Ÿåº¦ä¼šæ…¢ï¼Ÿ</a></li>
<li><a href="#_æ…¢æŸ¥è¯¢åŸºç¡€_ä¼˜åŒ–æ•°æ®è®¿é—®">3.2. æ…¢æŸ¥è¯¢åŸºç¡€ï¼šä¼˜åŒ–æ•°æ®è®¿é—®</a></li>
<li><a href="#_é‡æ„æŸ¥è¯¢çš„æ–¹å¼">3.3. é‡æ„æŸ¥è¯¢çš„æ–¹å¼</a>
<ul class="sectlevel3">
<li><a href="#_ä¸€ä¸ªå¤æ‚æŸ¥è¯¢è¿˜æ˜¯å¤šä¸ªç®€å•æŸ¥è¯¢">3.3.1. ä¸€ä¸ªå¤æ‚æŸ¥è¯¢è¿˜æ˜¯å¤šä¸ªç®€å•æŸ¥è¯¢</a></li>
<li><a href="#_åˆ‡åˆ†æŸ¥è¯¢">3.3.2. åˆ‡åˆ†æŸ¥è¯¢</a></li>
<li><a href="#_åˆ†è§£å…³è”æŸ¥è¯¢">3.3.3. åˆ†è§£å…³è”æŸ¥è¯¢</a></li>
</ul>
</li>
<li><a href="#_æŸ¥è¯¢æ‰§è¡Œçš„åŸºç¡€">3.4. æŸ¥è¯¢æ‰§è¡Œçš„åŸºç¡€</a>
<ul class="sectlevel3">
<li><a href="#_mysql_å®¢æˆ·ç«¯_æœåŠ¡å™¨é€šä¿¡åè®®">3.4.1. MySQL å®¢æˆ·ç«¯/æœåŠ¡å™¨é€šä¿¡åè®®</a></li>
<li><a href="#_æŸ¥è¯¢ç¼“å­˜">3.4.2. æŸ¥è¯¢ç¼“å­˜</a></li>
<li><a href="#_æŸ¥è¯¢ä¼˜åŒ–å¤„ç†">3.4.3. æŸ¥è¯¢ä¼˜åŒ–å¤„ç†</a>
<ul class="sectlevel4">
<li><a href="#_è¯­æ³•è§£æå™¨å’Œé¢„å¤„ç†">3.4.3.1. è¯­æ³•è§£æå™¨å’Œé¢„å¤„ç†</a></li>
<li><a href="#_æŸ¥è¯¢ä¼˜åŒ–å™¨">3.4.3.2. æŸ¥è¯¢ä¼˜åŒ–å™¨</a></li>
<li><a href="#_æ•°æ®å’Œç´¢å¼•çš„ç»Ÿè®¡ä¿¡æ¯">3.4.3.3. æ•°æ®å’Œç´¢å¼•çš„ç»Ÿè®¡ä¿¡æ¯</a></li>
<li><a href="#_mysql_å¦‚ä½•æ‰§è¡Œå…³è”æŸ¥è¯¢">3.4.3.4. MySQL å¦‚ä½•æ‰§è¡Œå…³è”æŸ¥è¯¢</a></li>
<li><a href="#_æ‰§è¡Œè®¡åˆ’">3.4.3.5. æ‰§è¡Œè®¡åˆ’</a></li>
<li><a href="#_å…³è”æŸ¥è¯¢ä¼˜åŒ–å™¨">3.4.3.6. å…³è”æŸ¥è¯¢ä¼˜åŒ–å™¨</a></li>
<li><a href="#_æ’åºä¼˜åŒ–">3.4.3.7. æ’åºä¼˜åŒ–</a></li>
</ul>
</li>
<li><a href="#_æŸ¥è¯¢æ‰§è¡Œå¼•æ“">3.4.4. æŸ¥è¯¢æ‰§è¡Œå¼•æ“</a></li>
<li><a href="#_è¿”å›ç»“æœç»™å®¢æˆ·ç«¯">3.4.5. è¿”å›ç»“æœç»™å®¢æˆ·ç«¯</a></li>
</ul>
</li>
<li><a href="#_mysql_æŸ¥è¯¢ä¼˜åŒ–å™¨çš„å±€é™æ€§">3.5. MySQL æŸ¥è¯¢ä¼˜åŒ–å™¨çš„å±€é™æ€§</a>
<ul class="sectlevel3">
<li><a href="#_å…³è”å­æŸ¥è¯¢">3.5.1. å…³è”å­æŸ¥è¯¢</a>
<ul class="sectlevel4">
<li><a href="#_å¦‚ä½•ç”¨å¥½å…³è”å­æŸ¥è¯¢">3.5.1.1. å¦‚ä½•ç”¨å¥½å…³è”å­æŸ¥è¯¢</a></li>
</ul>
</li>
<li><a href="#__code_union_code_çš„é™åˆ¶">3.5.2. <code>UNION</code> çš„é™åˆ¶</a></li>
<li><a href="#_ç´¢å¼•åˆå¹¶ä¼˜åŒ–">3.5.3. ç´¢å¼•åˆå¹¶ä¼˜åŒ–</a></li>
<li><a href="#_ç­‰å€¼ä¼ é€’">3.5.4. ç­‰å€¼ä¼ é€’</a></li>
<li><a href="#_å¹¶è¡Œæ‰§è¡Œ">3.5.5. å¹¶è¡Œæ‰§è¡Œ</a></li>
<li><a href="#_å“ˆå¸Œå…³è”">3.5.6. å“ˆå¸Œå…³è”</a></li>
<li><a href="#_æ¾æ•£ç´¢å¼•æ‰«æ">3.5.7. æ¾æ•£ç´¢å¼•æ‰«æ</a></li>
<li><a href="#_æœ€å¤§å€¼å’Œæœ€å°å€¼ä¼˜åŒ–">3.5.8. æœ€å¤§å€¼å’Œæœ€å°å€¼ä¼˜åŒ–</a></li>
<li><a href="#_åœ¨åŒä¸€ä¸ªè¡¨ä¸ŠæŸ¥è¯¢å’Œæ›´æ–°">3.5.9. åœ¨åŒä¸€ä¸ªè¡¨ä¸ŠæŸ¥è¯¢å’Œæ›´æ–°</a></li>
</ul>
</li>
<li><a href="#_æŸ¥è¯¢ä¼˜åŒ–å™¨çš„æç¤º_hint">3.6. æŸ¥è¯¢ä¼˜åŒ–å™¨çš„æç¤ºï¼ˆhintï¼‰</a></li>
<li><a href="#_ä¼˜åŒ–ç‰¹å®šç±»å‹çš„æŸ¥è¯¢">3.7. ä¼˜åŒ–ç‰¹å®šç±»å‹çš„æŸ¥è¯¢</a>
<ul class="sectlevel3">
<li><a href="#_ä¼˜åŒ–_code_count_code_æŸ¥è¯¢">3.7.1. ä¼˜åŒ– <code>COUNT()</code> æŸ¥è¯¢</a>
<ul class="sectlevel4">
<li><a href="#__code_count_code_çš„ä½œç”¨">3.7.1.1. <code>COUNT()</code> çš„ä½œç”¨</a></li>
<li><a href="#_å…³äº_myisam_çš„ç¥è¯">3.7.1.2. å…³äº MyISAM çš„ç¥è¯</a></li>
<li><a href="#_ç®€å•çš„ä¼˜åŒ–">3.7.1.3. ç®€å•çš„ä¼˜åŒ–</a></li>
<li><a href="#_ä½¿ç”¨è¿‘ä¼¼å€¼">3.7.1.4. ä½¿ç”¨è¿‘ä¼¼å€¼</a></li>
<li><a href="#_æ›´å¤æ‚çš„ä¼˜åŒ–">3.7.1.5. æ›´å¤æ‚çš„ä¼˜åŒ–</a></li>
</ul>
</li>
<li><a href="#_ä¼˜åŒ–å…³è”æŸ¥è¯¢">3.7.2. ä¼˜åŒ–å…³è”æŸ¥è¯¢</a></li>
<li><a href="#_ä¼˜åŒ–å­æŸ¥è¯¢">3.7.3. ä¼˜åŒ–å­æŸ¥è¯¢</a></li>
<li><a href="#_ä¼˜åŒ–_code_group_by_code_å’Œ_code_distinct_code">3.7.4. ä¼˜åŒ– <code>GROUP BY</code> å’Œ <code>DISTINCT</code></a>
<ul class="sectlevel4">
<li><a href="#_ä¼˜åŒ–_code_group_by_with_rollup_code">3.7.4.1. ä¼˜åŒ– <code>GROUP BY WITH ROLLUP</code></a></li>
</ul>
</li>
<li><a href="#_ä¼˜åŒ–_code_limit_code_åˆ†é¡µ">3.7.5. ä¼˜åŒ– <code>LIMIT</code> åˆ†é¡µ</a></li>
<li><a href="#_ä¼˜åŒ–_code_sql_calc_found_rows_code">3.7.6. ä¼˜åŒ– <code>SQL_CALC_FOUND_ROWS</code></a></li>
<li><a href="#_ä¼˜åŒ–_code_union_code_æŸ¥è¯¢">3.7.7. ä¼˜åŒ– <code>UNION</code> æŸ¥è¯¢</a></li>
<li><a href="#_é™æ€æŸ¥è¯¢åˆ†æ">3.7.8. é™æ€æŸ¥è¯¢åˆ†æ</a></li>
<li><a href="#_ä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰å˜é‡">3.7.9. ä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰å˜é‡</a></li>
</ul>
</li>
<li><a href="#_æ¡ˆä¾‹å­¦ä¹ ">3.8. æ¡ˆä¾‹å­¦ä¹ </a>
<ul class="sectlevel3">
<li><a href="#_ä½¿ç”¨_mysql_æ„å»ºä¸€ä¸ªé˜Ÿåˆ—è¡¨">3.8.1. ä½¿ç”¨ MySQL æ„å»ºä¸€ä¸ªé˜Ÿåˆ—è¡¨</a></li>
<li><a href="#_è®¡ç®—ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»">3.8.2. è®¡ç®—ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»</a></li>
<li><a href="#_ä½¿ç”¨ç”¨æˆ·å®šä¹‰å‡½æ•°">3.8.3. ä½¿ç”¨ç”¨æˆ·å®šä¹‰å‡½æ•°</a></li>
</ul>
</li>
<li><a href="#_æ€»ç»“_3">3.9. æ€»ç»“</a></li>
</ul>
</li>
<li><a href="#_mysql_code_explain_code_è¯¦è§£">4. MySQL <code>explain</code> è¯¦è§£</a>
<ul class="sectlevel2">
<li><a href="#__code_explain_code_è¯­æ³•">4.1. <code>EXPLAIN</code> è¯­æ³•</a>
<ul class="sectlevel3">
<li><a href="#_è·å–è¡¨ç»“æ„">4.1.1. è·å–è¡¨ç»“æ„</a></li>
</ul>
</li>
<li><a href="#__code_explain_code_è¾“å‡º">4.2. <code>explain</code> è¾“å‡º</a>
<ul class="sectlevel3">
<li><a href="#__code_select_type_code">4.2.1. <code>select_type</code></a></li>
<li><a href="#__code_partitions_code">4.2.2. <code>partitions</code></a></li>
<li><a href="#__code_type_code">4.2.3. <code>type</code></a></li>
<li><a href="#__code_possible_keys_code">4.2.4. <code>possible_keys</code></a></li>
<li><a href="#__code_key_code">4.2.5. <code>key</code></a></li>
<li><a href="#__code_key_len_code">4.2.6. <code>key_len</code></a></li>
<li><a href="#__code_ref_code">4.2.7. <code>ref</code></a></li>
<li><a href="#__code_rows_code">4.2.8. <code>rows</code></a></li>
<li><a href="#__code_filtered_code">4.2.9. <code>filtered</code></a></li>
<li><a href="#__code_extra_code">4.2.10. <code>extra</code></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#__code_explain_code_å®è·µ">5. <code>EXPLAIN</code> å®è·µ</a></li>
<li><a href="#_å‚è€ƒèµ„æ–™">é™„å½• A: å‚è€ƒèµ„æ–™</a></li>
<li><a href="#_ç‰ˆæƒå£°æ˜">é™„å½• B: ç‰ˆæƒå£°æ˜</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_å‰è¨€">å‰è¨€</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_å‹æƒ…æ”¯æŒ">å‹æƒ…æ”¯æŒ</h3>
<div class="paragraph">
<p>å¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªç¬”è®°å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œçœ‹åœ¨Dç“œå“¥ç è¿™ä¹ˆå¤šå­—çš„è¾›è‹¦ä¸Šï¼Œè¯·å‹æƒ…æ”¯æŒä¸€ä¸‹ï¼ŒDç“œå“¥æ„Ÿæ¿€ä¸å°½ï¼ŒğŸ˜†</p>
</div>
<table class="tableblock frame-none grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="images/alipay.jpeg" alt="æ”¯ä»˜å®" width="60%" title="æ”¯ä»˜å®"></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="images/wxpay.png" alt="å¾®ä¿¡" width="65%" title="å¾®ä¿¡"></span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_å®˜ç½‘åŠç‰ˆæœ¬åº“">å®˜ç½‘åŠç‰ˆæœ¬åº“</h3>
<div class="paragraph">
<p>æœ¬æ–‡æ¡£çš„ç‰ˆæœ¬åº“æ‰˜ç®¡åœ¨ Github ä¸Šï¼Œå¦å¤–å•ç‹¬å‘å¸ƒã€‚</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">æœ¬æ–‡æ¡£å®˜ç½‘</dt>
<dd>
<p><a href="http://notes.diguage.com/mysql/" class="bare">http://notes.diguage.com/mysql/</a> ã€‚ä¸ºäº†æ–¹ä¾¿é˜…è¯»ï¼Œè¿™é‡Œå±•ç¤ºäº†å¤„ç†å¥½çš„æ–‡æ¡£ã€‚é˜…è¯»è¯·ç‚¹å‡»è¿™ä¸ªç½‘å€ã€‚</p>
</dd>
<dt class="hdlist1">æœ¬æ–‡æ¡£ç‰ˆæœ¬åº“</dt>
<dd>
<p><a href="https://github.com/diguage/mysql-notes" class="bare">https://github.com/diguage/mysql-notes</a> ã€‚æ¬¢è¿å¤§å®¶å‘é€ PRã€‚</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_ç‰¹åˆ«æé†’">ç‰¹åˆ«æé†’</h3>
<div class="paragraph">
<p>æœ‰ä¸ªéœ€è¦ç‰¹åˆ«æ³¨æ„çš„åœ°æ–¹ï¼Œè¿™é‡Œé‡ç‚¹æå‡ºï¼š<strong>æœ¬æ–‡æ¡£éƒ¨åˆ†çš„å†…å®¹å¯èƒ½ä¼šè¿‡æ—¶ï¼</strong></p>
</div>
<div class="paragraph">
<p>è¿™ä¸ªæ–‡æ¡£ç»å¤§éƒ¨åˆ†æ˜¯å‚è€ƒã€Šé«˜æ€§èƒ½ MySQLã€‹å†™çš„ï¼Œå¯ä»¥è¯´å°±æ˜¯ä¸€ä¸ªè¯»ä¹¦ç¬”è®°ã€‚ä¹¦ä¸­åå¤å¼ºè°ƒï¼Œç»å¤§éƒ¨åˆ†å†…å®¹æ˜¯é’ˆå¯¹ MySQL 5.5 ä¹¦å†™çš„ã€‚éšç€ MySQL çš„å‘å±•ï¼Œæœ¬æ–‡æ¡£éƒ¨åˆ†çš„å†…å®¹å¯èƒ½ä¼šè¿‡æ—¶ã€‚æ‰€ä»¥ï¼Œæ–‡æ¡£å¦‚æœæœ‰é”™è¯¯ä¹‹å¤„ï¼Œè¿˜è¯·ä»¥ç›¸åº”ç‰ˆæœ¬çš„å®˜æ–¹æ–‡æ¡£ä¸ºå‡†ï¼</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_schema_è®¾è®¡">1. Schema è®¾è®¡</h2>
<div class="sectionbody">
<div class="paragraph">
<p>è‰¯å¥½çš„é€»è¾‘è®¾è®¡å’Œç‰©ç†è®¾è®¡æ˜¯é«˜æ€§èƒ½çš„åŸºçŸ³ã€‚</p>
</div>
<div class="sect2">
<h3 id="_æ•°æ®ç±»å‹çš„é€‰æ‹©">1.1. æ•°æ®ç±»å‹çš„é€‰æ‹©</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>æ›´å°çš„é€šå¸¸æ›´å¥½</p>
</li>
<li>
<p>ç®€å•å°±å¥½</p>
</li>
<li>
<p>å°½é‡é¿å… Null</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>InnoDB ä½¿ç”¨å•ç‹¬çš„ä½å­˜å‚¨ Null å€¼ï¼Œæ‰€ä»¥å¯¹äºç¨€ç–æ•°æ®ï¼ˆå¤šæ•°ä¸º Nullï¼Œå°‘æ•°é Nullï¼‰æœ‰å¾ˆå¥½çš„ç©ºé—´æ•ˆç‡ã€‚</p>
</div>
<div class="paragraph">
<p>MySQL å¾ˆå¤šæ•°æ®ç±»å‹åªæ˜¯åˆ«åï¼Œå¯ä»¥ç”¨ <code>SHOW CREATE TABLE</code> æŸ¥çœ‹å¯¹åº”çš„åŸºæœ¬ç±»å‹ã€‚</p>
</div>
<div class="sect3">
<h4 id="_æ•´æ•°">1.1.1. æ•´æ•°</h4>
<div class="paragraph">
<p>æ•´æ•°ç±»å‹ï¼š <code>TINYINT</code> ã€ <code>SMALLINT</code> ã€  <code>MEDIUMINT</code> ã€  <code>INT</code> ã€  <code>BIGINT</code>ï¼›åˆ†åˆ«ä½¿ç”¨ 8ã€16ã€24ã€32ã€64 ä½å­˜å‚¨ç©ºé—´ã€‚å­˜å‚¨çš„èŒƒå›´ä» -2<sup>(N-1)</sup> åˆ° 2<sup>(N-1)</sup>-1ã€‚</p>
</div>
<div class="paragraph">
<p>æ•´æ•°ç±»å‹æœ‰å¯é€‰çš„ <code>UNSIGNED</code>ï¼Œè¡¨ç¤ºä¸å…è®¸è´Ÿå€¼ã€‚</p>
</div>
<div class="paragraph">
<p>æœ‰ç¬¦å·å’Œæ— ç¬¦å·ç±»å‹ä½¿ç”¨ç›¸åŒçš„å­˜å‚¨ç©ºé—´ï¼Œå¹¶å…·æœ‰ç›¸åŒçš„æ€§èƒ½ï¼Œå› æ­¤å¯ä»¥æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©åˆé€‚çš„ç±»å‹ã€‚</p>
</div>
<div class="paragraph">
<p>MySQL å¯ä»¥ä¸ºæ•´æ•°ç±»å‹æŒ‡å®šå®½åº¦ï¼Œä¾‹å¦‚ <code>INT(11)</code>ï¼Œè¿™å®é™…æ²¡æœ‰æ„ä¹‰ï¼šå®ƒä¸ä¼šé™åˆ¶å€¼çš„åˆæ³•èŒƒå›´ã€‚å¯¹äºå­˜å‚¨å’Œè®¡ç®—æ¥è¯´ï¼Œ <code>INT(1)</code> å’Œ <code>INT(20)</code> æ˜¯ç›¸åŒçš„ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_å®æ•°">1.1.2. å®æ•°</h4>
<div class="paragraph">
<p><code>DECIMAL</code> ç±»å‹ç”¨äºå­˜å‚¨ç²¾ç¡®çš„å°æ•°ã€‚CPU ä¸æ”¯æŒå¯¹ <code>DECIMAL</code> çš„ç›´æ¥è®¡ç®—ã€‚</p>
</div>
<div class="paragraph">
<p>CPU ç›´æ¥æ”¯æŒåŸç”Ÿæµ®ç‚¹è®¡ç®—ï¼Œæ‰€ä»¥æµ®ç‚¹è¿ç®—æ˜æ˜¾æ›´å¿«ã€‚</p>
</div>
<div class="paragraph">
<p>MySQL 5.0 å’Œæ›´é«˜ç‰ˆæœ¬ä¸­çš„ <code>DECIMAL</code> ç±»å‹è¿è¡Œæœ€å¤š 65 ä¸ªæ•°å­—ã€‚</p>
</div>
<div class="listingblock">
<div class="title">ä»£ç  1. æµ‹è¯• <code>DECIMAL</code> ç±»å‹çš„æœ€å¤§æ•°å­—æ•°</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">DROP</span> <span class="type">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> decimal_test;
<span class="class">CREATE</span> <span class="type">TABLE</span> decimal_test (
  col1 <span class="predefined-type">DECIMAL</span>(<span class="integer">65</span>, <span class="integer">10</span>),
  col2 <span class="predefined-type">DECIMAL</span>(<span class="integer">66</span>, <span class="integer">10</span>) <i class="conum" data-value="1"></i><b>(1)</b>
);</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>æ‰§è¡Œæ—¶æŠ¥é”™ï¼Œæ”¹ä¸º65å³å¯æ‰§è¡Œã€‚</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>æµ®ç‚¹ç±»å‹åœ¨å­˜å‚¨åŒæ ·èŒƒå›´çš„å€¼æ—¶ï¼Œé€šå¸¸æ¯” <code>DECIMAL</code> ä½¿ç”¨æ›´å°‘çš„ç©ºé—´ã€‚ <code>FLOAT</code> ä½¿ç”¨ 4 ä¸ªå­—èŠ‚å­˜å‚¨ï¼› <code>DOUBLE</code> å ç”¨ 8 ä¸ªå­—èŠ‚ã€‚</p>
</div>
<div class="paragraph">
<p>MySQL ä½¿ç”¨ <code>DOUBLE</code> ä½œä¸ºå†…éƒ¨æµ®ç‚¹è®¡ç®—çš„ç±»å‹ã€‚</p>
</div>
<div class="paragraph">
<p>å› ä¸ºéœ€è¦é¢å¤–çš„ç©ºé—´å’Œè®¡ç®—å¼€é”€ï¼Œæ‰€ä»¥åº”è¯¥å°½é‡åªåœ¨å¯¹å°æ•°è¿›è¡Œç²¾ç¡®è®¡ç®—æ—¶æ‰ä½¿ç”¨ <code>DECIMAL</code> ã€‚</p>
</div>
<div class="paragraph">
<p>åœ¨æ•°æ®é‡æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ <code>BIGINT</code> ä»£æ›¿ <code>DECIMAL</code> ï¼Œå°†éœ€è¦å­˜å‚¨çš„è´§å¸å•ä½æ ¹æ®å°æ•°çš„ä½æ•°ä¹˜ä»¥ç›¸åº”çš„å€æ•°å³å¯ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_å­—ç¬¦ä¸²ç±»å‹">1.1.3. å­—ç¬¦ä¸²ç±»å‹</h4>
<div class="paragraph">
<p>ä» MySQL 4.1 å¼€å§‹ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²åˆ—å¯ä»¥å®šä¹‰è‡ªå·±çš„å­—ç¬¦é›†å’Œæ’åºè§„åˆ™ï¼Œæˆ–è€…è¯´æ ¡å¯¹è§„åˆ™ã€‚</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>VARCHAR</code></dt>
<dd>
<p>ç”¨äºå­˜å‚¨å¯å˜é•¿å­—ç¬¦ä¸²ï¼Œæ¯”å®šé•¿ç±»å‹æ›´èŠ‚çœç©ºé—´ã€‚</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
ä¾‹å¤–ï¼šMySQLè¡¨ä½¿ç”¨ <code>ROW_FORMAT=FIXED</code> åˆ›å»ºçš„è¯ï¼Œæ¯ä¸€è¡Œéƒ½ä¼šä½¿ç”¨å®šé•¿å­˜å‚¨ã€‚
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>VARCHAR</code> éœ€è¦ä½¿ç”¨ 1 æˆ– 2ä¸ªé¢å¤–å­—èŠ‚è®°å½•å­—ç¬¦ä¸²çš„é•¿åº¦ï¼šå¦‚æœåˆ—çš„æœ€å¤§é•¿åº¦å°äºæˆ–è€…ç­‰äº255å­—èŠ‚ï¼Œåˆ™åªä½¿ç”¨1ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œå¦åˆ™ä½¿ç”¨ 2 ä¸ªå­—èŠ‚ã€‚</p>
</div>
<div class="paragraph">
<p><code>VARCHAR</code> èŠ‚çœäº†å­˜å‚¨ç©ºé—´ï¼Œæ‰€ä»¥å¯¹æ€§èƒ½ä¹Ÿæœ‰å¸®åŠ©ã€‚ä½†æ˜¯ï¼Œè¡Œå˜é•¿æ—¶ï¼Œå¦‚æœé¡µå†…æ²¡æœ‰æ›´å¤šçš„ç©ºé—´å¯ä»¥å­˜å‚¨ï¼ŒMyISAM ä¼šå°†è¡Œæ‹†æˆä¸åŒçš„ç‰‡æ®µå­˜å‚¨ï¼ŒInnoDB åˆ™éœ€è¦åˆ†è£‚é¡µæ¥ä½¿è¡Œå¯ä»¥æ”¾è¿›é¡µå†…ã€‚</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
æ¯é¡µæœ€å¤šèƒ½å­˜å¤šå°‘æ•°æ®ï¼Ÿ 2<sup>8</sup> = 256ï¼Œ 2<sup>16</sup> = 65536ï¼Œå¦‚æœæ•°æ®èƒ½å¦è¶…è¿‡65536ï¼Ÿè¶…è¿‡äº†ä¼šæ€ä¹ˆæ ·ï¼Ÿ-- MySQL ä¸­ <code>VARCHAR</code> ç±»å‹çš„æœ€å¤§é•¿åº¦é™åˆ¶ä¸º 65535ã€‚
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>InnoDB æ›´çµæ´»ï¼Œå¯ä»¥æŠŠè¿‡é•¿çš„ <code>VARCHAR</code> å­˜å‚¨ä¸º <code>BLOB</code>ã€‚</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
å˜åŒ–çš„é˜ˆå€¼æ˜¯å¤šå°‘ï¼Ÿ
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1"><code>CHAR</code></dt>
<dd>
<p>å®šé•¿ï¼Œæ ¹æ®å®šä¹‰åˆ†é…è¶³å¤Ÿçš„ç©ºé—´ã€‚å½“å­˜å‚¨ <code>CHAR</code> å€¼æ—¶ï¼ŒMySQL ä¼šåˆ é™¤æ‰€æœ‰çš„æœ«å°¾ç©ºæ ¼ã€‚<code>CHAR</code> å€¼ä¼šæ ¹æ®éœ€è¦é‡‡ç”¨ç©ºæ ¼è¿›è¡Œå¡«å……ä»¥æ–¹ä¾¿æ¯”è¾ƒã€‚</p>
<div class="ulist">
<ul>
<li>
<p><code>CHAR</code> é€‚åˆå­˜å‚¨å¾ˆçŸ­çš„å­—ç¬¦ä¸²ï¼Œæˆ–è€…æ‰€æœ‰å€¼éƒ½æ¥è¿‘åŒä¸€ä¸ªé•¿åº¦ï¼Œæ¯”å¦‚å¯†ç çš„ MD5 å€¼ã€‚</p>
</li>
<li>
<p>å¯¹äºç»å¸¸å˜æ›´çš„æ•°æ®ï¼Œ <code>CHAR</code> ä¹Ÿæ¯” <code>VARCHAR</code> æ›´å¥½ï¼Œå®šé•¿ä¸å®¹æ˜“äº§ç”Ÿç¢ç‰‡ã€‚</p>
</li>
<li>
<p>éå¸¸çŸ­çš„åˆ—ï¼Œ <code>CHAR</code> æ¯” <code>VARCHAR</code> åœ¨å­˜å‚¨ç©ºé—´ä¸Šæ›´æœ‰æ•ˆç‡ã€‚</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">ä»£ç  2. æµ‹è¯•æ•°æ®ä¸¤ç«¯çš„ç©ºæ ¼ä¿ç•™æƒ…å†µ</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="comment"># æµ‹è¯• CHAR</span>
<span class="class">DROP</span> <span class="type">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> char_test;
<span class="class">CREATE</span> <span class="type">TABLE</span> char_test (char_col <span class="predefined-type">CHAR</span>(<span class="integer">10</span>));

<span class="class">INSERT</span> <span class="class">INTO</span> char_test <span class="keyword">VALUES</span> (<span class="string"><span class="delimiter">'</span><span class="content">string1</span><span class="delimiter">'</span></span>), (<span class="string"><span class="delimiter">'</span><span class="content">   string2</span><span class="delimiter">'</span></span>), (<span class="string"><span class="delimiter">'</span><span class="content">string3   </span><span class="delimiter">'</span></span>);

<span class="class">SELECT</span> CONCAT(<span class="string"><span class="delimiter">&quot;</span><span class="content">'</span><span class="delimiter">&quot;</span></span>, char_col, <span class="string"><span class="delimiter">&quot;</span><span class="content">'</span><span class="delimiter">&quot;</span></span>) <span class="keyword">FROM</span> char_test; <i class="conum" data-value="1"></i><b>(1)</b>

<span class="comment"># æµ‹è¯• VARCHAR</span>
<span class="class">DROP</span> <span class="type">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> varchar_test;
<span class="class">CREATE</span> <span class="type">TABLE</span> varchar_test (varchar_col <span class="predefined-type">VARCHAR</span>(<span class="integer">10</span>));

<span class="class">INSERT</span> <span class="class">INTO</span> varchar_test <span class="keyword">VALUES</span> (<span class="string"><span class="delimiter">'</span><span class="content">string1</span><span class="delimiter">'</span></span>), (<span class="string"><span class="delimiter">'</span><span class="content">   string2</span><span class="delimiter">'</span></span>), (<span class="string"><span class="delimiter">'</span><span class="content">string3   </span><span class="delimiter">'</span></span>);

<span class="class">SELECT</span> CONCAT(<span class="string"><span class="delimiter">&quot;</span><span class="content">'</span><span class="delimiter">&quot;</span></span>, varchar_col, <span class="string"><span class="delimiter">&quot;</span><span class="content">'</span><span class="delimiter">&quot;</span></span>) <span class="keyword">FROM</span> varchar_test; <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>æ³¨æ„è§‚å¯ŸæŸ¥è¯¢ç»“æœä¸­å­—ç¬¦ä¸²ä¸¤è¾¹çš„ç©ºæ ¼å˜åŒ–ã€‚</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>æ•°æ®å¦‚ä½•å­˜å‚¨å–å†³äºå­˜å‚¨å¼•æ“ã€‚</strong></p>
</div>
<div class="paragraph">
<p>ä¸ <code>CHAR</code> å’Œ <code>VARCHAR</code> ç±»ä¼¼çš„ç±»å‹è¿˜æœ‰ <code>BINARY</code> å’Œ <code>VARBINARY</code>ï¼Œå®ƒä»¬å­˜å‚¨çš„æ˜¯äºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚äºŒè¿›åˆ¶å­—ç¬¦ä¸²å­˜å‚¨çš„æ˜¯å­—èŠ‚ç è€Œä¸æ˜¯å­—ç¬¦ã€‚MySQL å¡«å…… <code>BINARY</code> é‡‡ç”¨çš„æ˜¯ <code>\0</code> ï¼ˆé›¶å­—èŠ‚ï¼‰è€Œä¸æ˜¯ç©ºæ ¼ï¼Œåœ¨æ£€ç´¢æ—¶ä¹Ÿä¸ä¼šå»æ‰å¡«å……å€¼ã€‚</p>
</div>
<div class="paragraph">
<p>äºŒè¿›åˆ¶æ¯”è¾ƒçš„ä¼˜åŠ¿å¹¶ä¸ä»…ä»…ä½“ç°åœ¨å¤§å°å†™æ•æ„Ÿä¸Šã€‚MySQL æ¯”è¾ƒ <code>BINARY</code> å­—ç¬¦ä¸²æ—¶ï¼Œæ¯æ¬¡æŒ‰ä¸€ä¸ªå­—èŠ‚ï¼Œå¹¶ä¸”æ ¹æ®è¯¥å­—èŠ‚çš„æ•°å€¼è¿›è¡Œæ¯”è¾ƒã€‚å› æ­¤ï¼ŒäºŒè¿›åˆ¶æ¯”å­—ç¬¦ä¸²æ¯”è¾ƒç®€å•å¾ˆå¤šï¼Œæ‰€ä»¥ä¹Ÿæ›´å¿«ã€‚</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
æ…·æ…¨æ˜¯ä¸æ˜æ™ºçš„ã€‚
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_blobå’Œtext_ç±»å‹">1.1.3.1. BLOBå’ŒTEXT ç±»å‹</h5>
<div class="paragraph">
<p><code>BLOB</code> å’Œ <code>TEXT</code> éƒ½æ˜¯ä¸ºå­˜å‚¨å¾ˆå¤§çš„æ•°æ®è€Œè®¾è®¡çš„å­—ç¬¦ä¸²æ•°æ®ç±»å‹ï¼Œåˆ†åˆ«é‡‡ç”¨äºŒè¿›åˆ¶å’Œå­—ç¬¦ä¸²æ–¹å¼å­˜å‚¨ã€‚</p>
</div>
<div class="paragraph">
<p>å­—ç¬¦ä¸²ç±»å‹ï¼š <code>TINYTEXT</code>ã€ <code>SMALLTEXT</code>ã€ <code>TEXT</code>ã€ <code>MEDIUMTEXT</code>ã€ <code>LONGTEXT</code><br>
äºŒè¿›åˆ¶ç±»å‹ï¼š <code>TINYBLOB</code>ã€ <code>SMALLBLOB</code>ã€ <code>BLOB</code>ã€ <code>MEDIUMBLOB</code>ã€ <code>LONGBLOB</code></p>
</div>
<div class="paragraph">
<p><code>BLOB</code> æ˜¯ <code>SMALLBLOB</code> çš„åŒä¹‰è¯ï¼› <code>TEXT</code> æ˜¯ <code>SMALLTEXT</code> çš„åŒä¹‰è¯ã€‚</p>
</div>
<div class="paragraph">
<p>MySQL æŠŠæ¯ä¸ª <code>BLOB</code> å’Œ <code>TEXT</code> å€¼å½“åšä¸€ä¸ªç‹¬ç«‹çš„å¯¹è±¡å¤„ç†ã€‚InnoDB ä¼šä½¿ç”¨ä¸“é—¨çš„â€œå¤–éƒ¨â€å­˜å‚¨åŒºåŸŸæ¥è¿›è¡Œå­˜å‚¨ï¼Œæ­¤æ—¶æ¯ä¸ªå€¼åœ¨è¡Œå†…éœ€è¦ 1 ~ 4 ä¸ªå­—èŠ‚å­˜å‚¨ä¸€ä¸ªæŒ‡é’ˆï¼Œç„¶ååœ¨å¤–éƒ¨å­˜å‚¨åŒºåŸŸå­˜å‚¨å®é™…çš„å€¼ã€‚</p>
</div>
<div class="paragraph">
<p><code>BLOB</code> å’Œ <code>TEXT</code> å®¶æ—ä¹‹é—´ä»…æœ‰çš„ä¸åŒæ˜¯ <code>BLOB</code> ç±»å‹å­˜å‚¨çš„æ˜¯äºŒè¿›åˆ¶ï¼Œæ²¡æœ‰æ’åºè§„åˆ™æˆ–å­—ç¬¦é›†ï¼Œè€Œ <code>TEXT</code> ç±»å‹æœ‰å­—ç¬¦é›†å’Œæ’åºè§„åˆ™ã€‚</p>
</div>
<div class="paragraph">
<p><code>BLOB</code> å’Œ <code>TEXT</code> åªå¯¹æ¯ä¸ªåˆ—çš„æœ€å‰ <code>max_sort_length</code> å­—èŠ‚è€Œä¸æ˜¯æ•´ä¸ªå­—ç¬¦ä¸²åšæ’åºã€‚</p>
</div>
<div class="paragraph">
<p>MySQL ä¸èƒ½å°† <code>BLOB</code> å’Œ <code>TEXT</code> åˆ—å…¨éƒ¨é•¿åº¦çš„å­—ç¬¦ä¸²è¿›è¡Œç´¢å¼•ã€‚</p>
</div>
</div>
<div class="sect4">
<h5 id="_ä½¿ç”¨æšä¸¾_enum_ä»£æ›¿å­—ç¬¦ä¸²">1.1.3.2. ä½¿ç”¨æšä¸¾ï¼ˆENUMï¼‰ä»£æ›¿å­—ç¬¦ä¸²</h5>
<div class="paragraph">
<p>æšä¸¾åˆ—å¯ä»¥æŠŠä¸€äº›ä¸é‡å¤çš„å­—ç¬¦ä¸²å­˜å‚¨æˆä¸€ä¸ªé¢„å®šä¹‰çš„é›†åˆã€‚MySQL åœ¨å­˜å‚¨æšä¸¾æ—¶éå¸¸ç´§å‡‘ï¼Œä¼šæ ¹æ®åˆ—è¡¨å€¼çš„æ•°é‡å‹ç¼©åˆ°ä¸€ä¸ªæˆ–è€…ä¸¤ä¸ªå­—èŠ‚ä¸­ã€‚MySQL åœ¨å†…éƒ¨ä¼šå°†æ¯ä¸ªå€¼åœ¨åˆ—è¡¨ä¸­çš„ä½ç½®ä¿å­˜ä¸ºæ•´æ•°ï¼Œå¹¶ä¸”åœ¨è¡¨çš„ <em>.frm</em> æ–‡ä»¶ä¸­ä¿å­˜ â€œæ•°å­—-å­—ç¬¦ä¸²â€ æ˜ å°„å…³ç³»çš„ â€œæŸ¥æ‰¾è¡¨â€ã€‚</p>
</div>
<div class="listingblock">
<div class="title">ä»£ç  3. æµ‹è¯•æšä¸¾çš„å­˜å‚¨å€¼</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">DROP</span> <span class="type">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> enum_test;
<span class="class">CREATE</span> <span class="type">TABLE</span> enum_test (e <span class="predefined-type">ENUM</span> (<span class="string"><span class="delimiter">'</span><span class="content">fish</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">apple</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">dog</span><span class="delimiter">'</span></span>));

<span class="class">INSERT</span> <span class="class">INTO</span> enum_test (e) <span class="keyword">VALUES</span> (<span class="string"><span class="delimiter">'</span><span class="content">fish</span><span class="delimiter">'</span></span>), (<span class="string"><span class="delimiter">'</span><span class="content">dog</span><span class="delimiter">'</span></span>), (<span class="string"><span class="delimiter">'</span><span class="content">apple</span><span class="delimiter">'</span></span>); <i class="conum" data-value="1"></i><b>(1)</b>

<span class="class">SELECT</span> e + <span class="integer">0</span> <span class="keyword">FROM</span> enum_test;

<span class="class">SELECT</span> e <span class="keyword">FROM</span> enum_test <span class="keyword">ORDER</span> <span class="keyword">BY</span> e; <i class="conum" data-value="2"></i><b>(2)</b>

<span class="class">SELECT</span> e <span class="keyword">FROM</span> enum_test <span class="keyword">ORDER</span> <span class="keyword">BY</span> field(e, <span class="string"><span class="delimiter">'</span><span class="content">apple</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">dog</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">fish</span><span class="delimiter">'</span></span>); <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>ä¸‰è¡Œæ•°æ®å®é™…å­˜å‚¨ä¸ºæ•´æ•°ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²ã€‚</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>æµ‹è¯•æ’åºæ€§</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>æ ¹æ®å®šä¹‰çš„å­—ç¬¦ä¸²æ’åº</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>å¦‚æœä½¿ç”¨æ•°å­—ä½œä¸º <code>ENUM</code> æšä¸¾å¸¸é‡ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´æ··ä¹±ã€‚å°½é‡é¿å…è¿™ä¹ˆåšã€‚</p>
</div>
<div class="paragraph">
<p>æšä¸¾å­—æ®µæ˜¯æŒ‰ç…§å†…éƒ¨å­˜å‚¨çš„æ•´æ•°è€Œä¸æ˜¯å®šä¹‰çš„å­—ç¬¦ä¸²è¿›è¡Œæ’åºçš„ã€‚ä¸€ç§ç»•è¿‡è¿™ç§é™åˆ¶çš„æ–¹å¼æ˜¯æŒ‰ç…§éœ€è¦çš„é¡ºåºæ¥å®šä¹‰æšä¸¾åˆ—ã€‚ä¹Ÿå¯ä»¥åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨ <code>FIELD()</code> å‡½æ•°æ˜¾å¼åœ°æŒ‡å®šæ’åºé¡ºåºï¼Œä½†æ˜¯ä¼šå¯¼è‡´ MySQL æ— æ³•åˆ©ç”¨ç´¢å¼•æ¶ˆé™¤æ’åºã€‚</p>
</div>
<div class="paragraph">
<p>æšä¸¾æœ€ä¸å¥½çš„åœ°æ–¹æ˜¯ï¼Œå­—ç¬¦ä¸²åˆ—è¡¨æ˜¯å›ºå®šçš„ï¼Œæ·»åŠ æˆ–åˆ é™¤å­—ç¬¦ä¸²å¿…é¡»ä½¿ç”¨ <code>ALTER TABLE</code>ã€‚åœ¨ MySQL 5.1 ä¸­æ”¯æŒåªåœ¨åˆ—è¡¨æœ«å°¾æ·»åŠ å…ƒç´ ï¼Œè€Œä¸ç”¨é‡å»ºæ•´ä¸ªè¡¨ã€‚</p>
</div>
<div class="paragraph">
<p>æŠŠæšä¸¾ä¿å­˜ä¸ºæ•´æ•°ï¼Œå¿…é¡»æŸ¥æ‰¾æ‰èƒ½è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œæœ‰å¼€é”€ã€‚å°¤å…¶å’Œå­—ç¬¦ä¸²çš„åˆ—å…³è”æŸ¥è¯¢æ—¶ï¼Œç”šè‡³ä¸å¦‚å­—ç¬¦ä¸²å…³è”å­—ç¬¦æ€§èƒ½å¥½ã€‚</p>
</div>
<div class="paragraph">
<p>é€šç”¨çš„è®¾è®¡å®è·µï¼šåœ¨â€œæŸ¥æ‰¾è¡¨â€æ—¶é‡‡ç”¨æ•´æ•°ä¸»é”®è€Œé¿å…é‡‡ç”¨åŸºäºå­—ç¬¦ä¸²è¿›è¡Œå…³è”ã€‚</p>
</div>
<div class="paragraph">
<p>æ ¹æ® <code>SHOW TABLE STATUS</code> å‘½ä»¤è¾“å‡ºç»“æœä¸­ <code>Data_length</code> åˆ—çš„å€¼ï¼ŒæŠŠåˆ—è½¬æ¢ä¸º <code>ENUM</code> å¯ä»¥è®©è¡¨çš„å¤§å°ç¼©å°.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_æ—¥æœŸå’Œæ—¶é—´ç±»å‹">1.1.4. æ—¥æœŸå’Œæ—¶é—´ç±»å‹</h4>
<div class="paragraph">
<p>MySQL èƒ½å­˜å‚¨çš„æœ€å°æ—¶é—´ç²’åº¦ä¸ºç§’ã€‚ä½†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¾®ç§’çº§çš„ç²’åº¦è¿›è¡Œä¸´æ—¶è¿ç®—ã€‚</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>DATETIME</code></dt>
<dd>
<p>ä¿å­˜å¤§èŒƒå›´çš„å€¼ï¼Œä» 1001 å¹´åˆ° 9999 å¹´ï¼Œç²¾åº¦ä¸ºç§’ã€‚æŠŠæ—¥æœŸå’Œæ—¶é—´å°è£…åˆ°æ ¼å¼ä¸º YYYYMMDDHHMMSS çš„æ•´æ•°ä¸­ï¼Œä¸æ—¶åŒºæ— å…³ã€‚ä½¿ç”¨ 8 ä¸ªå­—èŠ‚çš„å­˜å‚¨ç©ºé—´ã€‚</p>
</dd>
<dt class="hdlist1"><code>TIMESTAMP</code></dt>
<dd>
<p>ä¿å­˜ä» 1970 å¹´ 1 æœˆ 1 æ—¥åˆå¤œä»¥æ¥çš„ç§’æ•°ï¼Œå’Œ UNIX æ—¶é—´æˆ³ç›¸åŒã€‚<code>TIMESTAMP</code> åªä½¿ç”¨ 4 ä¸ªå­—èŠ‚çš„å­˜å‚¨ç©ºé—´ï¼ŒèŒƒå›´æ˜¯ä» 1970 å¹´åˆ° 2038 å¹´ã€‚</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>MySQL 4.1 ä»¥åŠæ›´æ–°çš„ç‰ˆæœ¬æŒ‰ç…§ <code>DATETIME</code> çš„æ–¹å¼æ ¼å¼åŒ– <code>TIMESTAMP</code> çš„å€¼ã€‚<code>TIMESTAMP</code> çš„å­˜å‚¨æ ¼å¼åœ¨å„ä¸ªç‰ˆæœ¬éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
</div>
<div class="paragraph">
<p><code>TIMESTAMP</code> æ˜¾ç¤ºçš„å€¼ä¹Ÿä¾èµ–äºæ—¶åŒºã€‚MySQL æœåŠ¡å™¨ã€æ“ä½œç³»ç»Ÿä»¥åŠå®¢æˆ·ç«¯è¿æ¥éƒ½æœ‰æ—¶åŒºè®¾ç½®ã€‚å› æ­¤ï¼Œå­˜å‚¨å€¼ä¸º 0 çš„ <code>TIMESTAMP</code> åœ¨ç¾å›½ä¸œéƒ¨æ—¶åŒºæ˜¾ç¤ºä¸º â€œ1969-12-31 19:00:00â€ï¼Œä¸æ ¼æ—å°¼æ²»æ—¶é—´å·®5ä¸ªå°æ—¶ã€‚</p>
</div>
<div class="paragraph">
<p>å¦‚æœåœ¨å¤šä¸ªæ—¶åŒºå­˜å‚¨æˆ–è®¿é—®æ•°æ®ï¼Œ <code>TIMESTAMP</code> å’Œ <code>DATETIME</code> çš„è¡Œä¸ºå°†ä¼šå¾ˆä¸ä¸€æ ·ã€‚å‰è€…æä¾›çš„å€¼ä¸æ—¶åŒºæœ‰å…³ï¼Œåè€…åˆ™ä¿ç•™æ–‡æœ¬è¡¨ç¤ºçš„æ—¥æœŸå’Œæ—¶é—´ã€‚</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
å¦‚æœåœ¨ä¸œå…«åŒºä¿å­˜ä¸º 2016å¹´12æœˆ05æ—¥17:34:17ï¼Œåœ¨æ ¼æ—å°¼æ²»æ˜¾ç¤ºä¸ºå¤šå°‘ï¼Ÿ
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœæ’å…¥æ—¶æ²¡æœ‰æŒ‡å®šç¬¬ä¸€ä¸ª <code>TIMESTAMP</code> åˆ—çš„å€¼ï¼ŒMySQL åˆ™è®¾ç½®è¿™ä¸ªåˆ—çš„å€¼ä¸ºå½“å‰æ—¶é—´ã€‚</p>
</div>
<div class="paragraph">
<p><code>TIMESTAMP</code> åˆ—é»˜è®¤ä¸º <code>NOT NULL</code>ã€‚</p>
</div>
<div class="paragraph">
<p>é€šå¸¸åº”è¯¥å°½é‡ä½¿ç”¨ <code>TIMESTAMP</code> ï¼Œå› ä¸ºå®ƒæ¯” <code>DATETIME</code> ç©ºé—´æ•ˆç‡æ›´é«˜ã€‚</p>
</div>
<div class="paragraph">
<p>å¯ä»¥ä½¿ç”¨ <code>BIGINT</code> ç±»å‹å­˜å‚¨å¾®ç§’çº§åˆ«çš„æ—¶é—´æˆ³ï¼Œæˆ–è€…ä½¿ç”¨ <code>DOUBLE</code> å­˜å‚¨ç§’ä¹‹åçš„å°æ•°éƒ¨åˆ†ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_ä½æ•°æ®ç±»å‹">1.1.5. ä½æ•°æ®ç±»å‹</h4>

</div>
<div class="sect3">
<h4 id="_é€‰æ‹©æ ‡è¯†ç¬¦_é”®åˆ—">1.1.6. é€‰æ‹©æ ‡è¯†ç¬¦ï¼ˆé”®åˆ—ï¼‰</h4>
<div class="paragraph">
<p>æ›´æœ‰å¯èƒ½ä½¿ç”¨æ ‡è¯†åˆ—ä¸å…¶ä»–å€¼è¿›è¡Œæ¯”è¾ƒï¼Œæˆ–è€…é€šè¿‡æ ‡è¯†åˆ—å¯»æ‰¾å…¶ä»–åˆ—ã€‚</p>
</div>
<div class="paragraph">
<p>é€‰æ‹©æ ‡è¯†åˆ—çš„ç±»å‹æ—¶ï¼Œä¸ä»…ä»…éœ€è¦<strong>è€ƒè™‘å­˜å‚¨ç±»å‹</strong>ï¼Œè¿˜éœ€è¦<strong>è€ƒè™‘ MySQL å¯¹è¿™ç§ç±»å‹æ€ä¹ˆæ‰§è¡Œè®¡ç®—å’Œæ¯”è¾ƒ</strong>ã€‚</p>
</div>
<div class="paragraph">
<p>ä¸€æ—¦é€‰å®šä¸€ç§ç±»å‹ï¼Œè¦ç¡®ä¿åœ¨æ‰€æœ‰å…³è”è¡¨ä¸­éƒ½ä½¿ç”¨åŒæ ·çš„ç±»å‹ã€‚ç±»å‹ä¹‹é—´éœ€è¦ç²¾ç¡®åŒ¹é…ï¼ŒåŒ…æ‹¬åƒ <code>UNSIGNED</code> è¿™æ ·çš„å±æ€§ã€‚æ··ç”¨ä¸åŒæ•°æ®ç±»å‹å¯èƒ½å¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œåœ¨æ¯”è¾ƒæ“ä½œæ—¶éšå¼ç±»å‹è½¬æ¢ä¹Ÿå¯èƒ½å¯¼è‡´å¾ˆéš¾å‘ç°çš„é”™è¯¯ã€‚</p>
</div>
<div class="paragraph">
<p>åœ¨å¯ä»¥æ»¡è¶³å€¼çš„èŒƒå›´çš„éœ€æ±‚ï¼Œå¹¶ä¸”é¢„ç•™ä¸ºäº†å¢é•¿ç©ºé—´çš„å‰æä¸‹ï¼Œåº”è¯¥é€‰æ‹©æœ€å°çš„æ•°æ®ç±»å‹ã€‚</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">æ•´æ•°ç±»å‹</dt>
<dd>
<p>æ•´æ•°é€šå¸¸æ˜¯æ ‡è¯†åˆ—æœ€å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒä»¬å¾ˆå¿«å¹¶ä¸”å¯ä»¥ä½¿ç”¨ <code>AUTO_INCREMENT</code>ã€‚</p>
</dd>
<dt class="hdlist1"><code>ENUM</code> å’Œ <code>SET</code> ç±»å‹</dt>
<dd>
<p>é€šå¸¸æ˜¯ä¸€ä¸ªç³Ÿç³•çš„é€‰æ‹©ã€‚ <code>ENUM</code> å’Œ <code>SET</code> åˆ—é€‚åˆå­˜å‚¨å›ºå®šä¿¡æ¯ã€‚</p>
</dd>
<dt class="hdlist1">å­—ç¬¦ä¸²ç±»å‹</dt>
<dd>
<p>å¦‚æœå¯èƒ½ï¼Œåº”è¯¥é¿å…ä½¿ç”¨å­—ç¬¦ä¸²ä½œä¸ºæ ‡è¯†åˆ—ï¼Œå› ä¸ºå®ƒä»¬å¾ˆæ¶ˆè€—ç©ºé—´ï¼Œå¹¶ä¸”é€šå¸¸æ¯”æ•°å­—ç±»å‹æ…¢ã€‚MyISAM é»˜è®¤å¯¹å­—ç¬¦ä¸²ä½¿ç”¨å‹ç¼©ç´¢å¼•ï¼Œè¿™ä¼šå¯¼è‡´æŸ¥è¯¢æ…¢å¾ˆå¤šã€‚</p>
<div class="paragraph">
<p>ä½¿ç”¨å®Œå…¨â€œéšæœºâ€çš„å­—ç¬¦ä¸²ä¹Ÿéœ€è¦å¤šåŠ æ³¨æ„ï¼Œä¾‹å¦‚ MD5()ã€SHA1()ã€ UUID()äº§ç”Ÿçš„å­—ç¬¦ä¸²ã€‚è¿™äº›æ–°å€¼ä¼šä»»æ„åˆ†å¸ƒåœ¨å¾ˆå¤§çš„ç©ºé—´å†…ï¼Œè¿™ä¼šå¯¼è‡´ <code>INSERT</code> ä»¥åŠä¸€äº› <code>SELECT</code> è¯­å¥å˜å¾—å¾ˆæ…¢ï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>æ’å…¥å€¼ä¼šéšæœºåœ°å†™åˆ°ç´¢å¼•çš„ä¸åŒä½ç½®ï¼Œæ‰€ä»¥ä½¿å¾— <code>INSERT</code> è¯­å¥æ›´æ…¢ã€‚è¿™ä¼šå¯¼è‡´é¡µåˆ†è£‚ã€ç£ç›˜éšæœºè®¿é—®ï¼Œä»¥åŠå¯¹äºèšç°‡å­˜å‚¨å¼•æ“äº§ç”Ÿèšç°‡ç´¢å¼•ç¢ç‰‡ã€‚</p>
</li>
<li>
<p><code>SELECT</code> è¯­å¥ä¼šå˜å¾—æ›´æ…¢ï¼Œå› ä¸ºé€»è¾‘ä¸Šç›¸é‚»çš„è¡Œä¼šåˆ†å¸ƒåœ¨ç£ç›˜å’Œå†…å­˜çš„ä¸åŒåœ°æ–¹ã€‚</p>
</li>
<li>
<p>éšæœºå€¼å¯¼è‡´ç¼“å­˜å¯¹æ‰€æœ‰ç±»å‹çš„æŸ¥è¯¢è¯­å¥æ•ˆæœéƒ½å¾ˆå·®ï¼Œå› ä¸ºä¼šä½¿å¾—ç¼“å­˜èµ–ä»¥å·¥ä½œçš„å±€éƒ¨è®¿é—®æ€§åŸç†å¤±æ•ˆã€‚å¦‚æœçœŸä¸ªæ•°æ®é›†éƒ½ä¸€æ ·çš„â€œçƒ­â€ï¼Œé‚£ä¹ˆç¼“å­˜ä»»ä½•ä¸€éƒ¨åˆ†ç‰¹åˆ«æ•°æ®åˆ°å†…å­˜éƒ½æ²¡æœ‰å¥½å¤„ï¼›å¦‚æœå·¥ä½œé›†æ¯”å†…å­˜å¤§ï¼Œç¼“å­˜å°†ä¼šæœ‰å¾ˆå¤šåˆ·æ–°å’Œä¸å‘½ä¸­ã€‚</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>å¦‚æœå­˜å‚¨ UUID å€¼ï¼Œåˆ™åº”è¯¥ç§»é™¤ â€œ-â€ ç¬¦å·ï¼›æ›´å¥½çš„åšæ³•æ˜¯ï¼Œä½¿ç”¨ <code>UNHEX()</code> å‡½æ•°è½¬æ¢ UUID å€¼ä¸º 16 å­—èŠ‚çš„æ•°å­—ï¼Œå¹¶ä¸”å­˜å‚¨åœ¨ä¸€ä¸ª <code>BINARY(16)</code> åˆ—ä¸­ã€‚æ£€ç´¢æ—¶å¯ä»¥é€šè¿‡ `HEX()`å‡½æ•°æ¥æ ¼å¼åŒ–ä¸ºåå…­è¿›åˆ¶æ ¼å¼ã€‚</p>
</div>
<div class="paragraph">
<p>UUID å€¼è¿˜æ˜¯æœ‰ä¸€å®šçš„é¡ºåºçš„ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_ç‰¹æ®Šç±»å‹æ•°æ®">1.1.7. ç‰¹æ®Šç±»å‹æ•°æ®</h4>
<div class="ulist">
<ul>
<li>
<p>ä½äºç§’çº§ç²¾åº¦çš„æ—¶é—´æˆ³</p>
</li>
<li>
<p>IPv4 åœ°å€&#8201;&#8212;&#8201;<code>INET_ATON()</code> å’Œ <code>INET_NTOA()</code>ã€‚</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mysql_schema_è®¾è®¡ä¸­çš„é™·é˜±">1.2. MySQL Schema è®¾è®¡ä¸­çš„é™·é˜±</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">å¤ªå¤šçš„åˆ—</dt>
<dd>
<p>MySQL çš„å­˜å‚¨å¼•æ“ API å·¥ä½œæ—¶éœ€è¦åœ¨æœåŠ¡å™¨å±‚å’Œå­˜å‚¨å¼•æ“å±‚ä¹‹é—´é€šè¿‡è¡Œç¼“å†²æ ¼å¼æ‹·è´æ•°æ®ï¼Œç„¶ååœ¨æœåŠ¡å™¨å±‚å°†ç¼“å†²å†…å®¹è§£ç æˆå„ä¸ªåˆ—ã€‚ä»è¡Œç¼“å†²ä¸­å°†è§£ç è¿‡çš„åˆ—è½¬æ¢æˆè¡Œæ•°æ®ç»“æ„çš„æ“ä½œä»£ä»·æ˜¯éå¸¸é«˜çš„ã€‚ MyISAM å®šé•¿è¡Œç»“æ„æ­£å¥½åŒ¹é…ï¼Œä¸éœ€è¦è½¬æ¢ã€‚MyISAM çš„å˜é•¿è¡Œç»“æ„å’Œ InnoDB çš„è¡Œç»“æ„åˆ™æ€»æ˜¯éœ€è¦è½¬æ¢ã€‚<strong>è½¬æ¢çš„ä»£ä»·ä¾èµ–äºåˆ—çš„æ•°é‡ã€‚</strong></p>
</dd>
<dt class="hdlist1">å¤ªå¤šçš„å…³è”</dt>
<dd>
<p>MySQL é™åˆ¶äº†æ¯ä¸ªå…³è”æ“ä½œæœ€å¤šåªèƒ½æœ‰ 61 å¼ è¡¨ã€‚ä¸€ä¸ªç²—ç•¥çš„ç»éªŒæ³•åˆ™ï¼Œå¦‚æœå¸Œæœ›æŸ¥è¯¢æ‰§è¡Œå¾—å¿«é€Ÿä¸”å¹¶å‘æ€§å¥½ï¼Œå•ä¸ªæŸ¥è¯¢æœ€å¥½åœ¨ 12 ä¸ªè¡¨ä»¥å†…åšå…³è”ã€‚</p>
</dd>
<dt class="hdlist1">å…¨èƒ½çš„æšä¸¾</dt>
<dd>
<p>æ³¨æ„é˜²æ­¢è¿‡åº¦ä½¿ç”¨æšä¸¾ã€‚ä¿®æ”¹æšä¸¾ï¼Œå°±éœ€è¦ <code>ALTER TABLE</code>ï¼Œåœ¨ 5.1 å’Œæ›´æ–°ç‰ˆæœ¬ä¸­ï¼Œåªæœ‰åœ¨æœ«å°¾å¢åŠ å€¼æ—¶ï¼Œä¸éœ€è¦ <code>ALTER TABLE</code>ã€‚</p>
</dd>
<dt class="hdlist1">å˜ç›¸çš„æšä¸¾</dt>
<dd>
<p>æšä¸¾åˆ—å…è®¸åœ¨åˆ—ä¸­å­˜å‚¨ä¸€ç»„å®šä¹‰å€¼ä¸­çš„å•ä¸ªå€¼ï¼Œé›†åˆï¼ˆ <code>SET</code> ï¼‰åˆ—åˆ™å…è®¸åœ¨åˆ—ä¸­å­˜å‚¨ä¸€ç»„å®šä¹‰å€¼ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ã€‚æ¯”å¦‚: <code>CREATE TABLE set_test ( is_default SET ('Y', 'N') NOT NULL DEFAULT 'N' );</code> çœŸå‡åªæœ‰ä¸€ä¸ªï¼Œå®šä¹‰ä¸ºæšä¸¾æ›´å¥½ã€‚</p>
</dd>
<dt class="hdlist1">éæ­¤å‘æ˜çš„ NULL</dt>
<dd>
<p>å»ºè®®ä¸è¦å­˜ NULLã€‚ä½†æ˜¯ä¸è¦èµ°æç«¯ã€‚å½“ç¡®å®éœ€è¦è¡¨ç¤ºæœªçŸ¥å€¼æ—¶ä¹Ÿä¸è¦å®³æ€•ä½¿ç”¨ NULLã€‚å¤„ç† NULL ç¡®å®ä¸å®¹æ˜“ï¼Œä½†æœ‰æ—¶å€™ä¼šæ¯”å®ƒçš„æ›¿ä»£æ–¹æ¡ˆæ›´å¥½ã€‚</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_èŒƒå¼å’ŒåèŒƒå¼">1.3. èŒƒå¼å’ŒåèŒƒå¼</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">ç¬¬ä¸€èŒƒå¼</dt>
<dd>
<p>ç¬¦åˆ1NFçš„å…³ç³»ä¸­çš„æ¯ä¸ªå±æ€§éƒ½ä¸å¯å†åˆ†ã€‚1NFæ˜¯æ‰€æœ‰å…³ç³»å‹æ•°æ®åº“çš„æœ€åŸºæœ¬è¦æ±‚ã€‚</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://www.zhihu.com/question/24696366/answer/29189700">è§£é‡Šä¸€ä¸‹å…³ç³»æ•°æ®åº“çš„ç¬¬ä¸€ç¬¬äºŒç¬¬ä¸‰èŒƒå¼ï¼Ÿ - åˆ˜æ…°çš„å›ç­” - çŸ¥ä¹</a></p>
</div>
<div class="paragraph">
<p><strong>èŒƒå¼åŒ–é€šå¸¸å¸¦æ¥çš„å¥½å¤„ï¼š</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>èŒƒå¼åŒ–çš„æ›´æ–°æ“ä½œé€šå¸¸æ¯”åèŒƒå¼åŒ–è¦å¿«ã€‚</p>
</li>
<li>
<p>å½“æ•°æ®è¾ƒå¥½åœ°èŒƒå¼åŒ–æ—¶ï¼Œå°±åªæœ‰å¾ˆå°‘æˆ–è€…æ²¡æœ‰é‡å¤æ•°æ®ï¼Œæ‰€ä»¥åªéœ€è¦ä¿®æ”¹æ›´å°‘çš„æ•°æ®ã€‚</p>
</li>
<li>
<p>èŒƒå¼åŒ–çš„è¡¨é€šå¸¸æ›´å°ï¼Œå¯ä»¥æ›´å¥½åœ°å­˜æ”¾åœ¨å†…å­˜é‡Œï¼Œæ‰€ä»¥æ‰§è¡Œæ“ä½œä¼šæ›´å¿«ã€‚</p>
</li>
<li>
<p>å¾ˆå°‘æœ‰å¤šä½™çš„æ•°æ®æ„å‘³ç€æ£€ç´¢åˆ—è¡¨æ•°æ®æ—¶ï¼Œæ›´å°‘éœ€è¦ <code>DISTINCT</code> æˆ–è€… <code>GROUP BY</code> è¯­å¥ã€‚</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>èŒƒå¼åŒ–è®¾è®¡çš„ Schema çš„ç¼ºç‚¹æ˜¯é€šå¸¸éœ€è¦å…³è”ã€‚</p>
</div>
<div class="paragraph">
<p><strong>åèŒƒå¼çš„ä¼˜ç¼ºç‚¹</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>åèŒƒå¼åŒ–çš„ Schema å› ä¸ºæ‰€æœ‰æ•°æ®éƒ½åœ¨ä¸€å¼ è¡¨ä¸­ï¼Œå¯ä»¥å¾ˆå¥½åœ°é¿å…å…³è”ã€‚</p>
</li>
<li>
<p>å•ç‹¬çš„è¡¨ä¹Ÿèƒ½ä½¿ç”¨æ›´æœ‰æ•ˆçš„ç´¢å¼•ç­–ç•¥ã€‚</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>æ··ç”¨èŒƒå¼åŒ–å’ŒåèŒƒå¼åŒ–</strong></p>
</div>
<div class="paragraph">
<p>å®Œå…¨çš„èŒƒå¼åŒ–å’Œå®Œå…¨çš„åèŒƒå¼åŒ– Schema éƒ½æ˜¯å®éªŒå®¤é‡Œæ‰æœ‰çš„ä¸œè¥¿ã€‚åœ¨å®é™…åº”ç”¨ä¸­ç»å¸¸éœ€è¦æ··ç”¨ï¼Œå¯èƒ½ä½¿ç”¨éƒ¨åˆ†èŒƒå¼åŒ–çš„ Schemaã€ç¼“å­˜è¡¨ï¼Œä»¥åŠå…¶ä»–æŠ€å·§ã€‚</p>
</div>
<div class="paragraph">
<p>æœ€å¸¸è§çš„åèŒƒå¼åŒ–æ•°æ®çš„æ–¹æ³•æ˜¯å¤åˆ¶æˆ–è€…ç¼“å­˜ï¼Œåœ¨ä¸åŒçš„è¡¨ä¸­å­˜å‚¨ç›¸åŒçš„ç‰¹å®šåˆ—ã€‚</p>
</div>
<div class="paragraph">
<p>ä»çˆ¶è¡¨å†—ä½™ä¸€äº›æ•°æ®åˆ°å­è¡¨çš„åˆ©ç›Šæ˜¯æ’åºçš„éœ€è¦ã€‚</p>
</div>
<div class="paragraph">
<p>ç¼“å­˜è¡ç”Ÿå€¼ä¹Ÿæ˜¯æœ‰ç”¨çš„ã€‚</p>
</div>
</div>
<div class="sect2">
<h3 id="_ç¼“å­˜è¡¨å’Œæ±‡æ€»è¡¨">1.4. ç¼“å­˜è¡¨å’Œæ±‡æ€»è¡¨</h3>
<div class="paragraph">
<p>æœ‰æ—¶æå‡æ€§èƒ½æœ€å¥½çš„æ–¹æ³•æ˜¯åœ¨åŒä¸€å¼ è¡¨ä¸­ä¿å­˜è¡ç”Ÿçš„å†—ä½™æ•°æ®ï¼›æœ‰æ—¶ä¹Ÿéœ€è¦åˆ›å»ºä¸€å¼ å®Œå…¨ç‹¬ç«‹çš„æ±‡æ€»è¡¨æˆ–ç¼“å­˜è¡¨ã€‚</p>
</div>
<div class="paragraph">
<p>ç¼“å­˜è¡¨è¡¨ç¤ºå­˜å‚¨é‚£äº›å¯ä»¥æ¯”è¾ƒç®€å•åœ°ä» Schema å…¶ä»–è¡¨è·å–æ•°æ®çš„è¡¨ã€‚<br>
æ±‡æ€»è¡¨è¡¨ç¤ºä¿å­˜çš„æ˜¯ä½¿ç”¨ <code>GROUP BY</code> è¯­å¥èšåˆæ•°æ®çš„è¡¨ã€‚</p>
</div>
<div class="paragraph">
<p>ä¸€ä¸ªæœ‰ç”¨çš„æŠ€å·§æ˜¯å¯¹ç¼“å­˜è¡¨ä½¿ç”¨ä¸åŒçš„å­˜å‚¨å¼•æ“ã€‚ä¾‹å¦‚ï¼šä¸»è¡¨ç”¨ InnoDBï¼Œä½¿ç”¨ MyISAM ä½œä¸ºç¼“å­˜è¡¨çš„å¼•æ“å°†ä¼šå¾—åˆ°æ›´å°çš„ç´¢å¼•å ç”¨ç©ºé—´ï¼Œå¹¶ä¸”å¯ä»¥åšå…¨æ–‡æ£€ç´¢ã€‚</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
å…¨æ–‡æ£€ç´¢è¿˜æ˜¯ä½¿ç”¨ä¸“é—¨çš„å·¥å…·ï¼Œæ¯”å¦‚ ElasticSearch æ›´å¥½ã€‚
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>åœ¨ä½¿ç”¨ç¼“å­˜è¡¨å’Œæ±‡æ€»è¡¨æ—¶ï¼Œå¿…é¡»å†³å®šæ˜¯å®æ—¶ç»´æŠ¤æ•°æ®è¿˜æ˜¯å®šæ—¶é‡å»ºã€‚çœ‹éœ€æ±‚ã€‚å®šæ—¶é‡å»ºä¸ä»…èŠ‚çœèµ„æºï¼Œè¿˜ä¿æŒè¡¨ä¸ä¼šæœ‰å¾ˆå¤šç¢ç‰‡ï¼Œä»¥åŠå®Œå…¨é¡ºåºç»„ç»‡çš„ç´¢å¼•ï¼ˆè¿™ä¼šæ›´åŠ é«˜æ•ˆï¼‰ã€‚</p>
</div>
<div class="paragraph">
<p>å½“é‡å»ºæ±‡æ€»è¡¨å’Œç¼“å­˜è¡¨æ—¶ï¼Œä½¿ç”¨â€œå½±å­è¡¨â€æ¥ä¿è¯æ•°æ®åœ¨æ“ä½œæ—¶ä¾ç„¶å¯ç”¨ã€‚</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">DROP</span> <span class="type">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> my_summary_new, my_summary_old;

<span class="class">CREATE</span> <span class="type">TABLE</span> my_summary_new <span class="keyword">LIKE</span> my_summary;

<span class="comment">-- TODOï¼šæ‰§è¡Œæ±‡æ€»æ“ä½œ</span>

RENAME <span class="type">TABLE</span> my_summary <span class="keyword">TO</span> my_summary_old, my_summary_new <span class="keyword">TO</span> my_summary;</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_ç‰©åŒ–è§†å›¾">1.4.1. ç‰©åŒ–è§†å›¾</h4>
<div class="paragraph">
<p>ç‰©åŒ–è§†å›¾æ˜¯é¢„å…ˆè®¡ç®—å¹¶ä¸”å­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„è¡¨ï¼Œå¯ä»¥é€šè¿‡å„ç§å„æ ·çš„ç­–ç•¥åˆ·æ–°å’Œæ›´æ–°ã€‚</p>
</div>
<div class="paragraph">
<p>MySQL å¹¶ä¸åŸç”Ÿæ”¯æŒç‰©åŒ–è§†å›¾ã€‚</p>
</div>
<div class="paragraph">
<p>Justin Swanhart çš„å¼€æºå·¥å…· Flexviewsï¼Œ <a href="https://github.com/greenlion/swanhart-tools">Swanhart Toolkit</a>ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_è®¡æ•°å™¨è¡¨">1.4.2. è®¡æ•°å™¨è¡¨</h4>
<div class="paragraph">
<p>å¯ä»¥åˆ©ç”¨ <code>CurrentHashMap</code> åˆ†æ®µé”çš„æ€æƒ³ï¼Œå°†å¯¹åŒä¸€ä¸ªè®¡ç®—å™¨çš„ä¿®æ”¹ï¼Œæ‰“æ•£åˆ°å¤šä¸ªå˜é‡ä¸Šï¼Œç„¶ååœ¨æ±‚å’Œã€‚</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">DROP</span> <span class="type">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> hit_counter;
<span class="class">CREATE</span> <span class="type">TABLE</span> hit_counter (
  slot <span class="predefined-type">TINYINT</span> <span class="predefined-type">UNSIGNED</span> <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>  <span class="directive">PRIMARY</span> <span class="type">KEY</span>,
  cnt  <span class="predefined-type">INT</span> <span class="predefined-type">UNSIGNED</span>     <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>
)<span class="directive">ENGINE</span> = InnoDB;

<span class="class">UPDATE</span> hit_counter <span class="class">SET</span> cnt = cnt + <span class="integer">1</span> <span class="keyword">WHERE</span> slot = RAND() * <span class="integer">100</span>;

<span class="class">SELECT</span> <span class="predefined">SUM</span>(cnt) <span class="keyword">FROM</span> hit_counter;</code></pre>
</div>
</div>
<div class="paragraph">
<p>ä¸€ä¸ªå¸¸è§éœ€è¦æ—¶æ¯ä¸ªä¸€æ®µæ—¶é—´å¼€å§‹ä¸€ä¸ªæ–°çš„è®¡ç®—å™¨ï¼ˆä¾‹å¦‚ï¼Œæ¯å¤©ä¸€ä¸ªï¼‰ã€‚</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">DROP</span> <span class="type">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> daily_hit_counter;
<span class="class">CREATE</span> <span class="type">TABLE</span> daily_hit_counter (
  day  <span class="predefined-type">DATE</span>             <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
  slot <span class="predefined-type">TINYINT</span> <span class="predefined-type">UNSIGNED</span> <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
  cnt  <span class="predefined-type">INT</span> <span class="predefined-type">UNSIGNED</span>     <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
  <span class="directive">PRIMARY</span> <span class="type">KEY</span> (day, slot)
)<span class="directive">ENGINE</span> = InnoDB;

<span class="comment">-- æ’å…¥æ•°æ®</span>
<span class="class">INSERT</span> <span class="class">INTO</span> daily_hit_counter (day, slot, cnt)
<span class="keyword">VALUES</span> (current_date, rand() * <span class="integer">100</span>, <span class="integer">1</span>)
<span class="keyword">ON</span> DUPLICATE <span class="type">KEY</span> <span class="class">UPDATE</span> cnt = cnt + <span class="integer">1</span>;

<span class="comment">-- å®šæœŸæ‰§è¡Œï¼šåˆå¹¶æ‰€æœ‰ç»“æœåˆ° 0 å·æ§½ï¼Œå¹¶ä¸”åˆ é™¤æ‰€æœ‰å…¶ä»–çš„æ§½ï¼š</span>
<span class="class">UPDATE</span> daily_hit_counter <span class="keyword">AS</span> c
  <span class="keyword">INNER</span> <span class="keyword">JOIN</span> (
               <span class="class">SELECT</span>
                 day,
                 <span class="predefined">sum</span>(cnt)  <span class="keyword">AS</span> cnt,
                 <span class="predefined">min</span>(slot) <span class="keyword">AS</span> mslot
               <span class="keyword">FROM</span> daily_hit_counter
               <span class="keyword">GROUP</span> <span class="keyword">BY</span> day
             ) <span class="keyword">AS</span> x <span class="keyword">USING</span> (day)
<span class="class">SET</span> c.cnt = <span class="keyword">if</span>(c.slot = x.mslot, x.cnt, <span class="integer">0</span>),
  c.slot  = <span class="keyword">if</span>(c.slot = x.mslot, <span class="integer">0</span>, c.slot);
<span class="class">DELETE</span> <span class="keyword">FROM</span> daily_hit_counter <span class="keyword">WHERE</span> slot &lt;&gt; <span class="integer">0</span> <span class="keyword">AND</span> cnt = <span class="integer">0</span>;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
ä¸ºäº†æå‡åº¦æŸ¥è¯¢çš„é€Ÿåº¦ï¼Œå¯ä»¥å»ºç«‹é¢å¤–ç´¢å¼•ï¼›è¿™æ ·ä¼šå¢åŠ äº›æŸ¥è¯¢çš„è´Ÿæ‹…ï¼Œè™½ç„¶å†™çš„æ…¢ï¼Œä½†æ˜¯æ›´æ˜¾è‘—æé«˜äº†è¯»æ“ä½œçš„æ€§èƒ½ã€‚
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_åŠ å¿«_code_alter_table_code_æ“ä½œçš„é€Ÿåº¦">1.5. åŠ å¿« <code>ALTER TABLE</code> æ“ä½œçš„é€Ÿåº¦</h3>
<div class="paragraph">
<p>MySQL çš„ <code>ALTER TABLE</code> æ“ä½œçš„æ€§èƒ½å¯¹äºå¤§è¡¨æ¥è¯´æ˜¯ä¸ªå¤§é—®é¢˜ã€‚ MySQL æ‰§è¡Œå¤§éƒ¨åˆ†ä¿®æ”¹è¡¨ç»“æ„æ“ä½œçš„æ–¹æ³•æ˜¯ç”¨æ–°çš„ç»“æ„åˆ›å»ºä¸€ä¸ªç©ºè¡¨ï¼Œä»æ—§è¡¨ä¸­æŸ¥å‡ºæ‰€æœ‰æ•°æ®æ’å…¥æ–°è¡¨ï¼Œç„¶ååˆ é™¤æ—§è¡¨ã€‚</p>
</div>
<div class="paragraph">
<p>ä¸€èˆ¬è€Œè¨€ï¼Œå¤§éƒ¨åˆ† <code>ALTER TABLE</code> æ“ä½œå°†å¯¼è‡´ MySQL æœåŠ¡ä¸­æ–­ã€‚æœ‰ä¸¤ä¸ªæŠ€å·§å¯ä»¥é¿å…ï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>å…ˆåœ¨ä¸€å°ä¸æä¾›æœåŠ¡çš„æœºå™¨ä¸Šæ‰§è¡Œ <code>ALTER TABLE</code> æ“ä½œï¼Œç„¶åå’Œæä¾›æœåŠ¡çš„ä¸»åº“è¿›è¡Œåˆ‡æ¢ï¼›</p>
</li>
<li>
<p>å½±å­æ‹·è´ï¼šç”¨è¦æ±‚çš„è¡¨ç»“æ„åˆ›å»ºä¸€å¼ å’Œæºè¡¨æ— å…³çš„æ–°è¡¨ï¼Œç„¶åé€šè¿‡é‡å‘½åå’Œåˆ è¡¨çš„æ“ä½œäº¤æ¢ä¸¤å¼ è¡¨ã€‚è¿˜æœ‰ä¸€äº›ç¬¬ä¸‰æ–¹å·¥å…·å¯ä»¥å®Œæˆï¼š</p>
<div class="ulist">
<ul>
<li>
<p>Facebook <a href="https://launchpad.net/mysqlatfacebook">online schema change</a></p>
</li>
<li>
<p>Shlomi Noach <a href="http://code.openark.org">openark toolkit</a></p>
</li>
<li>
<p><a href="http://www.percona.com/software">Percona Toolkit</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>ä¸æ˜¯æ‰€æœ‰çš„ <code>ALTER TABLE</code> æ“ä½œéƒ½ä¼šå¼•èµ·è¡¨é‡å»ºã€‚</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="comment">-- å¾ˆæ…¢ï¼ŒN å¤šæ¬¡è¯»å’Œ N å¤šæ¬¡æ’å…¥æ“ä½œ</span>
<span class="class">ALTER</span> <span class="type">TABLE</span> film
  MODIFY <span class="type">COLUMN</span> rental_duration <span class="predefined-type">TINYINT</span>(<span class="integer">3</span>) <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span> <span class="directive">DEFAULT</span> <span class="integer">5</span>;

<span class="comment">-- ç›´æ¥ä¿®æ”¹ _.frm_ æ–‡ä»¶è€Œä¸è®¾è®¡è¡¨æ•°æ®ã€‚æ“ä½œéå¸¸å¿«ã€‚</span>
<span class="class">ALTER</span> <span class="type">TABLE</span> film
  <span class="class">ALTER</span> <span class="type">COLUMN</span> rental_duration <span class="class">SET</span> <span class="directive">DEFAULT</span> <span class="integer">5</span>;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>ALTER TABLE</code> å…è®¸ä½¿ç”¨ <code>ALTER COLUMN</code>ã€ <code>MODIFY COLUMN</code> å’Œ <code>CHANGE COLUMN</code> è¯­å¥ä¿®æ”¹åˆ—ã€‚è¿™ä¸‰ç§æ“ä½œéƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚ <em>æœ‰ä»€ä¹ˆä¸ä¸€æ ·å‘¢ï¼Ÿ</em>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_åªä¿®æ”¹_em_frm_em_æ–‡ä»¶">1.5.1. åªä¿®æ”¹ <em>.frm</em> æ–‡ä»¶</h4>
<div class="paragraph">
<p>ä¸‹é¢çš„è¿™äº›æ“ä½œæœ‰å¯èƒ½ä¸éœ€è¦é‡å»ºè¡¨ï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ç§»é™¤ä¸€ä¸ªåˆ—çš„ <code>AUTO_INCREMENT</code> å±æ€§ï¼›</p>
</li>
<li>
<p>å¢åŠ ã€ç§»é™¤ï¼Œæˆ–æ›´æ”¹ <code>ENUM</code> å’Œ <code>SET</code> å¸¸é‡ã€‚</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>åŸºæœ¬çš„æŠ€æœ¯æ˜¯ä¸ºæƒ³è¦çš„è¡¨ç»“æ„åˆ›å»ºä¸€ä¸ªæ–°çš„ <em>.frm</em> æ–‡ä»¶ï¼Œç„¶åç”¨å®ƒæ›¿æ¢æ‰å·²ç»å­˜åœ¨çš„é‚£å¼ è¡¨çš„ <em>.frm</em> æ–‡ä»¶ã€‚æ­¥éª¤å¦‚ä¸‹ï¼š</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>åˆ›å»ºä¸€å¼ æœ‰ç›¸åŒç»“æ„çš„ç©ºè¡¨ï¼Œå¹¶è¿›è¡Œæ‰€éœ€è¦çš„ä¿®æ”¹ï¼›</p>
</li>
<li>
<p>æ‰§è¡Œ <code>FLUSH TABLES WITH READ LOCK</code>ã€‚è¿™å°†ä¼šå…³é—­æ‰€æœ‰æ­£åœ¨ä½¿ç”¨çš„è¡¨ï¼Œå¹¶ä¸”ç¦æ­¢ä»»ä½•è¡¨è¢«æ‰“å¼€ï¼›</p>
</li>
<li>
<p>äº¤æ¢ <em>.frm</em> æ–‡ä»¶ï¼›</p>
</li>
<li>
<p>æ‰§è¡Œ <code>UNLOCK TABLES</code> æ¥é‡Šæ”¾ç¬¬2æ­¥çš„è¯»é”ã€‚</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_å¿«é€Ÿåˆ›å»º_myisam_ç´¢å¼•">1.5.2. å¿«é€Ÿåˆ›å»º MyISAM ç´¢å¼•</h4>
<div class="paragraph">
<p>ä¸ºäº†é«˜æ•ˆåœ°è½½å…¥æ•°æ®åˆ° MyISAM è¡¨ä¸­ï¼Œæœ‰ä¸€ä¸ªå¸¸ç”¨çš„æŠ€å·§æ˜¯å…ˆç¦ç”¨ç´¢å¼•ã€è½½å…¥æ•°æ®ï¼Œç„¶åé‡æ–°å¯ç”¨ç´¢å¼•ã€‚</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">ALTER</span> <span class="type">TABLE</span> load_data DISABLE KEYS;

<span class="comment">-- è½½å…¥æ•°æ®</span>

<span class="class">ALTER</span> <span class="type">TABLE</span> load_data ENABLE KEYS;</code></pre>
</div>
</div>
<div class="paragraph">
<p>ä¸è¿‡ï¼Œè¿™ä¸ªåŠæ³•å¯¹å”¯ä¸€ç´¢å¼•æ— æ•ˆï¼Œå› ä¸º <code>DISABLE KEYS</code> åªå¯¹éå”¯ä¸€ç´¢å¼•æœ‰æ•ˆã€‚</p>
</div>
<div class="paragraph">
<p>ç°ä»£ç‰ˆæœ¬çš„ InnoDB ä¸­æœ‰ç±»ä¼¼çš„æŠ€å·§ã€‚</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_æ€»ç»“">1.6. æ€»ç»“</h3>
<div class="ulist">
<ul>
<li>
<p>å°½é‡é¿å…è¿‡åº¦è®¾è®¡ï¼›</p>
</li>
<li>
<p>ä½¿ç”¨å°è€Œç®€å•çš„åˆé€‚æ•°æ®ç±»å‹ï¼Œé™¤éçœŸçš„éœ€è¦ï¼Œå¦åˆ™åº”å°½å¯èƒ½é¿å…ä½¿ç”¨ <code>NULL</code>ï¼›</p>
</li>
<li>
<p>å°½é‡ä½¿ç”¨ç›¸åŒçš„æ•°æ®ç±»å‹å­˜å‚¨ç›¸ä¼¼æˆ–ç›¸å…³çš„å€¼ï¼Œå°¤å…¶æ˜¯è¦åœ¨å…³è”æ¡ä»¶ä¸­ä½¿ç”¨çš„åˆ—ï¼›</p>
</li>
<li>
<p>æ³¨æ„å¯å˜é•¿å­—ç¬¦ä¸²ï¼Œå…¶åœ¨ä¸´æ—¶è¡¨å’Œæ’åºæ—¶å¯èƒ½å¯¼è‡´æ‚²è§‚çš„æŒ‰æœ€å¤§é•¿åº¦åˆ†é…å†…å­˜ï¼›</p>
</li>
<li>
<p>å°½é‡ä½¿ç”¨æ•´å‹å®šä¹‰æ ‡è¯†åˆ—ï¼›</p>
</li>
<li>
<p>é¿å…ä½¿ç”¨ MySQL å·²ç»é—å¼ƒçš„ç‰¹æ€§ï¼Œä¾‹å¦‚æŒ‡å®šæµ®ç‚¹æ•°çš„ç²¾åº¦ï¼Œæˆ–è€…æ•´å‹çš„æ˜¾ç¤ºå®½åº¦ï¼›</p>
</li>
<li>
<p>å°å¿ƒä½¿ç”¨ <code>ENUM</code> å’Œ <code>SET</code>ï¼›</p>
</li>
<li>
<p>æœ€å¥½é¿å…ä½¿ç”¨ <code>BIT</code>ã€‚</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_åˆ›å»ºç´¢å¼•">2. åˆ›å»ºç´¢å¼•</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ç´¢å¼•ä¼˜åŒ–åº”è¯¥æ˜¯å¯¹æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–æœ€æœ‰æ•ˆçš„æ‰‹æ®µã€‚å¯ä»¥è½»æ¾æé«˜å‡ ä¸ªæ•°é‡çº§ã€‚</p>
</div>
<div class="paragraph">
<p>åˆ›å»ºä¸€ä¸ªçœŸæ­£çš„â€œæœ€ä¼˜â€çš„ç´¢å¼•ç»å¸¸éœ€è¦é‡å†™æŸ¥è¯¢ã€‚</p>
</div>
<div class="paragraph">
<p>å¸¸è¨€é“ï¼šçŸ¥å…¶ç„¶ï¼ŒçŸ¥å…¶æ‰€ä»¥ç„¶ã€‚å­¦ä¹ ä¸€é—¨æŠ€æœ¯çš„æ—¶å€™ï¼Œä¸ä»…è¦å­¦æ€ä¹ˆä½¿ç”¨ï¼Œè¿˜è¦å­¦ä¹ è¿™é—¨æŠ€æœ¯å‡ºç°çš„èƒŒæ™¯æ˜¯ä»€ä¹ˆï¼Œæ˜¯ä¸ºäº†è§£å†³ä»€ä¹ˆé—®é¢˜å‡ºç°çš„ï¼ŒæŠ€æœ¯æœ¬èº«åˆæœ‰ä»€ä¹ˆä¸è¶³ã€‚è¿™æ ·æ‰èƒ½æ›´å¥½åœ°ç†è§£è¿™é—¨æŠ€æœ¯ã€‚æ‰€ä»¥ï¼Œåœ¨æ­£å¼å¼€å§‹è®²è§£ç´¢å¼•ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆçœ‹çœ‹ç´¢å¼•å‡ºç°çš„åŸå› ä»¥åŠå®ç°ç´¢å¼•æ—¶ä½¿ç”¨çš„æ•°æ®ç»“æ„ã€‚</p>
</div>
<div class="sect2">
<h3 id="_è¿½æœ¬æº¯æº">2.1. è¿½æœ¬æº¯æº</h3>
<div class="paragraph">
<p>è®¡ç®—æœºç§‘å­¦åˆ†ä¸ºä¸¤å—ï¼Œä¸€å—æ˜¯ç¡¬ä»¶ï¼›å¦å¤–ï¼Œä¸€å—å°±æ˜¯è½¯ä»¶ã€‚æˆ‘ä»¬ä»è¿™ä¸¤æ–¹é¢è¯´èµ·ã€‚</p>
</div>
<div class="paragraph">
<p>è®¡ç®—æœºä¸­ï¼Œæ•°æ®æœ€åè¿˜æ˜¯è¦è½åœ°åˆ°å­˜å‚¨ä»‹è´¨ä¸­ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä¸€ä¸‹è®¡ç®—æœºä¸­çš„å­˜å‚¨ä»‹è´¨ã€‚</p>
</div>
<div class="paragraph">
<p>1984 å¹´è·å¾—äº†å›¾çµå¥–è€…ç‘å£«è®¡ç®—æœºç§‘å­¦å®¶å°¼å…‹åŠ³æ–¯Â·å¨èŒ¨ï¼ˆNiklaus Wirthï¼‰æå‡ºä¸€ä¸ªè‘—åå…¬å¼ â€œç®—æ³• + æ•°æ®ç»“æ„ = ç¨‹åºâ€ï¼ˆAlgorithm + Data Structures = Programsï¼‰ï¼Œç®€æ˜æ‰¼è¦åœ°è¯´æ˜äº†ç®—æ³•ã€æ•°æ®ç»“æ„åŠç¨‹åºä¸‰è€…ä¹‹é—´çš„å…³ç³»ã€‚ç¨‹åºè®¾è®¡æ˜¯ä¸€ç§æ™ºåŠ›åŠ³åŠ¨ï¼Œç®—æ³•ä¸æ•°æ®ç»“æ„æ˜¯ç¼–ç¨‹ä¹‹é“ä¸­çš„â€œå†…åŠŸå¿ƒæ³•â€ï¼Œç¼ºä¹ç®—æ³•ä¸æ•°æ®ç»“æ„ç´ å…»ï¼Œç¼–ç¨‹å®è·µéš¾ä»¥æ·±å…¥ï¼Œä¹Ÿä¼šé™åˆ¶ç å†œåˆ©ç”¨è®¡ç®—æœºè§£å†³å®é™…é—®é¢˜çš„èƒ½åŠ›ã€‚</p>
</div>
<div class="paragraph">
<p>æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹ç¡¬ä»¶ç›¸å…³çš„åŸºç¡€çŸ¥è¯†ã€‚</p>
</div>
<div class="sect3">
<h4 id="_å­˜å‚¨é‡‘å­—å¡”">2.1.1. å­˜å‚¨é‡‘å­—å¡”</h4>
<div class="paragraph">
<p>è®¡ç®—æœºä¸­æœ€é‡è¦çš„å­˜å‚¨ä»‹è´¨åˆ†ä¸ºå‡ ç±»ï¼šç¡¬ç›˜ã€å†…å­˜ã€äºŒçº§ç¼“å­˜ã€å¯„å­˜å™¨ã€‚å®ƒä»¬ä¹‹é—´çš„å¯¹æ¯”å¦‚ä¸‹ï¼š</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/memory_hierarchy.jpg" alt="å­˜å‚¨é‡‘å­—å¡”" width="95%">
</div>
<div class="title">å›¾ 1. å­˜å‚¨é‡‘å­—å¡”</div>
</div>
<div class="paragraph">
<p>ä»ä¸Šé¢çš„å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œ<strong>ä»ä¸‹å¾€ä¸Šï¼Œé€Ÿåº¦ä»æ…¢åˆ°å¿«ï¼Œåˆ¶é€ æˆæœ¬ä¹Ÿè¶Šæ¥è¶Šé«˜ã€‚</strong>å‡ ç§æœ‰ä»£è¡¨æ€§çš„å­˜å‚¨è®¾å¤‡çš„å…¸å‹è®¿é—®é€Ÿåº¦å¦‚ä¸‹ï¼š</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/memory_access_time.png" alt="å­˜å‚¨è®¿é—®æ—¶é—´" width="95%">
</div>
<div class="title">å›¾ 2. å­˜å‚¨è®¿é—®æ—¶é—´</div>
</div>
<div class="paragraph">
<p>ä»è¿™ä¸ªå›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹å‡ºï¼š<strong>é«˜é€Ÿç¼“å­˜çš„è®¿é—®é€Ÿåº¦æ˜¯ä¸»å­˜çš„ 10~100 å€ï¼Œè€Œä¸»å­˜çš„è®¿é—®é€Ÿåº¦åˆ™æ˜¯ç¡¬ç›˜çš„ 1ï½10W å€ã€‚</strong></p>
</div>
<div class="paragraph">
<p>å¤§æ¦‚å°±æ˜¯èµ°è·¯å’Œåé£æœºçš„å·®åˆ«äº†ã€‚è™½ç„¶åé£æœºæ˜¯é£ä¸€æ ·çš„æ„Ÿè§‰ï¼Œä½†æ˜¯èµ°è·¯è¿˜æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„ç§»åŠ¨æ–¹å¼ã€‚æ•°æ®å­˜å‚¨ä¹Ÿä¸€æ ·ï¼Œå¯¹äºä¸€å°ç‹¬ç«‹çš„è®¡ç®—æœºï¼Œæ•°æ®æœ€åè¿˜æ˜¯è¦è½åœ°åˆ°ç£ç›˜ä¸Šã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æœºæ¢°ç¡¬ç›˜çš„ç»“æ„ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_æœºæ¢°ç¡¬ç›˜ç»“æ„">2.1.2. æœºæ¢°ç¡¬ç›˜ç»“æ„</h4>
<div class="paragraph">
<p>æœºæ¢°ç¡¬ç›˜ä¸­çš„å¤§è‡´ç»“æ„å¦‚ä¸‹å›¾ï¼Œç±»ä¼¼å¾ˆå¤šç”µå½±å’Œç”µè§†å‰§ä¸­çš„ç•™å£°æœºï¼š</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/magnetic_disk_storage_1.jpg" alt="æœºæ¢°ç¡¬ç›˜å•ä¸ªç›˜é¢ç»“æ„è½®å»“å›¾" width="95%">
</div>
<div class="title">å›¾ 3. æœºæ¢°ç¡¬ç›˜å•ä¸ªç›˜é¢ç»“æ„è½®å»“å›¾</div>
</div>
<div class="paragraph">
<p>æœºæ¢°ç¡¬ç›˜ä¸­ï¼Œæ¯ä¸€ä¸ªç£ç›˜ç›˜é¢çš„ç»„æˆç»“æ„å¦‚ä¸‹ï¼š</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/magnetic_disk_storage.jpg" alt="ç£ç›˜ä¸Šçš„ç£é“ã€æ‰‡åŒºå’Œç°‡" width="95%">
</div>
<div class="title">å›¾ 4. ç£ç›˜ä¸Šçš„ç£é“ã€æ‰‡åŒºå’Œç°‡</div>
</div>
<div class="paragraph">
<p>è‹±æ–‡åè¯è§£é‡Šï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Spindle Motor ä¸»è½´é©¬è¾¾</p>
</li>
<li>
<p>Permanent Magnent æ°¸ä¹…ç£é“</p>
</li>
<li>
<p>Voice Coil éŸ³åœˆ</p>
</li>
<li>
<p>Head ç£å¤´</p>
</li>
<li>
<p>Spinning Hard Disk æ—‹è½¬çš„ç¡¬ç›˜</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>æ¯ä¸ªæœºæ¢°ç£ç›˜éƒ½æœ‰å¾ˆå¤šä¸ªç›˜é¢ç»„æˆã€‚æ•´ä¸ªæœºæ¢°ç£ç›˜çš„ç»„æˆç»“æ„å¦‚ä¸‹ï¼š</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/disk_mechanism.jpg" alt="ç£ç›˜å†…éƒ¨ç»“æ„" width="95%">
</div>
<div class="title">å›¾ 5. ç£ç›˜å†…éƒ¨ç»“æ„</div>
</div>
<div class="paragraph">
<p>å•è¯è§£é‡Šï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>spindle è½¬è½´ï¼Œä¸»è½´</p>
</li>
<li>
<p>track ç£é“</p>
</li>
<li>
<p>sector æ‰‡åŒº</p>
</li>
<li>
<p>cylinder ç£æŸ±</p>
</li>
<li>
<p>platter ç£ç›˜</p>
</li>
<li>
<p>head ç£å¤´</p>
</li>
<li>
<p>arm ç£è‡‚</p>
</li>
<li>
<p>æœºæ¢°è‡‚ç»„ä»¶</p>
</li>
</ul>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">å¯»é“æ—¶é—´</dt>
<dd>
<p>T-seek æ˜¯æŒ‡å°†è¯»å†™ç£å¤´ç§»åŠ¨è‡³æ­£ç¡®çš„ç£é“ä¸Šæ‰€éœ€è¦çš„æ—¶é—´ã€‚å¯»é“æ—¶é—´è¶ŠçŸ­ï¼ŒI/Oæ“ä½œè¶Šå¿«ï¼Œç›®å‰ç£ç›˜çš„å¹³å‡å¯»é“æ—¶é—´ä¸€èˆ¬åœ¨ 3ï¼15msã€‚</p>
</dd>
<dt class="hdlist1">æ—‹è½¬å»¶è¿Ÿ</dt>
<dd>
<p>T-rotation æ˜¯æŒ‡ç›˜ç‰‡æ—‹è½¬å°†è¯·æ±‚æ•°æ®æ‰€åœ¨æ‰‡åŒºç§»è‡³è¯»å†™ç£å¤´ä¸‹æ–¹æ‰€éœ€è¦çš„æ—¶é—´ã€‚æ—‹è½¬å»¶è¿Ÿå–å†³äºç£ç›˜è½¬é€Ÿï¼Œé€šå¸¸ä½¿ç”¨ç£ç›˜æ—‹è½¬ä¸€å‘¨æ‰€éœ€æ—¶é—´çš„ 1/2 è¡¨ç¤ºã€‚æ¯”å¦‚ï¼Œ7200 rpm çš„ç£ç›˜å¹³å‡æ—‹è½¬å»¶è¿Ÿå¤§çº¦ä¸º 60 * 1000 / 7200 / 2 = 4.17msï¼Œè€Œè½¬é€Ÿä¸º 15000 rpm çš„ç£ç›˜å…¶å¹³å‡æ—‹è½¬å»¶è¿Ÿä¸º 2msã€‚</p>
</dd>
<dt class="hdlist1">æ•°æ®ä¼ è¾“æ—¶é—´</dt>
<dd>
<p>T-transfer æ˜¯æŒ‡å®Œæˆä¼ è¾“æ‰€è¯·æ±‚çš„æ•°æ®æ‰€éœ€è¦çš„æ—¶é—´ï¼Œå®ƒå–å†³äºæ•°æ®ä¼ è¾“ç‡ï¼Œå…¶å€¼ç­‰äºæ•°æ®å¤§å°é™¤ä»¥æ•°æ®ä¼ è¾“ç‡ã€‚ç›®å‰ IDE/ATA èƒ½è¾¾åˆ° 133MB/sï¼ŒSATA II å¯è¾¾åˆ° 300MB/s çš„æ¥å£æ•°æ®ä¼ è¾“ç‡ï¼Œæ•°æ®ä¼ è¾“æ—¶é—´é€šå¸¸è¿œå°äºå‰ä¸¤éƒ¨åˆ†æ¶ˆè€—æ—¶é—´ã€‚ç®€å•è®¡ç®—æ—¶å¯å¿½ç•¥ã€‚</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>å¸¸è§ç£ç›˜å¹³å‡ç‰©ç†å¯»é“æ—¶é—´ä¸ºï¼š</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>7200  è½¬/åˆ†çš„ STAT ç¡¬ç›˜å¹³å‡ç‰©ç†å¯»é“æ—¶é—´æ˜¯ 9ms</p>
</li>
<li>
<p>10000 è½¬/åˆ†çš„ STAT ç¡¬ç›˜å¹³å‡ç‰©ç†å¯»é“æ—¶é—´æ˜¯ 6ms</p>
</li>
<li>
<p>15000 è½¬/åˆ†çš„ STAT ç¡¬ç›˜å¹³å‡ç‰©ç†å¯»é“æ—¶é—´æ˜¯ 4ms</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>å¸¸è§ç¡¬ç›˜çš„æ—‹è½¬å»¶è¿Ÿæ—¶é—´ä¸ºï¼š</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>7200  rpmçš„ç£ç›˜å¹³å‡æ—‹è½¬å»¶è¿Ÿå¤§çº¦ä¸º 60*1000/7200/2  = 4.17ms</p>
</li>
<li>
<p>10000 rpmçš„ç£ç›˜å¹³å‡æ—‹è½¬å»¶è¿Ÿå¤§çº¦ä¸º 60*1000/10000/2 = 3msï¼Œ</p>
</li>
<li>
<p>15000 rpmçš„ç£ç›˜å…¶å¹³å‡æ—‹è½¬å»¶è¿Ÿçº¦ä¸º 60*1000/15000/2 = 2msã€‚</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>äº†è§£ç£ç›˜è¯»å–æ•°æ®çš„åŸç†ä»¥å„ç§å»¶è¿Ÿåï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹é¡ºåºè¯»å–å’Œéšæœºè¯»å–çš„å·®åˆ«ï¼š</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/disk_access.png" alt="é¡ºåºè¯»å–å’Œéšæœºè¯»å–" width="95%">
</div>
<div class="title">å›¾ 6. é¡ºåºè¯»å–å’Œéšæœºè¯»å–</div>
</div>
<div class="paragraph">
<p>å› ä¸ºæœºæ¢°ç¡¬ç›˜çš„ç£å¤´ç§»åŠ¨è‡³æ­£ç¡®çš„ç£é“ä¸Šéœ€è¦æ—¶é—´ï¼Œéšæœºè¯»å†™æ—¶ï¼Œç£å¤´ä¸åœçš„ç§»åŠ¨ï¼Œæ—¶é—´éƒ½èŠ±åœ¨äº†ç£å¤´å¯»é“ä¸Šï¼Œå¯¼è‡´çš„å°±æ˜¯æ€§èƒ½ä¸é«˜ã€‚æ‰€ä»¥ï¼Œå¯¹äºæœºæ¢°ç¡¬ç›˜æ¥è¯´ï¼Œè¿ç»­è¯»å†™æ€§å¾ˆå¥½ï¼Œä½†éšæœºè¯»å†™æ€§èƒ½å¾ˆå·®ã€‚å…·ä½“å¯¹æ¯”å¦‚ä¸‹ï¼š</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/compare_random_and_sequential_access_in_disk_and_memory.jpg" alt="å¯¹æ¯”åœ¨ç¡¬ç›˜å’Œå†…å­˜ä¸Šçš„éšæœºè¯»å–å’Œé¡ºåºè¯»å–" width="95%">
</div>
<div class="title">å›¾ 7. å¯¹æ¯”åœ¨ç¡¬ç›˜å’Œå†…å­˜ä¸Šçš„éšæœºè¯»å–å’Œé¡ºåºè¯»å–</div>
</div>
</div>
<div class="sect3">
<h4 id="_å±€éƒ¨æ€§åŸç†ä¸ç£ç›˜é¢„è¯»">2.1.3. å±€éƒ¨æ€§åŸç†ä¸ç£ç›˜é¢„è¯»</h4>
<div class="paragraph">
<p>ç”±äºå­˜å‚¨ä»‹è´¨çš„ç‰¹æ€§ï¼Œç¡¬ç›˜æœ¬èº«å­˜å–å°±æ¯”ä¸»å­˜æ…¢å¾ˆå¤šï¼Œå†åŠ ä¸Šæœºæ¢°è¿åŠ¨è€—è´¹ï¼Œç¡¬ç›˜çš„å­˜å–é€Ÿåº¦å¾€å¾€æ˜¯ä¸»å­˜çš„å‡ ç™¾åˆ†åˆ†ä¹‹ä¸€ï¼Œå› æ­¤ä¸ºäº†æé«˜æ•ˆç‡ï¼Œè¦å°½é‡å‡å°‘ç£ç›˜ I/Oã€‚ç”±äºç£ç›˜é¡ºåºè¯»å–çš„æ•ˆç‡å¾ˆé«˜ï¼ˆä¸éœ€è¦å¯»é“æ—¶é—´ï¼Œåªéœ€å¾ˆå°‘çš„æ—‹è½¬æ—¶é—´ï¼‰ï¼Œå› æ­¤å¯¹äºå…·æœ‰å±€éƒ¨æ€§çš„ç¨‹åºæ¥è¯´ï¼Œé¢„è¯»å¯ä»¥æé«˜ I/O æ•ˆç‡ã€‚ç£ç›˜å¾€å¾€ä¹Ÿä¸æ˜¯ä¸¥æ ¼æŒ‰éœ€è¯»å–ï¼Œè€Œæ˜¯æ¯æ¬¡éƒ½ä¼šé¢„è¯»ï¼Œå³ä½¿åªéœ€è¦ä¸€ä¸ªå­—èŠ‚ï¼Œç£ç›˜ä¹Ÿä¼šä»è¿™ä¸ªä½ç½®å¼€å§‹ï¼Œé¡ºåºå‘åè¯»å–ä¸€å®šé•¿åº¦çš„æ•°æ®æ”¾å…¥å†…å­˜ã€‚è¿™æ ·åšçš„ç†è®ºä¾æ®æ˜¯è®¡ç®—æœºç§‘å­¦ä¸­è‘—åçš„å±€éƒ¨æ€§åŸç†ï¼š</p>
</div>
<div class="paragraph">
<p><strong>å½“ä¸€ä¸ªæ•°æ®è¢«ç”¨åˆ°æ—¶ï¼Œå…¶é™„è¿‘çš„æ•°æ®ä¹Ÿé€šå¸¸ä¼šé©¬ä¸Šè¢«ä½¿ç”¨ã€‚</strong></p>
</div>
<div class="paragraph">
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬äº†è§£ä¸€ä¸‹ç®—æ³•ç›¸å…³çš„èƒŒæ™¯çŸ¥è¯†ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_æ—¶é—´å¤æ‚åº¦">2.1.4. æ—¶é—´å¤æ‚åº¦</h4>
<div class="paragraph">
<p>æ—¶é—´å¤æ‚åº¦ç”¨æ¥æ£€éªŒæŸä¸ªç®—æ³•å¤„ç†ä¸€å®šé‡çš„æ•°æ®è¦èŠ±å¤šé•¿æ—¶é—´ã€‚</p>
</div>
<div class="paragraph">
<p>é‡è¦çš„ä¸æ˜¯æ•°æ®é‡ï¼Œè€Œæ˜¯å½“æ•°æ®é‡å¢åŠ æ—¶è¿ç®—å¦‚ä½•å¢åŠ ã€‚</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/number_operations_of_data.jpg" alt="æ—¶é—´å¤æ‚åº¦å˜åŒ–" width="95%">
</div>
<div class="title">å›¾ 8. æ—¶é—´å¤æ‚åº¦å˜åŒ–</div>
</div>
<div class="ulist">
<ul>
<li>
<p>ç»¿ï¼šO(1)</p>
</li>
<li>
<p>è“ï¼šO(n)</p>
</li>
<li>
<p>çº¢ï¼šO(log(n)) å³ä½¿åœ¨åäº¿çº§æ•°é‡æ—¶ä¹Ÿå¾ˆä½</p>
</li>
<li>
<p>ç²‰ï¼šO(n<sup>2</sup>) å¿«é€Ÿè†¨èƒ€</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>æ•°æ®é‡ä½æ—¶ï¼ŒO(1) å’Œ O(n<sup>2</sup>)çš„åŒºåˆ«å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚æ¯”å¦‚ï¼Œä½ æœ‰ä¸ªç®—æ³•è¦å¤„ç†2000æ¡å…ƒç´ ã€‚</p>
</div>
<div class="ulist">
<ul>
<li>
<p>O(1) ç®—æ³•ä¼šæ¶ˆè€— 1 æ¬¡è¿ç®—</p>
</li>
<li>
<p>O(log(n)) ç®—æ³•ä¼šæ¶ˆè€— 7 æ¬¡è¿ç®—</p>
</li>
<li>
<p>O(n) ç®—æ³•ä¼šæ¶ˆè€— 2000 æ¬¡è¿ç®—</p>
</li>
<li>
<p>O(n*log(n)) ç®—æ³•ä¼šæ¶ˆè€— 14,000 æ¬¡è¿ç®—</p>
</li>
<li>
<p>O(n<sup>2</sup>) ç®—æ³•ä¼šæ¶ˆè€— 4,000,000 æ¬¡è¿ç®—</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>å¤„ç† 1,000,000 æ¡å…ƒç´ ï¼ˆè¿™å¯¹æ•°æ®åº“æ¥è¯´ä¹Ÿä¸ç®—å¤§ï¼‰ã€‚</p>
</div>
<div class="ulist">
<ul>
<li>
<p>O(1) ç®—æ³•ä¼šæ¶ˆè€— 1 æ¬¡è¿ç®—</p>
</li>
<li>
<p>O(log(n)) ç®—æ³•ä¼šæ¶ˆè€— 14 æ¬¡è¿ç®—</p>
</li>
<li>
<p>O(n) ç®—æ³•ä¼šæ¶ˆè€— 1,000,000 æ¬¡è¿ç®—</p>
</li>
<li>
<p>O(n*log(n)) ç®—æ³•ä¼šæ¶ˆè€— 14,000,000 æ¬¡è¿ç®—</p>
</li>
<li>
<p>O(n<sup>2</sup>) ç®—æ³•ä¼šæ¶ˆè€— 1,000,000,000,000 æ¬¡è¿ç®—</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>è¿™é‡Œå¯ä»¥æ˜ç™½ï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>æœç´¢ä¸€ä¸ªå¥½çš„å“ˆå¸Œè¡¨ä¼šå¾—åˆ° O(1) å¤æ‚åº¦</p>
</li>
<li>
<p>æœç´¢ä¸€ä¸ªå‡è¡¡çš„æ ‘ä¼šå¾—åˆ° O(log(n)) å¤æ‚åº¦</p>
</li>
<li>
<p>æœç´¢ä¸€ä¸ªé˜µåˆ—ä¼šå¾—åˆ° O(n) å¤æ‚åº¦</p>
</li>
<li>
<p>æœ€å¥½çš„æ’åºç®—æ³•å…·æœ‰ O(n*log(n)) å¤æ‚åº¦</p>
</li>
<li>
<p>ç³Ÿç³•çš„æ’åºç®—æ³•å…·æœ‰ O(n<sup>2</sup>) å¤æ‚åº¦</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_å½’å¹¶æ’åº">2.1.5. å½’å¹¶æ’åº</h4>
<div class="paragraph">
<p>åˆå¹¶æ’åºåŸºäºè¿™æ ·ä¸€ä¸ªæŠ€å·§ï¼šå°† 2 ä¸ªå¤§å°ä¸º N/2 çš„å·²æ’åºåºåˆ—åˆå¹¶ä¸ºä¸€ä¸ª N å…ƒç´ å·²æ’åºåºåˆ—ä»…éœ€è¦ N æ¬¡æ“ä½œã€‚è¿™ä¸ªæ–¹æ³•å«åšåˆå¹¶ã€‚</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/merge_sort.gif" alt="å½’å¹¶æ’åº" width="95%">
</div>
<div class="title">å›¾ 9. å½’å¹¶æ’åº</div>
</div>
<div class="paragraph">
<p>è¿™ä¸ªç®—æ³•æœ‰ä¸¤ç‚¹ç‰¹åˆ«æ£’çš„ä¼˜åŠ¿ï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>å¯ä»¥æ›´æ”¹ç®—æ³•ï¼Œä»¥ä¾¿äºåŒæ—¶ä½¿ç”¨ç£ç›˜ç©ºé—´å’Œå°‘é‡å†…å­˜è€Œé¿å…å·¨é‡ç£ç›˜ I/Oã€‚æ–¹æ³•æ˜¯åªå‘å†…å­˜ä¸­åŠ è½½å½“å‰å¤„ç†çš„éƒ¨åˆ†ã€‚åœ¨ä»…ä»…100MBçš„å†…å­˜ç¼“å†²åŒºå†…æ’åºä¸€ä¸ªå‡ ä¸ªGBçš„è¡¨æ—¶ï¼Œè¿™æ˜¯ä¸ªå¾ˆé‡è¦çš„æŠ€å·§ã€‚</p>
</li>
<li>
<p>å¯ä»¥æ›´æ”¹ç®—æ³•ï¼Œä»¥ä¾¿äºåœ¨å¤šå¤„ç†å™¨/å¤šçº¿ç¨‹/å¤šæœåŠ¡å™¨ä¸Šè¿è¡Œã€‚ åˆ†å¸ƒå¼å½’å¹¶æ’åºæ—¶ Hadoop çš„å…³é”®ç»„ä»¶ä¹‹ä¸€ã€‚</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_äºŒåˆ†æŸ¥æ‰¾">2.1.6. äºŒåˆ†æŸ¥æ‰¾</h4>
<div class="imageblock">
<div class="content">
<img src="images/binary_search_23.gif" alt="äºŒåˆ†æŸ¥æ‰¾" width="95%">
</div>
<div class="title">å›¾ 10. äºŒåˆ†æŸ¥æ‰¾-æœ€å¥½æƒ…å†µ</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/binary_search.gif" alt="äºŒåˆ†æŸ¥æ‰¾" width="95%">
</div>
<div class="title">å›¾ 11. äºŒåˆ†æŸ¥æ‰¾-æœ€åçš„æƒ…å†µ</div>
</div>
<div class="paragraph">
<p>äºŒå‰æ ‘éœ€è¦è®²æ•°ç»„å…¨éƒ¨åŠ è½½åˆ°å†…å­˜ä¸­ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ•°æ®é‡ç‰¹åˆ«å¤§ï¼ŒåŠ è½½ä¸å®Œï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿèƒ½å¦åªåŠ è½½ä¸€éƒ¨åˆ†æ•°æ®å‘¢ï¼Ÿ</p>
</div>
</div>
<div class="sect3">
<h4 id="_æ ‘">2.1.7. æ ‘</h4>
<div class="paragraph">
<p>æ ‘ï¼Œè¿™ç§æ•°æ®ç»“æ„å°±èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥åªæŠŠæ ‘çš„ä¸Šé¢å‡ çº§ä¿å­˜åˆ°å†…å­˜ä¸­ï¼Œæ–¹ä¾¿æ“ä½œã€‚å¦‚ä¸‹å›¾ï¼š</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/big_tree.png" alt="æ ‘" width="65%">
</div>
<div class="title">å›¾ 12. æ ‘</div>
</div>
<div class="paragraph">
<p>æ ‘çš„èŠ‚ç‚¹ä¹Ÿå¯ä»¥ä¿æŒæœ‰åºçŠ¶æ€ï¼š</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/big_search_tree.jpeg" alt="æœç´¢æ ‘" width="75%">
</div>
<div class="title">å›¾ 13. æœç´¢æ ‘</div>
</div>
<div class="paragraph">
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æœ€ç®€å•çš„æ ‘ç»“æ„ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_äºŒå‰æŸ¥æ‰¾æ ‘">2.1.8. äºŒå‰æŸ¥æ‰¾æ ‘</h4>
<div class="paragraph">
<p>åœ¨äºŒå‰æŸ¥æ‰¾æ ‘å’Œåœ¨æœ‰åºæ•°ç»„ä¸­æŸ¥æ‰¾æŸä¸€ä¸ªæŒ‡å®šå…ƒç´ çš„å¯¹æ¯”å¦‚ä¸‹ï¼š</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/binaray_search_tree.gif" alt="äºŒå‰æŸ¥æ‰¾æ ‘" width="95%">
</div>
<div class="title">å›¾ 14. äºŒå‰æŸ¥æ‰¾æ ‘</div>
</div>
<div class="paragraph">
<p>äºŒå‰æŸ¥æ‰¾æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹è¦ä¿è¯ä¸¤ç‚¹ï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>æ¯”ä¿å­˜åœ¨å·¦å­æ ‘çš„ä»»ä½•é”®å€¼éƒ½è¦å¤§</p>
</li>
<li>
<p>æ¯”ä¿å­˜åœ¨å³å­æ ‘çš„ä»»ä½•é”®å€¼éƒ½è¦å°</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>è¿™ä¸ªæŸ¥è¯¢çš„æˆæœ¬æ˜¯ log<sub>2</sub>(n)ã€‚</p>
</div>
<div class="paragraph">
<p><a href="http://www.cs.usfca.edu/~galles/visualization/BST.html">äºŒå‰æŸ¥æ‰¾æ ‘åœ¨çº¿æ¼”ç¤º</a></p>
</div>
<div class="paragraph">
<p>ä¸Šé¢çš„æ˜¯ç†æƒ³çŠ¶å†µä¸‹çš„æƒ…å†µã€‚ä½†åœ¨æç«¯æƒ…å†µä¸‹ï¼ŒäºŒå‰æŸ¥æ‰¾æ ‘çš„æŸ¥è¯¢æˆæœ¬æœ‰å¯èƒ½æ˜¯ nã€‚ä¾‹å¦‚ï¼š</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/skewedTree.png" alt="æœ€åæƒ…å†µä¸‹çš„äºŒå‰æŸ¥æ‰¾æ ‘" width="65%">
</div>
<div class="title">å›¾ 15. æœ€åæƒ…å†µä¸‹çš„äºŒå‰æŸ¥æ‰¾æ ‘</div>
</div>
<div class="paragraph">
<p>æœ‰æ²¡æœ‰ä¸€ç§æ•°æ®ç»“æ„ï¼Œèƒ½é¿å…è¿™ç§æƒ…å†µå‡ºç°å‘¢ï¼Ÿ</p>
</div>
</div>
<div class="sect3">
<h4 id="_å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘">2.1.9. å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘</h4>
<div class="imageblock">
<div class="content">
<img src="images/array_to_bst.png" alt="äºŒå‰æœç´¢æ ‘å¯¹æ¯”" width="95%">
</div>
<div class="title">å›¾ 16. äºŒå‰æœç´¢æ ‘å¯¹æ¯”</div>
</div>
<div class="paragraph">
<p>å¹³è¡¡äºŒå‰æœç´¢æ ‘åœ¨æ·»åŠ å…ƒç´ æ—¶ï¼Œé€šè¿‡æ—‹è½¬æ¥ä¿è¯è‡ªèº«çš„å¹³è¡¡æ€§ã€‚</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/tree_balance.png" alt="å¹³è¡¡äºŒå‰æœç´¢æ ‘æ—‹è½¬" width="95%">
</div>
<div class="title">å›¾ 17. å¹³è¡¡äºŒå‰æœç´¢æ ‘æ—‹è½¬</div>
</div>
<div class="paragraph">
<p>ä¸ä»…èƒ½å·¦æ—‹ï¼Œè¿˜å¯ä»¥å³æ—‹ã€‚å·¦å³æ—‹è½¬ç¤ºæ„å›¾ï¼š</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/search_tree_rotation.png" alt="äºŒå‰æœç´¢æ ‘æ—‹è½¬" width="95%">
</div>
<div class="title">å›¾ 18. äºŒå‰æœç´¢æ ‘æ—‹è½¬</div>
</div>
<div class="paragraph">
<p>å¯¹äºæŸ¥æ‰¾ä¸€ä¸ªç‰¹å®šå€¼è¿™ç§æ ‘æŒºå¥½ç”¨ã€‚è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœæŸ¥æ‰¾ä¸€ä¸ªèŒƒå›´å†…çš„å€¼å‘¢ï¼Ÿæ¯”å¦‚å¹´é¾„å¤§äº 16ï¼Œå°äº 29 çš„ç¾å¥³å‘¢ï¼Ÿè¿™ä¸ªè¿˜å¯ä»¥æšä¸¾ã€‚å¦‚æœæˆ‘è¦æŸ¥æ‰¾èº«é«˜å¤§äº 170cm çš„ç¾å¥³ï¼Œæ€ä¹ˆæï¼Ÿ</p>
</div>
</div>
<div class="sect3">
<h4 id="_b_tree">2.1.10. B+Tree</h4>
<div class="paragraph">
<p>ä¸ºäº†è§£å†³é«˜æ•ˆæŸ¥æ‰¾æŸä¸€ä¸ªèŒƒå›´å†…çš„å…ƒç´ çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªä¿®è®¢åçš„æ ‘ï¼šB+æ ‘ã€‚è¿™ä¹Ÿæ˜¯ç›®å‰å¤§éƒ¨åˆ†ç°ä»£æ•°æ®åº“ç´¢å¼•ä½¿ç”¨çš„æ•°æ®ç»“æ„ã€‚åœ¨ä¸€ä¸ªB+æ ‘é‡Œï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>åªæœ‰æœ€åº•å±‚çš„èŠ‚ç‚¹ï¼ˆå¶å­èŠ‚ç‚¹ï¼‰æ‰ä¿å­˜ä¿¡æ¯ï¼ˆç›¸å…³è¡¨çš„è¡Œä½ç½®ï¼‰</p>
</li>
<li>
<p>å…¶å®ƒèŠ‚ç‚¹åªæ˜¯åœ¨æœç´¢ä¸­ç”¨æ¥æŒ‡å¼•åˆ°æ­£ç¡®èŠ‚ç‚¹çš„ã€‚</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/binaray_plus_tree.png" alt="B+Tree ç´¢å¼•ç»“æ„" width="95%">
</div>
<div class="title">å›¾ 19. B+Tree ç´¢å¼•ç»“æ„</div>
</div>
<div class="paragraph">
<p>æ‰¾åˆ°äº† M ä¸ªåç»­èŠ‚ç‚¹ï¼Œæ ‘æ€»å…±æœ‰ N ä¸ªèŠ‚ç‚¹ã€‚å¯¹æŒ‡å®šèŠ‚ç‚¹çš„æœç´¢æˆæœ¬æ˜¯ log(N)ï¼Œè·Ÿä¸Šä¸€ä¸ªæ ‘ç›¸åŒã€‚ä½†æ˜¯å½“ä½ æ‰¾åˆ°è¿™ä¸ªèŠ‚ç‚¹ï¼Œä½ å¾—é€šè¿‡åç»­èŠ‚ç‚¹çš„è¿æ¥å¾—åˆ° M ä¸ªåç»­èŠ‚ç‚¹ï¼Œè¿™éœ€è¦ M æ¬¡è¿ç®—ã€‚é‚£ä¹ˆè¿™æ¬¡æœç´¢åªæ¶ˆè€—äº† M+log(N) æ¬¡è¿ç®—ï¼ŒåŒºåˆ«äºä¸Šä¸€ä¸ªæ ‘æ‰€ç”¨çš„ N æ¬¡è¿ç®—ã€‚</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
B+æ ‘ç§çš„ B ä¸æ˜¯ä»£è¡¨äºŒå‰ï¼ˆbinaryï¼‰ï¼Œè€Œæ˜¯ä»£è¡¨å¹³è¡¡ï¼ˆbalanceï¼‰ï¼Œå› ä¸º B+æ ‘æ˜¯ä»æœ€æ—©çš„å¹³è¡¡äºŒå‰æ ‘æ¼”åŒ–è€Œæ¥ï¼Œä½†æ˜¯ B+æ ‘ä¸æ˜¯ä¸€ä¸ªäºŒå‰æ ‘ã€‚
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_å“ˆå¸Œè¡¨">2.1.11. å“ˆå¸Œè¡¨</h4>
<div class="paragraph">
<p>ä¸ºäº†æ„å»ºä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œä½ éœ€è¦å®šä¹‰ï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>å…ƒç´ çš„å…³é”®å­—</p>
</li>
<li>
<p>å…³é”®å­—çš„å“ˆå¸Œå‡½æ•°ã€‚å…³é”®å­—è®¡ç®—å‡ºæ¥çš„å“ˆå¸Œå€¼ç»™å‡ºäº†å…ƒç´ çš„ä½ç½®ï¼ˆå«åšå“ˆå¸Œæ¡¶ï¼‰ã€‚</p>
</li>
<li>
<p>å…³é”®å­—æ¯”è¾ƒå‡½æ•°ã€‚ä¸€æ—¦ä½ æ‰¾åˆ°æ­£ç¡®çš„å“ˆå¸Œæ¡¶ï¼Œä½ å¿…é¡»ç”¨æ¯”è¾ƒå‡½æ•°åœ¨æ¡¶å†…æ‰¾åˆ°ä½ è¦çš„å…ƒç´ ã€‚</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/hash_table.jpg" alt="å“ˆå¸Œè¡¨" width="95%">
</div>
<div class="title">å›¾ 20. å“ˆå¸Œè¡¨</div>
</div>
<div class="paragraph">
<p><strong>çœŸæ­£çš„æŒ‘æˆ˜æ˜¯æ‰¾åˆ°å¥½çš„å“ˆå¸Œå‡½æ•°ï¼Œè®©å“ˆå¸Œæ¡¶é‡ŒåŒ…å«éå¸¸å°‘çš„å…ƒç´ ã€‚å¦‚æœæœ‰äº†å¥½çš„å“ˆå¸Œå‡½æ•°ï¼Œåœ¨å“ˆå¸Œè¡¨é‡Œæœç´¢çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(1)ã€‚</strong></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_innodb_é€»è¾‘å­˜å‚¨ç»“æ„">2.2. InnoDB é€»è¾‘å­˜å‚¨ç»“æ„ã€‚</h3>
<div class="paragraph">
<p>æ‰€æœ‰æ•°æ®éƒ½è¢«é€»è¾‘åœ°å­˜æ”¾åœ¨ä¸€ä¸ªç©ºé—´ä¸­ï¼Œç§°ä¸ºè¡¨ç©ºé—´ï¼ˆtablespaceï¼‰ã€‚è¡¨ç©ºé—´ç”±æ®µï¼ˆsegmentï¼‰ã€åŒºï¼ˆextentï¼‰ã€é¡µï¼ˆpageï¼‰ç»„æˆã€‚é¡µåœ¨ä¸€äº›æ–‡æ¡£ä¸­æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºå—ï¼ˆblockï¼‰ã€‚å¤§è‡´ç»“æ„å¦‚ä¸‹ï¼š</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/InnoDB_logical_storage_structure.png" alt="InnoDB é€»è¾‘å­˜å‚¨ç»“æ„" width="95%">
</div>
<div class="title">å›¾ 21. InnoDB é€»è¾‘å­˜å‚¨ç»“æ„</div>
</div>
<div class="sect3">
<h4 id="_è¡Œ">2.2.1. è¡Œ</h4>
<div class="paragraph">
<p>InnoDB å­˜å‚¨å¼•æ“æ˜¯é¢å‘åˆ—çš„ï¼ˆrow-orientedï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´æ•°æ®æ˜¯æŒ‰è¡Œè¿›è¡Œå­˜æ”¾çš„ã€‚æ¯ä¸ªé¡µå­˜æ”¾çš„è¡Œè®°å½•æ˜¯æœ‰ç¡¬æ€§å®šä¹‰çš„ï¼Œæœ€å¤šå…è®¸å­˜æ”¾ 16KB / 2-200 è¡Œçš„è®°å½•ï¼Œå³ 7992 è¡Œè®°å½•ã€‚</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ç´¢å¼•åŸºç¡€">2.3. ç´¢å¼•åŸºç¡€</h3>
<div class="paragraph">
<p>ç´¢å¼•ç±»ä¼¼ä¹¦ç±ç›®å½•ã€‚</p>
</div>
<div class="paragraph">
<p>åœ¨MySQL ä¸­ï¼Œç´¢å¼•æ˜¯åœ¨å­˜å‚¨å¼•æ“å±‚è€Œä¸æ˜¯æœåŠ¡å™¨å±‚å®ç°çš„ã€‚</p>
</div>
<div class="sect3">
<h4 id="_ç´¢å¼•ç±»å‹">2.3.1. ç´¢å¼•ç±»å‹</h4>
<div class="sect4">
<h5 id="_b_tree_ç´¢å¼•">2.3.1.1. B-Tree ç´¢å¼•</h5>
<div class="paragraph">
<p>å¤§éƒ¨åˆ† MySQL å¼•æ“éƒ½æ”¯æŒ B-Tree ç´¢å¼•ã€‚</p>
</div>
<div class="paragraph">
<p>NDB é›†ç¾¤å­˜å‚¨å¼•æ“å†…éƒ¨å®é™…ä½¿ç”¨äº† T-Tree ç»“æ„ï¼› InnoDB åˆ™ä½¿ç”¨çš„æ˜¯ B+Treeã€‚</p>
</div>
<div class="paragraph">
<p>MyISAM ä½¿ç”¨å‰ç¼€å‹ç¼©æŠ€æœ¯æ˜¯ç´¢å¼•æ›´å°ï¼›</p>
</div>
<div class="paragraph">
<p>MyISAM ç´¢å¼•é€šè¿‡æ•°æ®çš„ç‰©ç†ä½ç½®å¼•ç”¨è¢«ç´¢å¼•çš„è¡Œï¼Œè€Œ InnoDB åˆ™æ ¹æ®é€æ¸å¼•ç”¨è¢«ç´¢å¼•çš„è¡Œã€‚</p>
</div>
<div class="paragraph">
<p>B-Tree é€šå¸¸ä»¥ä¸ºè¿™æ‰€æœ‰çš„å€¼éƒ½æ˜¯æŒ‰é¡ºåºå­˜å‚¨çš„ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªå¶å­é¡µåˆ°æ ¹çš„è·ç¦»ç›¸åŒã€‚å¦‚ä¸‹å›¾ï¼š</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-Tree_index.png" alt="B-Tree ç´¢å¼•ç»“æ„" width="95%">
</div>
<div class="title">å›¾ 22. B-Tree ç´¢å¼•ç»“æ„</div>
</div>
<div class="paragraph">
<p>B-Tree ç´¢å¼•èƒ½å¤ŸåŠ å¿«è®¿é—®æ•°æ®çš„é€Ÿåº¦ï¼Œå› ä¸ºå­˜å‚¨å¼•æ“ä¸å†éœ€è¦è¿›è¡Œå…¨è¡¨æ‰«ææ¥è·å–éœ€è¦çš„æ•°æ®ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ä»ç´¢å¼•çš„æ ¹èŠ‚ç‚¹å¼€å§‹è¿›è¡Œæœç´¢ã€‚</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/binaray_plus_tree_2.png" alt="B-Tree ç´¢å¼•ç»“æ„æ¦‚å›¾" width="95%">
</div>
<div class="title">å›¾ 23. B-Tree ç´¢å¼•ç»“æ„æ¦‚å›¾</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
é—®ï¼šç´¢å¼•çš„æ ¹èŠ‚ç‚¹çš„å€¼å˜è¿˜æ˜¯ä¸å˜ï¼Ÿ
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>å¶å­èŠ‚ç‚¹æ¯”è¾ƒç‰¹åˆ«ï¼Œä»–ä»¬çš„æŒ‡é’ˆæŒ‡å‘çš„æ˜¯è¢«ç´¢å¼•çš„æ•°æ®ï¼Œè€Œä¸æ˜¯å…¶ä»–çš„èŠ‚ç‚¹é¡µã€‚</p>
</div>
<div class="paragraph">
<p>æ ‘çš„æ·±åº¦å’Œè¡¨çš„å¤§å°ç›´æ¥ç›¸å…³ã€‚</p>
</div>
<div class="paragraph">
<p>B-Tree å¯¹ç´¢å¼•åˆ—æ˜¯é¡ºåºç»„ç»‡å­˜å‚¨çš„ï¼Œæ‰€ä»¥å¾ˆé€‚åˆæŸ¥æ‰¾èŒƒå›´æ•°æ®ã€‚</p>
</div>
<div class="paragraph">
<p>ä¾‹å¦‚ï¼š</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">CREATE</span> <span class="type">TABLE</span> people (
  last_name  <span class="predefined-type">VARCHAR</span>(<span class="integer">50</span>)     <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
  first_name <span class="predefined-type">VARCHAR</span>(<span class="integer">50</span>)     <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
  dob        <span class="predefined-type">DATE</span>            <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
  gender     <span class="predefined-type">ENUM</span> (<span class="string"><span class="delimiter">'</span><span class="content">m</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">f</span><span class="delimiter">'</span></span>) <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
  <span class="type">KEY</span> (last_name, first_name, dob)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>ä¸‰ä¸ªåˆ—ç»„æˆçš„è”åˆç´¢å¼•çš„ç»“æ„å¦‚ä¸‹ï¼š</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-Tree_unified_index.png" alt="B-Tree è”åˆç´¢å¼•" width="95%">
</div>
<div class="title">å›¾ 24. B-Tree è”åˆç´¢å¼•</div>
</div>
<div class="paragraph">
<p>æ³¨æ„ï¼šç´¢å¼•å¯¹å¤šä¸ªå€¼è¿›è¡Œæ’åºçš„ä¾æ®æ˜¯ <code>CREATE TABLE</code> è¯­å¥ä¸­å®šä¹‰ç´¢å¼•æ—¶åˆ—çš„é¡ºåºã€‚</p>
</div>
<div class="paragraph">
<p>B-Tree ç´¢å¼•æœ‰æ•ˆçš„æŸ¥è¯¢ï¼š</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">å…¨å€¼åŒ¹é…</dt>
<dd>
<p>å…¨å€¼åŒ¹é…æŒ‡çš„æ˜¯å’Œç´¢å¼•ä¸­çš„æ‰€æœ‰åˆ—è¿›è¡ŒåŒ¹é…ã€‚</p>
</dd>
<dt class="hdlist1">åŒ¹é…æœ€å·¦å‰ç¼€</dt>
<dd>
<p>åªä½¿ç”¨ç´¢å¼•å‰é¢çš„åˆ—ã€‚</p>
</dd>
<dt class="hdlist1">åŒ¹é…åˆ—å‰ç¼€</dt>
<dd>
<p>ä¹Ÿå¯ä»¥åªåŒ¹é…æŸä¸€åˆ—çš„å€¼çš„å¼€å¤´éƒ¨åˆ†ã€‚</p>
</dd>
<dt class="hdlist1">åŒ¹é…èŒƒå›´å€¼</dt>
<dd>
<p>æ¯”å¦‚åªåŒ¹é…åå­—</p>
</dd>
<dt class="hdlist1">ç²¾ç¡®åŒ¹é…æŸä¸€åˆ—å¹¶èŒƒå›´åŒ¹é…å¦å¤–ä¸€åˆ—</dt>
<dd>
<p>ç²¾ç¡®åŒ¹é…ç¬¬ä¸€åˆ—ï¼ŒèŒƒå›´åŒ¹é…ç¬¬äºŒåˆ—ã€‚</p>
</dd>
<dt class="hdlist1">åªè®¿é—®ç´¢å¼•çš„æŸ¥è¯¢</dt>
<dd>
<p>æŸ¥è¯¢åªéœ€è¦è®¿é—®ç´¢å¼•ï¼Œè€Œæ— é¡»è®¿é—®æ•°æ®è¡Œã€‚â€œè¦†ç›–ç´¢å¼•â€ã€‚</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>æ˜¯å› ä¸ºç´¢å¼•æ ‘ç§çš„èŠ‚ç‚¹æ˜¯æœ‰åºçš„ï¼Œé™¤äº†æŸ¥æ‰¾ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ç”¨äºæŸ¥è¯¢ä¸­çš„ <code>ORDER BY</code> æ“ä½œã€‚ä¸€èˆ¬æ¥è¯´ï¼Œ<strong>å¦‚æœ B-Tree å¯ä»¥æŒ‰ç…§æŸç§æ–¹å¼æŸ¥æ‰¾åˆ°å€¼ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥æŒ‰ç…§è¿™ç§æ–¹å¼ç”¨äºæ’åºã€‚æ‰€ä»¥ï¼Œå¦‚æœ <code>ORDER BY</code> å­å¥æ»¡è¶³å‰é¢åˆ—å‡ºçš„å‡ ç§æŸ¥è¯¢ç±»å‹ï¼Œåˆ™è¿™ä¸ªç´¢å¼•é¡µå¯ä»¥æ»¡è¶³å¯¹åº”çš„æ’åºéœ€æ±‚ã€‚</strong></p>
</div>
<div class="paragraph">
<p>B-Tree ç´¢å¼•çš„é™åˆ¶ï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>å¦‚æœä¸æ˜¯æŒ‰ç…§ç´¢å¼•çš„æœ€å·¦åˆ—å¼€å§‹æŸ¥æ‰¾ï¼Œåˆ™æ— æ³•ä½¿ç”¨ç´¢å¼•ã€‚</p>
</li>
<li>
<p>ä¸èƒ½è·³è¿‡ç´¢å¼•ä¸­çš„åˆ—ã€‚</p>
</li>
<li>
<p>å¦‚æœæŸ¥è¯¢ä¸­æœ‰æŸä¸ªåˆ—çš„èŒƒå›´æŸ¥è¯¢ï¼Œåˆ™å…¶å³è¾¹æ‰€æœ‰åˆ—éƒ½æ— æ³•ä½¿ç”¨ç´¢å¼•ä¼˜åŒ–æŸ¥æ‰¾ã€‚</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>å†æ¬¡æé†’ï¼šç´¢å¼•åˆ—çš„é¡ºåºæ˜¯å¤šä¹ˆé‡è¦ï¼Œè¿™äº›é™åˆ¶éƒ½å’Œç´¢å¼•åˆ—çš„é¡ºåºæœ‰å…³ã€‚<strong>åœ¨ä¼˜åŒ–æ€§èƒ½çš„æ—¶å€™ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨ç›¸åŒçš„åˆ—ä½†é¡ºåºä¸åŒçš„ç´¢å¼•æ¥æ»¡è¶³ä¸åŒç±»å‹çš„æŸ¥è¯¢éœ€æ±‚ã€‚</strong></p>
</div>
<div class="paragraph">
<p>B+æ ‘ç´¢å¼•å¹¶ä¸èƒ½æ‰¾åˆ°ä¸€ä¸ªç»™å®šé”®å€¼çš„å…·ä½“è¡Œã€‚B+æ ‘ç´¢å¼•èƒ½æ‰¾åˆ°çš„åªæ˜¯è¢«æŸ¥æ‰¾æ•°æ®è¡Œæ‰€åœ¨çš„é¡µã€‚ç„¶åæ•°æ®åº“é€šè¿‡æŠŠé¡µè¯»å…¥åˆ°å†…å­˜ï¼Œå†åœ¨å†…å­˜ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼Œæœ€åå¾—åˆ°è¦æŸ¥æ‰¾çš„æ•°æ®ã€‚</p>
</div>
</div>
<div class="sect4">
<h5 id="_å“ˆå¸Œç´¢å¼•">2.3.1.2. å“ˆå¸Œç´¢å¼•</h5>
<div class="paragraph">
<p>å“ˆå¸Œç´¢å¼•ï¼ˆhash indexï¼‰åŸºäºå“ˆå¸Œè¡¨å®ç°ï¼Œåªæœ‰ç²¾ç¡®åŒ¹é…æŸ¥è¯¢ç´¢å¼•æ‰€æœ‰åˆ—çš„æŸ¥è¯¢æ‰æœ‰æ•ˆã€‚</p>
</div>
<div class="paragraph">
<p>åœ¨ MySQL ä¸­ï¼Œåªæœ‰ Memory å¼•æ“æ˜¾å¼æ”¯æŒå“ˆå¸Œç´¢å¼•ã€‚ Memory å¼•æ“æ˜¯æ”¯æŒ éå”¯ä¸€å“ˆå¸Œç´¢å¼•çš„ã€‚</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">CREATE</span> <span class="type">TABLE</span> hash_test (
  fname <span class="predefined-type">VARCHAR</span>(<span class="integer">50</span>) <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
  lname <span class="predefined-type">VARCHAR</span>(<span class="integer">50</span>) <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
  <span class="type">KEY</span> <span class="keyword">USING</span> HASH (fname) <i class="conum" data-value="1"></i><b>(1)</b>
) <span class="directive">ENGINE</span> = MEMORY; <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>å»ºç«‹å“ˆå¸Œç´¢å¼•çš„æ–¹å¼</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>æŒ‡å®šå¼•æ“çš„æ–¹å¼</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>å¦‚æœå¤šä¸ªåˆ—çš„å“ˆå¸Œå€¼ç›¸åŒï¼Œç´¢å¼•ä¼šä»¥é“¾è¡¨çš„æ–¹å¼å­˜æ”¾å¤šä¸ªè®°å½•æŒ‡é’ˆåˆ°åŒä¸€ä¸ªå“ˆå¸Œæ¡ç›®ä¸­ã€‚</p>
</div>
<div class="paragraph">
<p>å“ˆå¸Œç´¢å¼•çš„é™åˆ¶ï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>å“ˆå¸Œç´¢å¼•åªåŒ…å«å“ˆå¸Œå€¼å’Œè¡ŒæŒ‡é’ˆï¼Œè€Œä¸å­˜å‚¨å­—æ®µå€¼ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨ç´¢å¼•ä¸­çš„å€¼æ¥é¿å…è¯»å–è¡Œã€‚</p>
</li>
<li>
<p>å“ˆå¸Œç´¢å¼•æ•°æ®å¹¶ä¸æ˜¯æŒ‰ç…§ç´¢å¼•å€¼é¡ºåºå­˜å‚¨çš„ï¼Œæ‰€ä»¥ä¹Ÿå°±æ— æ³•ç”¨äºæ’åºã€‚</p>
</li>
<li>
<p>å“ˆå¸Œç´¢å¼•ä¹Ÿä¸æ”¯æŒéƒ¨åˆ†ç´¢å¼•åˆ—åŒ¹é…æŸ¥æ‰¾ï¼Œå› ä¸ºå“ˆå¸Œç´¢å¼•å§‹ç»ˆæ˜¯ä½¿ç”¨ç´¢å¼•åˆ—çš„å…¨éƒ¨å†…å®¹æ¥è®¡ç®—å“ˆå¸Œå€¼çš„ã€‚</p>
</li>
<li>
<p>å“ˆå¸Œç´¢å¼•åªæ”¯æŒç­‰å€¼æ¯”è¾ƒæŸ¥è¯¢ï¼ŒåŒ…æ‹¬ <code>=</code>ã€ <code>IN()</code>ã€ <code>&lt;&#8658;</code>(æ³¨æ„ <code>&lt;&gt;</code> å’Œ <code>&lt;&#8658;</code> æ˜¯ä¸åŒçš„æ“ä½œ)ã€‚</p>
</li>
<li>
<p>è®¿é—®å“ˆå¸Œç´¢å¼•çš„æ•°æ®éå¸¸å¿«ï¼Œé™¤éæœ‰å¾ˆå¤šå“ˆå¸Œå†²çªã€‚å“ˆå¸Œå†²çªæ—¶ä½¿ç”¨é“¾è¡¨æ¥è§£å†³å“ˆå¸Œå†²çªã€‚</p>
</li>
<li>
<p>å¦‚æœå“ˆå¸Œå†²çªå¾ˆå¤šçš„è¯ï¼Œä¸€äº›æ‰€ä»¥ç»´æŠ¤æ“ä½œçš„ä»£ä»·ä¹Ÿä¼šå¾ˆé«˜ã€‚å†²çªè¶Šå¤šï¼Œä»£ä»·è¶Šå¤§ã€‚</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>å› ä¸ºè¿™äº›é™åˆ¶ï¼Œå“ˆå¸Œç´¢å¼•åªé€‚ç”¨äºæŸäº›ç‰¹å®šçš„åœºåˆã€‚è€Œä¸€æ—¦é€‚åˆå“ˆå¸Œç´¢å¼•ï¼Œåˆ™å®ƒå¸¦æ¥çš„æ€§èƒ½æå‡å°†éå¸¸æ˜¾è‘—ã€‚</p>
</div>
<div class="paragraph">
<p>é™¤äº† Memory ç´¢å¼•å¤–ï¼ŒNDB é›†ç¾¤å¼•æ“ä¹Ÿæ”¯æŒå”¯ä¸€å“ˆå¸Œç´¢å¼•ï¼Œä¸”åœ¨ NDB é›†ç¾¤å¼•æ“ä¸­ä½œç”¨éå¸¸ç‰¹æ®Šã€‚</p>
</div>
<div class="paragraph">
<p>InnoDB å¼•æ“æœ‰ä¸€ä¸ªç‰¹æ®Šçš„åŠŸèƒ½å«â€œè‡ªé€‚åº”å“ˆå¸Œç´¢å¼•ï¼ˆadaptive hash indexï¼‰â€ã€‚å½“ InnoDB æ³¨æ„åˆ°æŸäº›ç´¢å¼•å€¼ä½¿ç”¨å¾—ç‰¹åˆ«é¢‘ç¹æ—¶ï¼Œå®ƒä¼šåœ¨å†…å­˜ä¸­åŸºäº B-Tree ç´¢å¼•ä¹‹ä¸Šå†åˆ›å»ºä¸€ä¸ªå“ˆå¸Œç´¢å¼•ï¼Œè¿™æ ·å°±è®© B-Tree ç´¢å¼•ä¹Ÿå…·æœ‰å“ˆå¸Œç´¢å¼•çš„ä¸€äº›ä¼˜ç‚¹ï¼Œæ¯”å¦‚å¿«é€Ÿçš„å“ˆå¸ŒæŸ¥æ‰¾ã€‚è¿™æ˜¯ä¸€ä¸ªå®Œå…¨è‡ªåŠ¨çš„ã€å†…éƒ¨çš„è¡Œä¸ºï¼Œç”¨æˆ·æ— æ³•æ§åˆ¶æˆ–è€…é…ç½®ï¼Œå¦‚æœ‰å¿…è¦ï¼Œå¯ä»¥å…³é—­ã€‚</p>
</div>
<div class="paragraph">
<p><strong>åˆ›å»ºè‡ªå®šä¹‰å“ˆå¸Œç´¢å¼•</strong></p>
</div>
<div class="paragraph">
<p>å¦‚æœå­˜å‚¨å¼•æ“ä¸æ”¯æŒå“ˆå¸Œç´¢å¼•ï¼Œå¯ä»¥æ¨¡æ‹Ÿ InnoDB ä¸€æ ·åˆ›å»ºå“ˆå¸Œç´¢å¼•ã€‚æ€è·¯ï¼šåœ¨ B-Tree åŸºç¡€ä¸Šåˆ›å»ºä¸€ä¸ªä¼ªå“ˆå¸Œç´¢å¼•ã€‚å¹¶ä¸æ˜¯çœŸæ­£çš„å“ˆå¸Œç´¢å¼•ï¼Œæœ¬è´¨è¿˜æ˜¯ä½¿ç”¨ B-Tree è¿›è¡ŒæŸ¥æ‰¾ï¼Œä½†å®ƒä½¿ç”¨å“ˆå¸Œå€¼è€Œä¸æ˜¯é”®æœ¬èº«è¿›è¡ŒæŸ¥æ‰¾ã€‚éœ€è¦åšçš„å°±æ˜¯åœ¨æŸ¥è¯¢çš„ <code>WHERE</code> å­å¥ä¸­æ‰‹åŠ¨æŒ‡å®šä½¿ç”¨å“ˆå¸Œå‡½æ•°ã€‚</p>
</div>
<div class="listingblock">
<div class="title">ä»£ç  4. ä»¥ URL åˆ—ä¸ºä¾‹çš„è‡ªå®šä¹‰å“ˆå¸Œç´¢å¼•</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> id
<span class="keyword">FROM</span> url
<span class="keyword">WHERE</span> url=<span class="string"><span class="delimiter">'</span><span class="content">http://www.diguage.com/</span><span class="delimiter">'</span></span>;

<span class="comment">-- åˆ›å»ºè‡ªå®šä¹‰å“ˆå¸Œç´¢å¼•</span>
<span class="comment">-- æ³¨æ„ï¼šè¿™é‡Œéœ€è¦åœ¨ url_crc å­—æ®µä¸Šåˆ›å»ºç´¢å¼•</span>
<span class="class">SELECT</span> id
<span class="keyword">FROM</span> url
<span class="keyword">WHERE</span> url=<span class="string"><span class="delimiter">'</span><span class="content">http://www.diguage.com/</span><span class="delimiter">'</span></span>
    <span class="keyword">AND</span> url_crc=CRC32(<span class="string"><span class="delimiter">'</span><span class="content">http://www.diguage.com/</span><span class="delimiter">'</span></span>);

<span class="comment">-- å¦å¤–ä¸€ç§æ–¹å¼å°±æ˜¯å¯¹å®Œæ•´çš„ URL å­—ç¬¦ä¸²åšç´¢å¼•ï¼Œé‚£æ ·ä¼šéå¸¸æ…¢ã€‚</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>è‡ªå®šä¹‰å“ˆå¸Œç´¢å¼•çš„ç¼ºé™·æ˜¯éœ€è¦ç»´æŠ¤å“ˆå¸Œå€¼ã€‚å¯ä»¥æ‰‹åŠ¨ç»´æŠ¤ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è§¦å‘å™¨å®ç°ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
</div>
<div class="listingblock">
<div class="title">ä»£ç  5. åŸºäºè§¦å‘å™¨çš„è‡ªå®šä¹‰å“ˆå¸Œç´¢å¼•</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">DROP</span> <span class="type">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> url;
<span class="class">CREATE</span> <span class="type">TABLE</span> url (
  id      <span class="predefined-type">INT</span> <span class="predefined-type">UNSIGNED</span> <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span> <span class="directive">AUTO_INCREMENT</span>,
  url     <span class="predefined-type">VARCHAR</span>(<span class="integer">255</span>) <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
  url_crc <span class="predefined-type">INT</span> <span class="predefined-type">UNSIGNED</span> <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span> <span class="directive">DEFAULT</span> <span class="integer">0</span>,
  <span class="directive">PRIMARY</span> <span class="type">KEY</span> (id),
  <span class="type">KEY</span> (url_crc)  <i class="conum" data-value="1"></i><b>(1)</b>
);


DELIMITER //

<span class="comment">-- æ’å…¥è§¦å‘å™¨</span>
<span class="class">CREATE</span> <span class="type">TRIGGER</span> url_crc_ins
<span class="keyword">BEFORE</span> <span class="class">INSERT</span> <span class="keyword">ON</span> url
<span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span> <span class="class">BEGIN</span>
  <span class="class">SET</span> new.url_crc = crc32(new.url);
<span class="keyword">END</span>;

<span class="comment">-- æ›´æ–°è§¦å‘å™¨</span>
<span class="class">CREATE</span> <span class="type">TRIGGER</span> url_crc_upd
<span class="keyword">BEFORE</span> <span class="class">UPDATE</span> <span class="keyword">ON</span> url
<span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span> <span class="class">BEGIN</span>
  <span class="class">SET</span> new.url_crc = crc32(new.url);
<span class="keyword">END</span>;

<span class="class">INSERT</span> <span class="class">INTO</span> url (url) <span class="keyword">VALUES</span> (<span class="string"><span class="delimiter">'</span><span class="content">http:</span><span class="char">\/</span><span class="char">\/</span><span class="content">www.diguage.com/</span><span class="delimiter">'</span></span>);

<span class="class">SELECT</span> *
<span class="keyword">FROM</span> url; <i class="conum" data-value="2"></i><b>(2)</b>

<span class="class">UPDATE</span> url
<span class="class">SET</span> url = <span class="string"><span class="delimiter">'</span><span class="content">http:</span><span class="char">\/</span><span class="char">\/</span><span class="content">www.diguage.com</span><span class="delimiter">'</span></span>
<span class="keyword">WHERE</span> id = <span class="integer">1</span>;

<span class="class">SELECT</span> *
<span class="keyword">FROM</span> url; <i class="conum" data-value="2"></i><b>(2)</b>

<span class="class">SELECT</span> id
<span class="keyword">FROM</span> url
<span class="keyword">WHERE</span> url_crc = crc32(<span class="string"><span class="delimiter">'</span><span class="content">http:</span><span class="char">\/</span><span class="char">\/</span><span class="content">www.diguage.com/</span><span class="delimiter">'</span></span>)
      <span class="keyword">AND</span> url = <span class="string"><span class="delimiter">'</span><span class="content">http:</span><span class="char">\/</span><span class="char">\/</span><span class="content">www.diguage.com/</span><span class="delimiter">'</span></span>; <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>è¿™ä¸ªç´¢å¼•å¿…é¡»åˆ›å»ºã€‚</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>æ³¨æ„æŸ¥çœ‹æŸ¥è¯¢ç»“æœä¸­çš„ <code>url_crc</code> å­—æ®µçš„å€¼ã€‚</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>ä¸ºé¿å…å†²çªé—®é¢˜ï¼Œä½¿ç”¨å“ˆå¸Œç´¢å¼•æŸ¥è¯¢æ—¶ï¼Œå¿…é¡»åœ¨ <code>WHERE</code> å­å¥ä¸­åŒ…å«å¸¸é‡å€¼ã€‚</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>ç”Ÿæ—¥æ‚–è®ºï¼Œå‡ºç°å“ˆå¸Œå†²çªçš„æ¦‚ç‡çš„å¢é•¿é€Ÿåº¦å¯èƒ½æ¯”æƒ³è±¡çš„è¦å¿«å¾—å¤šã€‚</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span>
  CRC32(<span class="string"><span class="delimiter">'</span><span class="content">gnu</span><span class="delimiter">'</span></span>),
  CRC32(<span class="string"><span class="delimiter">'</span><span class="content">codding</span><span class="delimiter">'</span></span>);</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
å¯ä»¥æŠŠå“ˆå¸Œç´¢å¼•çš„å®ç°åŸç†å¯¹æ¯” <code>HashMap</code> çš„ä»£ç å®ç°ã€‚
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œè®°ä½<strong>ä¸è¦ä½¿ç”¨ <code>SHA1()</code> å’Œ <code>MD5()</code> ä½œä¸ºå“ˆå¸Œå‡½æ•°ã€‚</strong>å› ä¸ºè¿™ä¸¤ä¸ªå‡½æ•°è®¡ç®—å‡ºæ¥çš„å“ˆå¸Œå€¼æ˜¯éå¸¸é•¿çš„å­—ç¬¦ä¸²ï¼Œä¼šæµªè´¹å¤§é‡ç©ºé—´ï¼Œæ›´æ–°æ—¶ä¹Ÿä¼šæ›´æ…¢ã€‚ <code>SHA1()</code> å’Œ <code>MD5()</code> è®¾è®¡ç›®æ ‡æ˜¯æœ€å¤§é™åº¦æ¶ˆé™¤å†²çªï¼Œä½†è¿™é‡Œå¹¶ä¸éœ€è¦è¿™æ ·é«˜çš„è¦æ±‚ã€‚ç®€å•å“ˆå¸Œå‡½æ•°çš„å†²çªåœ¨ä¸€ä¸ªå¯ä»¥æ¥å—çš„èŒƒå›´ï¼ŒåŒæ—¶åˆèƒ½å¤Ÿæä¾›æ›´å¥½çš„æ€§èƒ½ã€‚</p>
</div>
<div class="paragraph">
<p>å¦‚æœæ•°æ®è¡¨éå¸¸å¤§ï¼Œ <code>CRC32()</code> ä¼šå‡ºç°å¤§é‡çš„å“ˆå¸Œå†²çªï¼Œåˆ™å¯ä»¥å®ç°ä¸€ä¸ªç®€å•çš„ 64 ä½å“ˆå¸Œå‡½æ•°ã€‚ä¸€ä¸ªç®€å•çš„åŠæ³•å¯ä»¥ä½¿ç”¨ <code>MD5()</code> å‡½æ•°è¿”å›å€¼çš„ä¸€éƒ¨åˆ†æ¥ä½œä¸ºè‡ªå®šä¹‰å‡½æ•°ã€‚æ€§èƒ½ç¨å·®ï¼Œä½†å®ç°ç®€å•ã€‚</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> CONV(<span class="keyword">RIGHT</span>(MD5(<span class="string"><span class="delimiter">'</span><span class="content">http:</span><span class="char">\/</span><span class="char">\/</span><span class="content">www.diguage.com/</span><span class="delimiter">'</span></span>), <span class="integer">16</span>), <span class="integer">16</span>, <span class="integer">10</span>) <span class="keyword">AS</span> hash64;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ç©ºé—´æ•°æ®ç´¢å¼•_r_tree">2.3.1.3. ç©ºé—´æ•°æ®ç´¢å¼•ï¼ˆR-Treeï¼‰</h5>
<div class="paragraph">
<p>MyISAM è¡¨æ”¯æŒç©ºé—´ç´¢å¼•ï¼Œå¯ä»¥ç”¨ä½œåœ°ç†æ•°æ®å­˜å‚¨ã€‚ç©ºé—´ç´¢å¼•ä¼šä»æ‰€æœ‰å”¯ç‹¬æ¥ç´¢å¼•æ•°æ®ã€‚æŸ¥è¯¢æ—¶ï¼Œå¯ä»¥æœ‰æ•ˆåœ°ä½¿ç”¨ä»»æ„ç»´åº¦æ¥ç»„åˆæŸ¥è¯¢ã€‚å¿…é¡»ä½¿ç”¨ MySQL çš„ GIS ç›¸å…³å‡½æ•°å¦‚ <code>MBRCONTAINS()</code> ç­‰æ¥ç»´æŠ¤æ•°æ®ã€‚</p>
</div>
<div class="paragraph">
<p>å¼€æºå…³ç³»æ•°æ®åº“ç³»ç»Ÿä¸­å¯¹ GIS çš„è§£å†³æ–¹æ¡ˆåšå¾—æ¯”è¾ƒå¥½çš„æ˜¯ PostgreSQL çš„ PostGISã€‚</p>
</div>
</div>
<div class="sect4">
<h5 id="_å…¨æ–‡ç´¢å¼•">2.3.1.4. å…¨æ–‡ç´¢å¼•</h5>
<div class="paragraph">
<p>å…¨æ–‡ç´¢å¼•æ—¶ä¸€ç§ç‰¹æ®Šç±»å‹çš„ç´¢å¼•ï¼Œå®ƒæŸ¥æ‰¾çš„æ˜¯æ–‡æœ¬ä¸­çš„å…³é”®è¯ï¼Œè€Œä¸æ˜¯ç›´æ¥æ¯”è¾ƒç´¢å¼•ä¸­çš„å€¼ã€‚</p>
</div>
<div class="paragraph">
<p>å…¨æ–‡ç´¢å¼•æ›´ç±»ä¼¼äºæœç´¢å¼•æ“åšçš„äº‹æƒ…ï¼Œè€Œä¸æ˜¯ç®€å•çš„ <code>WHERE</code> æ¡ä»¶åŒ¹é…ã€‚</p>
</div>
<div class="paragraph">
<p>å…¨æ–‡ç´¢å¼•é€‚ç”¨äº <code>MATCH AGAINST</code> æ“ä½œï¼Œè€Œä¸æ˜¯æ™®é€šçš„ <code>WHERE</code> æ¡ä»¶æŸ¥è¯¢ã€‚</p>
</div>
</div>
<div class="sect4">
<h5 id="_åˆ†å½¢æ ‘ç´¢å¼•_fractal_tree_index">2.3.1.5. åˆ†å½¢æ ‘ç´¢å¼•ï¼ˆfractal tree indexï¼‰</h5>
<div class="paragraph">
<p>è¿™æ˜¯ä¸€ç±»æ¯”è¾ƒæ–°å¼€å‘çš„æ•°æ®ç»“æ„ï¼Œæ—¢æœ‰ B-Tree çš„å¾ˆå¤šä¼˜ç‚¹ï¼Œä¹Ÿé¿å…äº† B-Tree çš„ä¸€äº›ç¼ºç‚¹ã€‚</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ç´¢å¼•çš„ä¼˜ç‚¹">2.4. ç´¢å¼•çš„ä¼˜ç‚¹</h3>
<div class="paragraph">
<p>ç´¢å¼•å¯ä»¥å¿«é€Ÿå®šä½åˆ°è¡¨çš„æŒ‡å®šä½ç½®ï¼›å¯ä»¥ç”¨ä½œ <code>ORDER BY</code> å’Œ <code>GROUP BY</code> æ“ä½œï¼›æŸäº›æŸ¥è¯¢åªä½¿ç”¨ç´¢å¼•å°±èƒ½å¤Ÿå®Œæˆå…¨éƒ¨æŸ¥è¯¢ã€‚</p>
</div>
<div class="paragraph">
<p>ç´¢å¼•çš„ä¸‰ä¸ªæœ‰ç‚¹ï¼š</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>ç´¢å¼•å¤§å¤§å‡å°‘äº†æœåŠ¡å™¨éœ€è¦æ‰«æçš„æ•°æ®é‡ã€‚</p>
</li>
<li>
<p>ç´¢å¼•å¯ä»¥å¸®åŠ©æœåŠ¡å™¨é¿å…æ’åºå’Œä¸´æ—¶è¡¨ã€‚</p>
</li>
<li>
<p>ç´¢å¼•å¯ä»¥å°†éšæœº I/O å˜ä¸ºé¡ºåº I/O ã€‚</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>å…³äºç´¢å¼•æ¨èé˜…è¯» Tapio Lahdenmaki å’Œ Michael Leach ç¼–å†™çš„ <a href="https://book.douban.com/subject/26419771/">æ•°æ®åº“ç´¢å¼•è®¾è®¡ä¸ä¼˜åŒ–</a>ï¼Œè¯¥ä¹¦è¯¦ç»†ä»‹ç»äº†å¦‚ä½•è®¡ç®—ç´¢å¼•çš„æˆæœ¬å’Œä½œç”¨ã€å¦‚ä½•è¯„ä¼°æŸ¥è¯¢é€Ÿåº¦ã€å¦‚ä½•åˆ†æç´¢å¼•ç»´æŠ¤çš„ä»£ä»·å’Œå…¶å¸¦æ¥çš„å¥½å¤„ç­‰ã€‚</p>
</div>
<div id="three-star-system" class="paragraph">
<p>Tapio Lahdenmaki å’Œ Michael Leach åœ¨ä¹¦ä¸­ä»‹ç»äº†å¦‚ä½•è¯„ä»·ä¸€ä¸ªç´¢å¼•æ˜¯å¦é€‚åˆæŸä¸ªæŸ¥è¯¢çš„â€œä¸‰æ˜Ÿç³»ç»Ÿâ€ï¼ˆthree-star systemï¼‰ï¼š</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>ç´¢å¼•å°†ç›¸å…³çš„è®°å½•æ”¾åˆ°ä¸€èµ·åˆ™è·å¾—ä¸€æ˜Ÿï¼›</p>
</li>
<li>
<p>å¦‚æœç´¢å¼•ä¸­çš„æ•°æ®é¡ºåºå’ŒæŸ¥æ‰¾ä¸­çš„æ’åˆ—é¡ºåºä¸€è‡´åˆ™è·å¾—äºŒæ˜Ÿï¼›</p>
</li>
<li>
<p>å¦‚æœç´¢å¼•ä¸­çš„åˆ—åŒ…å«äº†æŸ¥è¯¢ä¸­éœ€è¦çš„å…¨éƒ¨åˆ—åˆ™è·å¾—â€œä¸‰æ˜Ÿâ€ã€‚</p>
</li>
</ol>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">ç´¢å¼•æ—¶æœ€å¥½çš„è§£å†³æ–¹æ¡ˆå—ï¼Ÿ</div>
<div class="paragraph">
<p>ç´¢å¼•ä¸æ€»æ˜¯æœ€å¥½çš„å·¥å…·ã€‚åªæœ‰å½“ç´¢å¼•å¸®åŠ©å­˜å‚¨å¼•æ“å¿«é€ŸæŸ¥æ‰¾åˆ°è®°å½•å¸¦æ¥çš„å¥½å¤„å¤§äºå…¶å¸¦æ¥çš„é¢å¤–å·¥ä½œæ—¶ï¼Œç´¢å¼•æ‰æ˜¯æœ‰æ•ˆçš„ã€‚å¯¹äºéå¸¸å°çš„è¡¨ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹ç®€å•å…¨è¡¨æ‰«ææ›´é«˜æ•ˆã€‚å¯¹äºä¸­åˆ°å¤§å‹çš„è¡¨ï¼Œç´¢å¼•å°±éå¸¸æœ‰æ•ˆã€‚ä½†å¯¹äºç‰¹å¤§å‹çš„è¡¨ï¼Œå»ºç«‹å’Œä½¿ç”¨ç´¢å¼•çš„ä»£ä»·å°†éšä¹‹å¢é•¿ã€‚è¿™æ—¶å°±éœ€è¦åˆ†åŒºæŠ€æœ¯ã€‚</p>
</div>
<div class="paragraph">
<p>å¦‚æœè¡¨çš„æ•°é‡ç‰¹åˆ«å¤šï¼Œå¯ä»¥å»ºç«‹ä¸€ä¸ªå…ƒæ•°æ®ä¿¡æ¯è¡¨ï¼Œç”¨äºæŸ¥è¯¢éœ€è¦ç”¨åˆ°çš„æŸäº›ç‰¹æ€§ã€‚ä¾‹å¦‚</p>
</div>
<div class="paragraph">
<p>å¯¹äº TB çº§åˆ«çš„æ•°æ®ï¼Œå®šä½å•æ¡è®°å½•çš„æ„ä¹‰ä¸å¤§ï¼Œæ‰€ä»¥éœ€è¦ç»å¸¸ä¼šä½¿ç”¨å—çº§åˆ«å…ƒæ•°æ®æŠ€æœ¯æ¥æ›¿ä»£ç´¢å¼•ã€‚</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_é«˜æ€§èƒ½çš„ç´¢å¼•ç­–ç•¥">2.5. é«˜æ€§èƒ½çš„ç´¢å¼•ç­–ç•¥</h3>
<div class="paragraph">
<p>æ­£ç¡®åœ°åˆ›å»ºå’Œä½¿ç”¨ç´¢å¼•æ—¶å®ç°é«˜æ€§èƒ½æŸ¥è¯¢çš„åŸºç¡€ã€‚</p>
</div>
<div class="sect3">
<h4 id="_ç‹¬ç«‹çš„åˆ—">2.5.1. ç‹¬ç«‹çš„åˆ—</h4>
<div class="paragraph">
<p>â€œç‹¬ç«‹çš„åˆ—â€æ˜¯æŒ‡ç´¢å¼•åˆ—ä¸èƒ½æ˜¯è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿä¸èƒ½æ˜¯å‡½æ•°çš„å‚æ•°ã€‚</p>
</div>
<div class="paragraph">
<p>åº”è¯¥å…»æˆç®€åŒ– <code>WHERE</code> æ¡ä»¶çš„ä¹ æƒ¯ï¼Œå§‹ç»ˆå°†ç´¢å¼•åˆ—å•ç‹¬æ”¾åœ¨æ¯”è¾ƒç¬¦åˆçš„ä¸€ä¾§ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_å‰ç¼€ç´¢å¼•å’Œç´¢å¼•é€‰æ‹©æ€§">2.5.2. å‰ç¼€ç´¢å¼•å’Œç´¢å¼•é€‰æ‹©æ€§</h4>
<div class="paragraph">
<p>å½“ç´¢å¼•å¾ˆé•¿çš„å­—ç¬¦åˆ—ï¼Œä¼šè®©ç´¢å¼•å˜å¾—å¤§ä¸”æ…¢ï¼Œä¸€ä¸ªç­–ç•¥æ˜¯å‰é¢æåˆ°è¿‡çš„æ¨¡æ‹Ÿå“ˆå¸Œç´¢å¼•ã€‚</p>
</div>
<div class="paragraph">
<p>é€šå¸¸å¯ä»¥ç´¢å¼•å¼€å§‹çš„éƒ¨åˆ†å­—ç¬¦ï¼Œå¯ä»¥å¤§å¤§èŠ‚çº¦ç´¢å¼•ç©ºé—´ï¼Œä»è€Œæé«˜ç´¢å¼•æ•ˆç‡ã€‚ä½†è¿™æ ·ä¼šé™ä½ç´¢å¼•çš„é€‰æ‹©æ€§ã€‚</p>
</div>
<div class="paragraph">
<p>ç´¢å¼•çš„é€‰æ‹©æ€§æ˜¯æŒ‡ï¼Œä¸é‡å¤çš„ç´¢å¼•å€¼ï¼ˆä¹Ÿç§°ä¸ºåŸºæ•°ï¼Œcardinalityï¼‰å’Œæ•°æ®è¡¨çš„è®°å½•æ€»æ•°ï¼ˆ#Tï¼‰çš„æ¯”å€¼ï¼ŒèŒƒå›´ä» 1/#T åˆ°1ä¹‹é—´ã€‚ç´¢å¼•çš„é€‰æ‹©æ€§è¶Šé«˜åˆ™æŸ¥è¯¢æ•ˆç‡è¶Šé«˜ï¼Œå› ä¸ºé€‰æ‹©æ€§é«˜çš„ç´¢å¼•å¯ä»¥è®© MySQL åœ¨æŸ¥æ‰¾æ—¶è¿‡æ»¤æ‰æ›´å¤šçš„è¡Œã€‚å”¯ä¸€ç´¢å¼•çš„é€‰æ‹©æ€§æ˜¯ 1ï¼Œè¿™æ˜¯æœ€å¥½çš„ç´¢å¼•é€‰æ‹©æ€§ï¼Œæ€§èƒ½ä¹Ÿæ˜¯æœ€å¥½çš„ã€‚</p>
</div>
<div class="paragraph">
<p>ä¸€èˆ¬æƒ…å†µä¸‹æŸä¸ªåˆ—å‰ç¼€çš„é€‰æ‹©æ€§ä¹Ÿæ˜¯è¶³å¤Ÿé«˜çš„ï¼Œè¶³ä»¥æ»¡è¶³æŸ¥è¯¢æ€§èƒ½ã€‚å¯¹äº <code>BLOB</code>ã€ <code>TEXT</code> æˆ–è€…å¾ˆé•¿çš„ <code>VARCHAR</code> ç±»å‹çš„åˆ—ï¼Œå¿…é¡»ä½¿ç”¨å‰ç¼€ç´¢å¼•ã€‚</p>
</div>
<div class="paragraph">
<p>è¯€çªåœ¨äºè¦é€‰æ‹©è¶³å¤Ÿé•¿çš„å‰ç¼€ä»¥ä¿è¯è¾ƒé«˜çš„é€‰æ‹©æ€§ï¼ŒåŒæ—¶åˆä¸èƒ½å¤ªé•¿ï¼ˆä»¥ä¾¿èŠ‚çº¦ç©ºé—´ï¼‰ã€‚å‰ç¼€åº”è¯¥è¶³å¤Ÿé•¿ï¼Œä»¥æ˜¯çš„å‰ç¼€ç´¢å¼•çš„é€‰æ‹©æ€§æ¥è¿‘äºç´¢å¼•æ•´ä¸ªåˆ—ã€‚æ¢å¥è¯è¯´ï¼Œå‰ç¼€çš„â€œåŸºæ•°â€åº”è¯¥æ¥è¿‘äºå®Œæ•´åˆ—çš„â€œåŸºæ•°â€ã€‚</p>
</div>
<div class="paragraph">
<p>ä¸ºäº†è§‰å¾—å‰ç¼€çš„åˆé€‚é•¿åº¦ï¼Œéœ€è¦æ‰¾åˆ°æœ€å¸¸è§çš„å€¼çš„åˆ—è¡¨ï¼Œç„¶åå’Œæœ€å¸¸è§çš„å‰ç¼€åˆ—è¡¨è¿›è¡Œæ¯”è¾ƒã€‚</p>
</div>
<div class="listingblock">
<div class="title">ä»£ç  6. ä½¿ç”¨ SQL è¯­å¥æ¥æŸ¥çœ‹å‰ç¼€é•¿åº¦çš„é€‰æ‹©æ€§</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span>
  <span class="predefined">COUNT</span>(<span class="keyword">DISTINCT</span> <span class="keyword">LEFT</span>(last_name, <span class="integer">3</span>)) / <span class="predefined">COUNT</span>(*) <span class="keyword">AS</span> nam3,
  <span class="predefined">COUNT</span>(<span class="keyword">DISTINCT</span> <span class="keyword">LEFT</span>(last_name, <span class="integer">4</span>)) / <span class="predefined">COUNT</span>(*) <span class="keyword">AS</span> nam4,
  <span class="predefined">COUNT</span>(<span class="keyword">DISTINCT</span> <span class="keyword">LEFT</span>(last_name, <span class="integer">5</span>)) / <span class="predefined">COUNT</span>(*) <span class="keyword">AS</span> nam5,
  <span class="predefined">COUNT</span>(<span class="keyword">DISTINCT</span> <span class="keyword">LEFT</span>(last_name, <span class="integer">6</span>)) / <span class="predefined">COUNT</span>(*) <span class="keyword">AS</span> nam6,
  <span class="predefined">COUNT</span>(<span class="keyword">DISTINCT</span> <span class="keyword">LEFT</span>(last_name, <span class="integer">7</span>)) / <span class="predefined">COUNT</span>(*) <span class="keyword">AS</span> nam7
<span class="keyword">FROM</span> employees;</code></pre>
</div>
</div>
<div class="paragraph">
<p>å‰ç¼€ç´¢å¼•æ—¶ä¸€ç§èƒ½ä½¿ç´¢å¼•æ›´å°ã€æ›´å¿«çš„æœ‰æ•ˆåŠæ³•ï¼›ä¹Ÿæœ‰ç¼ºç‚¹ï¼ŒMySQL æ— æ³•ä½¿ç”¨å‰ç¼€ç´¢å¼•åš <code>ORDER BY</code> å’Œ <code>GROUP BY</code>ï¼Œä¹Ÿæ— æ³•ä½¿ç”¨å‰ç¼€ç´¢å¼•åšè¦†ç›–ç´¢å¼•ã€‚</p>
</div>
<div class="paragraph">
<p>ä¸€ä¸ªå¸¸è§çš„åœºæ™¯æ˜¯é’ˆå¯¹å¾ˆé•¿çš„åå…­è¿›åˆ¶å”¯ä¸€ ID ä½¿ç”¨å‰ç¼€ç´¢å¼•ã€‚ä¾‹å¦‚ SessionIDã€‚</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
æœ‰æ—¶åç¼€ç´¢å¼•(suffix index)ä¹Ÿæœ‰ç”¨é€”ã€‚ MySQL åŸç”Ÿä¸æ”¯æŒåå‘ç´¢å¼•ï¼Œä½†å¯ä»¥æŠŠå­—ç¬¦ä¸²åè½¬åå­˜å‚¨ï¼Œå¹¶åŸºäºæ­¤å»ºç«‹å‰ç¼€ç´¢å¼•ã€‚å¯ä»¥é€šè¿‡è§¦å‘å™¨æ¥ç»´æŠ¤è¿™ç§ç´¢å¼•ã€‚
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_å¤šåˆ—ç´¢å¼•">2.5.3. å¤šåˆ—ç´¢å¼•</h4>
<div class="paragraph">
<p>ä¸€ä¸ªå¸¸è§çš„é”™è¯¯å°±æ˜¯ï¼Œä¸ºæ¯ä¸ªåˆ—åˆ›å»ºç‹¬ç«‹çš„ç´¢å¼•ï¼Œæˆ–è€…æŒ‰ç…§é”™è¯¯çš„é¡ºåºåˆ›å»ºå¤šåˆ—ç´¢å¼•ã€‚</p>
</div>
<div class="paragraph">
<p>åœ¨å¤šä¸ªåˆ—ä¸Šå±±é‡Œç‹¬ç«‹çš„å•åˆ—ç´¢å¼•å¤§éƒ¨åˆ†æƒ…å†µä¸‹å¹¶ä¸èƒ½æé«˜ MySQL çš„æŸ¥è¯¢æ€§èƒ½ã€‚ MySQL 5.0 å’Œæ›´æ–°ç‰ˆæœ¬å¼•å…¥äº†ä¸€ç§â€œç´¢å¼•åˆå¹¶â€ï¼ˆindex mergeï¼‰çš„ç­–ç•¥ï¼Œä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥ä½¿ç”¨è¡¨ä¸Šçš„å¤šä¸ªå•åˆ—ç´¢å¼•æ¥å®šä½æŒ‡å®šçš„è¡Œã€‚</p>
</div>
<div class="paragraph">
<p>ç´¢å¼•åˆå¹¶æµ‹è¯•æœ‰æ—¶å€™æ˜¯ä¸€ç§ä¼˜åŒ–çš„ç»“æœï¼Œä½†å®é™…ä¸Šæ›´å¤šæ—¶å€™è¯´æ˜äº†è¡¨ä¸Šçš„ç´¢å¼•å»ºçš„å¾ˆç³Ÿç³•ï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>å½“å‡ºç°æœåŠ¡å™¨å¯¹å¤šä¸ªç´¢å¼•åšç›¸äº¤æ“ä½œæ—¶ï¼ˆé€šå¸¸æœ‰å¤šä¸ª <code>AND</code> æ¡ä»¶ï¼‰ï¼Œé€šå¸¸æ„å‘³ç€éœ€è¦ä¸€ä¸ªåŒ…å«æ‰€æœ‰ç›¸å…³åˆ—çš„å¤šåˆ—ç´¢å¼•ï¼Œè€Œä¸æ˜¯å¤šä¸ªç‹¬ç«‹çš„å•åˆ—ç´¢å¼•ã€‚</p>
</li>
<li>
<p>å½“æœåŠ¡å™¨éœ€è¦å¤šå¤šä¸ªç´¢å¼•åšè”åˆæ“ä½œæ—¶ï¼ˆé€šå¸¸æœ‰å¤šä¸ª <code>OR</code> æ¡ä»¶ï¼‰ï¼Œé€šå¸¸éœ€è¦è€—è´¹å¤§é‡ CPU å’Œå†…å­˜èµ„æºåœ¨ç®—æ³•çš„ç¼“å­˜ã€æ’åºå’Œåˆå¹¶æ“ä½œä¸Šã€‚ç‰¹åˆ«æ˜¯å½“æœ‰äº›ç´¢å¼•çš„é€‰æ‹©æ€§ä¸é«˜ï¼Œéœ€è¦åˆå¹¶æ‰«æè¿”å›çš„å¤§é‡æ•°æ®çš„æ—¶å€™ã€‚</p>
</li>
<li>
<p>æ›´é‡è¦çš„æ˜¯ï¼Œä¼˜åŒ–å™¨ä¸ä¼šæŠŠè¿™äº›è®¡ç®—çš„â€œæŸ¥è¯¢æˆæœ¬â€ä¸­ï¼Œä¼˜åŒ–å™¨åªå…³å¿ƒéšæœºé¡µé¢è¯»å–ã€‚è¿™ä½¿å¾—æŸ¥è¯¢çš„æˆæœ¬è¢«â€œä½ä¼°â€ã€‚</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>å¦‚æœåœ¨ <code>EXPLAIN</code> ä¸­çœ‹åˆ°æœ‰ç´¢å¼•åˆå¹¶ï¼Œåº”è¯¥å¥½å¥½æ£€æŸ¥ä¸€ä¸‹æŸ¥è¯¢å’Œè¡¨çš„ç»“æ„ï¼Œçœ‹æ˜¯ä¸æ˜¯å·²ç»æ˜¯æœ€ä¼˜çš„ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_é€‰æ‹©åˆé€‚çš„ç´¢å¼•åˆ—é¡ºåº">2.5.4. é€‰æ‹©åˆé€‚çš„ç´¢å¼•åˆ—é¡ºåº</h4>
<div class="paragraph">
<p>æœ€å®¹æ˜“å¼•èµ·å›°æƒ‘çš„é—®é¢˜å°±æ˜¯ç´¢å¼•åˆ—çš„é¡ºåºã€‚æ­£ç¡®çš„é¡ºåºä¾èµ–äºä½¿ç”¨è¯¥ç´¢å¼•çš„æŸ¥è¯¢ï¼Œå¹¶ä¸”åŒæ—¶éœ€è¦è€ƒè™‘å¦‚ä½•æ›´å¥½åœ°æ»¡è¶³æ’åºå’Œåˆ†ç»„çš„éœ€è¦ã€‚æœ¬èŠ‚å†…å®¹é€‚ç”¨äº B-Tree ç´¢å¼•ã€‚</p>
</div>
<div class="paragraph">
<p>åœ¨ä¸€ä¸ªå¤šåˆ— B-Tree ç´¢å¼•ä¸­ï¼Œç´¢å¼•åˆ—çš„é¡ºåºæ„å‘³ç€ç´¢å¼•é¦–å…ˆæŒ‰ç…§æœ€å·¦åˆ—è¿›è¡Œæ’åºï¼Œå…¶æ¬¡æ˜¯ç¬¬äºŒåˆ—ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ‰€ä»¥ï¼Œç´¢å¼•å¯ä»¥æŒ‰ç…§å‡åºæˆ–è€…é™åºè¿›è¡Œæ‰«æï¼Œä»¥æ»¡è¶³ç²¾ç¡®ç¬¦åˆåˆ—é¡ºåºçš„ <code>ORDER BY</code>ã€ <code>GROUP BY</code> å’Œ <code>DISTINCT</code> ç­‰å­å¥çš„æŸ¥è¯¢éœ€æ±‚ã€‚</p>
</div>
<div class="paragraph">
<p>åœ¨ Lahdenmaki å’Œ Leach çš„<a href="#three-star-system">â€œä¸‰æ˜Ÿç´¢å¼•â€</a>ç³»ç»Ÿä¸­ï¼Œåˆ—é¡ºåºä¹Ÿå†³å®šäº†ä¸€ä¸ªç´¢å¼•æ˜¯å¦èƒ½å¤Ÿæˆä¸ºä¸€ä¸ªçœŸæ­£çš„â€œä¸‰æ˜Ÿç´¢å¼•â€ã€‚</p>
</div>
<div class="paragraph">
<p>å¯¹äºå¦‚ä½•é€‰æ‹©ç´¢å¼•çš„åˆ—é¡ºåºæœ‰ä¸€ä¸ªç»éªŒæ³•åˆ™ï¼šå°†é€‰æ‹©æ€§æœ€é«˜çš„åˆ—æ”¾åˆ°ç´¢å¼•æœ€å‰åˆ—ã€‚é€šå¸¸ä¸å¦‚é¿å…éšæœº IO å’Œæ’åºé‚£ä¹ˆé‡è¦ã€‚</p>
</div>
<div class="paragraph">
<p>å½“ä¸éœ€è¦è€ƒè™‘æ’åºå’Œåˆ†ç»„æ—¶ï¼Œå°†é€‰æ‹©æ€§æœ€é«˜çš„åˆ—æ”¾åˆ°ç´¢å¼•æœ€å‰åˆ—é€šå¸¸æ˜¯å¾ˆå¥½çš„ã€‚</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>è¿™å°±æ˜¯åœ¨æ€è€ƒå»ºç«‹è”åˆç´¢å¼•æ—¶çš„ä¸€ä¸ªæŒ‡å¯¼åŸåˆ™ï¼é€‰æ‹©æ–¹æ³•å¦‚ä¸‹ï¼š</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">USE sakila; <i class="conum" data-value="1"></i><b>(1)</b>

<span class="class">SELECT</span>
  <span class="predefined">sum</span>(staff_id = <span class="integer">2</span>),
  <span class="predefined">sum</span>(customer_id = <span class="integer">584</span>)
<span class="keyword">FROM</span> payment;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>è¿™é‡Œä½¿ç”¨äº† MySQL å®˜æ–¹æä¾›çš„ sakila ç¤ºä¾‹æ•°æ®åº“ã€‚</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>æ ¹æ®æ‰§è¡Œç»“æœï¼Œç»“åˆä¸Šé¢æåˆ°çš„æŒ‡å¯¼åŸåˆ™ï¼Œåº”è¯¥è®²ç»“æœå€¼æ›´å°çš„åˆ—æ”¾åœ¨å‰é¢ã€‚</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>è¿™é‡Œæœ‰ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ï¼šä¸Šé¢æŸ¥è¯¢çš„ç»“æ„éå¸¸ä¾èµ–äºé€‰å®šçš„å…·ä½“å€¼ã€‚å¯¹å…¶ä»–æŸ¥è¯¢å¯èƒ½å°±ä¸é€‚ç”¨ã€‚</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>ç»éªŒæ³•åˆ™è€ƒè™‘çš„æ˜¯å…¨å±€åŸºæ•°å’Œé€‰æ‹©æ€§ï¼Œè€Œä¸æ˜¯æŸä¸ªå…·ä½“æŸ¥è¯¢ã€‚</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span>
  <span class="predefined">COUNT</span>(<span class="keyword">DISTINCT</span> staff_id) / <span class="predefined">COUNT</span>(*)    <span class="keyword">AS</span> staff_id_selectivity,
  <span class="predefined">COUNT</span>(<span class="keyword">DISTINCT</span> customer_id) / <span class="predefined">COUNT</span>(*) <span class="keyword">AS</span> customer_id_selectivity,
  <span class="predefined">COUNT</span>(*)
<span class="keyword">FROM</span> payment;</code></pre>
</div>
</div>
<div class="paragraph">
<p>æ ¹æ®æ‰§è¡Œç»“æ„ï¼Œé€‰æ‹©æ•°å­—æ¯”è¾ƒé«˜çš„åˆ—ä½œä¸ºç´¢å¼•åˆ—çš„ç¬¬ä¸€åˆ—ã€‚</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>æ€§èƒ½ä¸åªæ˜¯ä¾èµ–äºæ‰€æœ‰ç´¢å¼•åˆ—çš„é€‰æ‹©æ€§ï¼ˆæ•´ä½“åŸºæ•°ï¼‰ï¼Œä¹Ÿå’ŒæŸ¥è¯¢æ¡ä»¶çš„å…·ä½“å€¼æœ‰å…³ï¼Œä¹Ÿå°±æ˜¯å’Œå€¼çš„åˆ†å¸ƒæœ‰å…³ã€‚</p>
</div>
<div class="paragraph">
<p>å¯èƒ½éœ€è¦æ ¹æ®é‚£äº›è¿è¡Œæ•ˆç‡æœ€é«˜çš„æŸ¥è¯¢æ¥è°ƒæ•´ç´¢å¼•åˆ—çš„é¡ºåºã€‚</p>
</div>
<div class="paragraph">
<p>å°½ç®¡å…³äºé€‰æ‹©æ€§å’ŒåŸºæ•°çš„ç»éªŒæ³•åˆ™å€¼å¾—å»ç ”ç©¶å’Œåˆ†æï¼Œä½†ä¸€å®šè¦è®°ä½åˆ«å¿˜äº† <code>WHERE</code> å­å¥ä¸­çš„æ’åºã€åˆ†ç»„å’ŒèŒƒå›´æ¡ä»¶ç­‰å…¶ä»–å› ç´ ï¼Œè¿™äº›å› ç´ å¯èƒ½å¯¹æŸ¥è¯¢çš„æ€§èƒ½æ—©æ™¨éå¸¸å¤§çš„å½±å“ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_èšç°‡ç´¢å¼•">2.5.5. èšç°‡ç´¢å¼•</h4>
<div class="paragraph">
<p>èšç°‡ç´¢å¼•å¹¶ä¸æ˜¯ä¸€ç§å•ç‹¬çš„ç´¢å¼•ç±»å‹ï¼Œè€Œæ˜¯ä¸€ç§æ•°æ®å­˜å‚¨æ–¹å¼ã€‚InnoDB çš„èšç°‡ç´¢å¼•å®é™…ä¸Šåœ¨åŒä¸€ç»“æ„ä¸­ä¿å­˜äº† B-Tree ç´¢å¼•å’Œæ•°æ®è¡Œã€‚</p>
</div>
<div class="paragraph">
<p>å½“è¡¨æœ‰èšç°‡ç´¢å¼•æ—¶ï¼Œå®ƒçš„æ•°æ®è¡Œå®é™…ä¸Šå­˜æ”¾åœ¨ç´¢å¼•çš„å¶å­é¡µï¼ˆleaf pageï¼‰ä¸­ã€‚æœ¯è¯­â€œèšç°‡â€è¡¨ç¤ºæ•°æ®è¡Œå’Œç›¸é‚»çš„é”®å€¼ç´§å‡‘åœ°å­˜å‚¨åœ¨ä¸€èµ·ã€‚å› æ­¤ï¼Œä¸€ä¸ªè¡¨åªæœ‰ä¸€ä¸ªèšç°‡ç´¢å¼•ï¼ˆä¸è¿‡ï¼Œè¦†ç›–ç´¢å¼•å¯ä»¥æ¨¡æ‹Ÿå¤šä¸ªèšç°‡ç´¢å¼•çš„æƒ…å†µï¼‰ã€‚</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/clustered_index_data.png" alt="èšç°‡ç´¢å¼•çš„æ•°æ®åˆ†å¸ƒ" width="95%">
</div>
<div class="title">å›¾ 25. èšç°‡ç´¢å¼•çš„æ•°æ®åˆ†å¸ƒ</div>
</div>
<div class="paragraph">
<p>InnoDB é€šè¿‡ä¸»é”®èšé›†æ•°æ®ã€‚å¦‚æœæ²¡æœ‰å®šä¹‰ä¸»é”®ï¼Œ InnoDB ä¼šé€‰æ‹©ä¸€ä¸ªå”¯ä¸€çš„éç©ºç´¢å¼•ä»£æ›¿ï¼›å¦‚æœæ²¡æœ‰è¿™æ ·çš„ç´¢å¼•ï¼Œ InnoDB ä¼šéšå¼å®šä¹‰å“¥ä¸»é”®æ¥ä½œä¸ºèšç°‡ç´¢å¼•ã€‚</p>
</div>
<div class="paragraph">
<p>èšé›†çš„æ•°æ®çš„ä¸€äº›é‡è¦çš„ä¼˜ç‚¹ï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>å¯ä»¥æŠŠç›¸å…³æ•°æ®ä¿å­˜åœ¨ä¸€èµ·ã€‚ä¾‹å¦‚ï¼Œæ ¹æ®ç”¨æˆ·IDæ¥èšé›†æ•°æ®ï¼Œå¯ä»¥é¡ºåºè¯»å–æŸä¸ªç”¨æˆ·çš„å…¨éƒ¨é‚®ä»¶ã€‚</p>
</li>
<li>
<p>æ•°æ®è®¿é—®æ›´å¿«ã€‚èšç°‡ç´¢å¼•å°†ç´¢å¼•å’Œæ•°æ®ä¿å­˜åœ¨åŒä¸€ä¸ª B-Tree ä¸­ï¼Œå› æ­¤ä»èšç°‡ç´¢å¼•ä¸­è·å–æ•°æ®é€šå¸¸æ¯”éèšç°‡ç´¢å¼•ä¸­æŸ¥æ‰¾è¦å¿«ã€‚</p>
</li>
<li>
<p>ä½¿ç”¨è¦†ç›–ç´¢å¼•æ‰«æçš„æŸ¥è¯¢å¯ä»¥ç›´æ¥ä½¿ç”¨é¡µèŠ‚ç‚¹ä¸­çš„ä¸»é”®å€¼ã€‚</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>èšé›†æ•°æ®çš„ä¸€äº›ç¼ºç‚¹ï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>èšç°‡æ•°æ®æœ€å¤§é™åº¦æé«˜äº† I/O å¯†é›†å‹åº”ç”¨çš„æ€§èƒ½ï¼Œä½†å¦‚æœæ•°æ®å…¨éƒ¨éƒ½æ”¾åœ¨å†…å­˜ä¸­ï¼Œåˆ™è®¿é—®çš„é¡ºåºå°±æ²¡é‚£ä¹ˆé‡è¦äº†ï¼Œèšç°‡ç´¢å¼•ä¹Ÿå°±æ²¡ä»€ä¹ˆä¼˜åŠ¿äº†ã€‚</p>
</li>
<li>
<p>æ’å…¥é€Ÿåº¦ä¸¥é‡ä¾èµ–äºæ’å…¥é¡ºåºã€‚æŒ‰ç…§ä¸»é”®çš„é¡ºåºæ’å…¥æ˜¯åŠ è½½æ•°æ®åˆ° InnoDB è¡¨ä¸­é€Ÿåº¦æœ€å¿«çš„æ–¹å¼ã€‚ä½†å¦‚æœä¸æ˜¯æŒ‰ç…§ä¸»é”®é¡ºåºåŠ è½½æ•°æ®ï¼Œé‚£ä¹ˆåœ¨åŠ è½½å®Œæˆåæœ€å¥½ä½¿ç”¨ <code>OPTIMIZE TABLE</code> å‘½ä»¤é‡æ–°ç»„ç»‡ä¸€ä¸‹è¡¨ã€‚</p>
</li>
<li>
<p>æ›´æ–°èšç°‡ç´¢å¼•åˆ—çš„ä»£ä»·å¾ˆé«˜ï¼Œå› ä¸ºä¼šå¼ºåˆ¶ InnoDB å°†æ¯ä¸ªè¢«æ›´æ–°çš„è¡Œç§»åŠ¨åˆ°æ–°çš„ä½ç½®ã€‚</p>
</li>
<li>
<p>åŸºäºèšç°‡ç´¢å¼•çš„è¡¨åœ¨æ’å…¥æ–°è¡Œï¼Œæˆ–è€…ä¸»é”®è¢«æ›´æ–°å¯¼è‡´éœ€è¦ç§»åŠ¨è¡Œçš„æ—¶å€™ï¼Œå¯èƒ½é¢ä¸´â€œé¡µåˆ†è£‚â€çš„é—®é¢˜ã€‚é¡µåˆ†è£‚ä¼šå¯¼è‡´è¡¨å ç”¨æ›´å¤šçš„ç£ç›˜ç©ºé—´ã€‚</p>
</li>
<li>
<p>èšç°‡ç´¢å¼•å¯èƒ½å¯¼è‡´å…¨è¡¨æ‰«æå˜æ…¢ï¼Œå°¤å…¶æ˜¯è¡Œæ¯”è¾ƒç¨€ç–ï¼Œæˆ–è€…ç”±äºé¡µåˆ†è£‚å¯¼è‡´æ•°æ®å­˜å‚¨ä¸è¿ç»­çš„æ—¶å€™ã€‚</p>
</li>
<li>
<p>äºŒçº§ç´¢å¼•ï¼ˆéèšç°‡ç´¢å¼•ï¼‰å¯èƒ½ç»™æƒ³è±¡çš„è¦æ›´å¤§ï¼Œå› ä¸ºåœ¨äºŒçº§ç´¢å¼•çš„å¶å­èŠ‚ç‚¹åŒ…å«äº†å¼•ç”¨è¡Œçš„ä¸»é”®åˆ—ã€‚</p>
</li>
<li>
<p>äºŒçº§ç´¢å¼•è®¿é—®éœ€è¦ä¸¤æ¬¡ç´¢å¼•æŸ¥æ‰¾ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡ã€‚</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>äºŒçº§ç´¢å¼•å¶å­èŠ‚ç‚¹ä¿å­˜çš„ä¸æ˜¯æŒ‡å‘è¡Œçš„ç‰©ç†ä½ç½®çš„æŒ‡é’ˆï¼Œè€Œæ˜¯è¡Œçš„ä¸»é”®å€¼ã€‚äºŒçº§ç´¢å¼•è¦ä¸¤æ¬¡ B-Tree æŸ¥æ‰¾è€Œä¸æ˜¯ä¸€æ¬¡ï¼Œå¯¹äº InnoDBï¼Œè‡ªé€‚åº”å“ˆå¸Œç´¢å¼•èƒ½å¤Ÿå‡å°‘è¿™æ ·çš„é‡å¤å·¥ä½œã€‚<em>ä¸ºä»€ä¹ˆèƒ½å‡å°‘ï¼Ÿ</em></p>
</div>
<div class="sect4">
<h5 id="_innodb_å’Œ_myisam_çš„æ•°æ®åˆ†å¸ƒå¯¹æ¯”">2.5.5.1. InnoDB å’Œ MyISAM çš„æ•°æ®åˆ†å¸ƒå¯¹æ¯”</h5>
<div class="paragraph">
<p>ä¸ºäº†æ–¹ä¾¿è®²è§£ï¼Œåˆ†åˆ«ä½¿ç”¨ InnoDB å’Œ MyISAM å¼•æ“å»ºç«‹ç»“æ„å¦‚ä¸‹çš„è¡¨ï¼Œå¹¶æŒ‰ä¸»é”®éšæœºé¡ºåºæ’å…¥ä¸»é”®å€¼åœ¨ 1 ~ 10000 çš„10000æ¡æ•°æ®ï¼š</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">CREATE</span> <span class="type">TABLE</span> layout_test (
  col1 <span class="predefined-type">INT</span> <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
  col2 <span class="predefined-type">INT</span> <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
  <span class="directive">PRIMARY</span> <span class="type">KEY</span> (col1),
  <span class="type">KEY</span> (col2)
); <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>è¯·åœ¨å»ºç«‹çš„æ—¶å€™æŒ‡å®šå¼•æ“ç±»å‹</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>MyISAM çš„æ•°æ®åˆ†å¸ƒ</strong></p>
</div>
<div class="paragraph">
<p>MyISAM æŒ‰ç…§æ•°æ®æ’å…¥çš„é¡ºåºå­˜å‚¨åœ¨ç£ç›˜ä¸Šã€‚å¦‚å›¾ï¼š</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/MyISAM_data_layout.png" alt="MyISAM è¡¨ layout_test çš„æ•°æ®åˆ†å¸ƒ" width="95%">
</div>
<div class="title">å›¾ 26. MyISAM è¡¨ layout_test çš„æ•°æ®åˆ†å¸ƒ</div>
</div>
<div class="paragraph">
<p>åœ¨è¡Œæ—è¾¹æ˜¾ç¤ºäº†è¡Œå·ï¼Œä» 0 å¼€å§‹é€’å¢ã€‚å› ä¸ºè¡Œæ˜¯å®šé•¿çš„ï¼Œæ‰€ä»¥ MyISAM å¯ä»¥ä»è¡¨çš„å¼€å¤´è·³è¿‡æ‰€éœ€è¦çš„å­—èŠ‚æ‰¾åˆ°éœ€è¦çš„è¡Œã€‚ï¼ˆMyISAM æ˜¯æ ¹æ®å®šé•¿è¿˜æ˜¯å˜é•¿çš„è¡Œä½¿ç”¨ä¸åŒç­–ç•¥æ¥ç¡®å®šè¡Œå·ã€‚ï¼‰</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/MyISAM_primary_key_layout.png" alt="MyISAM è¡¨ layout_test çš„ä¸»é”®ç´¢å¼•åˆ†å¸ƒ" width="95%">
</div>
<div class="title">å›¾ 27. MyISAM è¡¨ layout_test çš„ä¸»é”®ç´¢å¼•åˆ†å¸ƒ</div>
</div>
<div class="paragraph">
<p>è¿™é‡Œæœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„ï¼š</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>ä¸»é”®å¶å­èŠ‚ç‚¹å­˜æ”¾çš„æŒ‡å‘æ•°æ®è¡Œçš„æŒ‡é’ˆã€‚</p>
</li>
<li>
<p>ä¸»é”®å’Œå…¶ä»–ç´¢å¼•æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/MyISAM_primary_key_layout_2.png" alt="MyISAM è¡¨ layout_test çš„ä¸»é”®ç´¢å¼•åˆ†å¸ƒ" width="95%">
</div>
<div class="title">å›¾ 28. MyISAM è¡¨ layout_test çš„ä¸»é”®ç´¢å¼•åˆ†å¸ƒ</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/MyISAM_secondary_key_layout.png" alt="MyISAM è¡¨ layout_test çš„äºŒçº§ç´¢å¼•åˆ†å¸ƒ" width="95%">
</div>
<div class="title">å›¾ 29. MyISAM è¡¨ layout_test çš„äºŒçº§ç´¢å¼•åˆ†å¸ƒ</div>
</div>
<div class="paragraph">
<p>äº‹å®ä¸Šï¼Œ MyISAM ä¸­ä¸»é”®ç´¢å¼•å’Œå…¶ä»–ç´¢å¼•åœ¨ç»“æ„ä¸Šæ²¡æœ‰ä»€ä¹ˆä¸åŒã€‚ä¸»é”®ç´¢å¼•å°±æ˜¯ä¸€ä¸ªåä¸º PRIMARY çš„å”¯ä¸€éç©ºç´¢å¼•ã€‚</p>
</div>
<div class="paragraph">
<p><strong>InnoDB çš„æ•°æ®åˆ†å¸ƒ</strong></p>
</div>
<div class="paragraph">
<p>InnoDB æ”¯æŒèšç°‡ç´¢å¼•ï¼Œæ‰€ä»¥ä½¿ç”¨ä¸åŒçš„æ–¹å¼å­˜å‚¨åŒæ ·çš„æ•°æ®ã€‚</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/InnoDB_primary_key_layout.png" alt="InnoDB è¡¨ layout_test çš„ä¸»é”®ç´¢å¼•åˆ†å¸ƒ" width="95%">
</div>
<div class="title">å›¾ 30. InnoDB è¡¨ layout_test çš„ä¸»é”®ç´¢å¼•åˆ†å¸ƒ</div>
</div>
<div class="paragraph">
<p>æ³¨æ„ï¼šè¯¥å›¾æ˜¾ç¤ºäº†æ•´ä¸ªè¡¨ï¼Œè€Œä¸æ˜¯åªæœ‰ç´¢å¼•ã€‚åœ¨ InnoDB ä¸­ï¼Œèšç°‡ç´¢å¼•â€œå°±æ˜¯â€è¡¨ã€‚</p>
</div>
<div class="paragraph">
<p>èšç°‡ç´¢å¼•çš„æ¯ä¸€ä¸ªå¶å­èŠ‚ç‚¹éƒ½åŒ…å«äº†ä¸»é”®å€¼ã€äº‹åŠ¡ IDã€ç”¨äºäº‹åŠ¡å’Œ MVCC çš„å›æ»šæŒ‡é’ˆä»¥åŠæ‰€æœ‰çš„å‰©ä½™åˆ—ã€‚å¦‚æœä¸»é”®æ˜¯ä¸€ä¸ªåˆ—å‰ç¼€ç´¢å¼•ï¼Œ InnoDB ä¹Ÿä¼šåŒ…å«å®Œæ•´çš„ä¸»é”®åˆ—å’Œå‰©ä¸‹çš„å…¶ä»–åˆ—ã€‚</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/InnoDB_primary_key_layout_2.png" alt="InnoDB è¡¨ layout_test çš„ä¸»é”®ç´¢å¼•åˆ†å¸ƒ" width="95%">
</div>
<div class="title">å›¾ 31. InnoDB è¡¨ layout_test çš„ä¸»é”®ç´¢å¼•åˆ†å¸ƒ</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
å‰æ–‡è¯´ InnoDB æŠŠ <code>BLOB</code> ç±»å‹çš„ä¼šæ”¾åœ¨å•ç‹¬åŒºåŸŸï¼Œå¦‚æœä¸»é”®æ˜¯ <code>BLOB</code> ç±»å‹çš„åˆ—å‰ç¼€ç´¢å¼•ï¼Œè¯¥å¦‚ä½•å­˜å‚¨ï¼Ÿ
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>InnoDB çš„äºŒçº§ç´¢å¼•å’Œèšç°‡ç´¢å¼•å¾ˆä¸ç›¸åŒã€‚ InnoDB äºŒçº§ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨çš„ä¸æ˜¯â€œè¡ŒæŒ‡é’ˆâ€ï¼Œè€Œæ˜¯ä¸»é”®å€¼ï¼Œå¹¶ä»¥æ­¤ä½œä¸ºæŒ‡å‘è¡Œçš„â€œæŒ‡é’ˆâ€ã€‚è¿™æ ·çš„ç­–ç•¥å‡å°‘äº†å½“å‡ºç°è¡Œç§»åŠ¨æˆ–è€…æ•°æ®é¡µåˆ†è£‚æ—¶äºŒçº§ç´¢å¼•çš„ç»´æŠ¤ã€‚ä½¿ç”¨ä¸»é”®å€¼å½“åšæŒ‡é’ˆä¼šè®©äºŒçº§ç´¢å¼•å ç”¨æ›´å¤šçš„ç©ºé—´ï¼Œæ¢æ¥çš„å¥½å¤„æ˜¯ï¼Œ InnoDB åœ¨ç§»åŠ¨è¡Œæ—¶æ— é¡»æ›´æ–°äºŒçº§ç´¢å¼•ä¸­çš„è¿™ä¸ªâ€œæŒ‡é’ˆâ€ã€‚</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
å¯¹æ¯”æ¥çœ‹ï¼Œ MyISAM åœ¨æ›´æ–°æ—¶ï¼Œå¦‚æœå‡ºç°è¡Œç§»åŠ¨ï¼Œåˆ™è¦æ›´æ–°æ‰€æœ‰çš„äºŒçº§ç´¢å¼•çš„è¡ŒæŒ‡é’ˆã€‚
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/InnoDB_secondary_key_layout.png" alt="InnoDB è¡¨ layout_test çš„äºŒçº§ç´¢å¼•åˆ†å¸ƒ" width="95%">
</div>
<div class="title">å›¾ 32. InnoDB è¡¨ layout_test çš„äºŒçº§ç´¢å¼•åˆ†å¸ƒ</div>
</div>
<div class="paragraph">
<p>æ³¨æ„ä¸¤ç‚¹ï¼š</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>æ¯ä¸ªå¶å­èŠ‚ç‚¹éƒ½åŒ…å«äº†ç´¢å¼•åˆ—ï¼Œç´§æ¥ç€æ˜¯ä¸»é”®ç´¢å¼•ã€‚</p>
</li>
<li>
<p>éå¶å­èŠ‚ç‚¹åŒ…å«äº†ç´¢å¼•åˆ—å’Œä¸€ä¸ªæŒ‡å‘ä¸‹çº§èŠ‚ç‚¹çš„æŒ‡é’ˆã€‚è¿™å¯¹èšç°‡ç´¢å¼•å’ŒäºŒçº§ç´¢å¼•éƒ½æ˜¯ç”¨ã€‚</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/InnoDB_compare_MyISAM.png" alt="èšç°‡å’Œéèšç°‡è¡¨å¯¹æ¯”" width="95%">
</div>
<div class="title">å›¾ 33. èšç°‡å’Œéèšç°‡è¡¨å¯¹æ¯”</div>
</div>
</div>
<div class="sect4">
<h5 id="_åœ¨_innodb_è¡¨ä¸­æŒ‰ä¸»é”®é¡ºåºæ’å…¥è¡Œ">2.5.5.2. åœ¨ InnoDB è¡¨ä¸­æŒ‰ä¸»é”®é¡ºåºæ’å…¥è¡Œ</h5>
<div class="paragraph">
<p>ä¿è¯æ•°æ®è¡Œæ˜¯æŒ‰é¡ºåºå†™å…¥ï¼Œå¯¹äºæ ¹æ®ä¸»é”®åšå…³è”æ“ä½œçš„æ€§èƒ½ä¹Ÿä¼šæ›´å¥½ã€‚</p>
</div>
<div class="paragraph">
<p>æœ€å¥½é¿å…éšæœºçš„ï¼ˆä¸è¿ç»­ä¸”å€¼çš„åˆ†å¸ƒèŒƒå›´éå¸¸å¤§ï¼‰èšç°‡ç´¢å¼•ï¼Œç‰¹åˆ«æ˜¯å¯¹äº I/O å¯†é›†å‹çš„åº”ç”¨ã€‚éšæœºä¸»é”®ä½¿å¾—èšç°‡ç´¢å¼•çš„æ’å…¥å˜å¾—å®Œå…¨éšæœºï¼Œè¿™æ˜¯æœ€åçš„æƒ…å†µï¼Œä½¿å¾—æ•°æ®æ²¡æœ‰ä»»ä½•èšé›†ç‰¹æ€§ã€‚</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/InnoDB_order_insert.png" alt="å‘èšç°‡ç´¢å¼•æ’å…¥é¡ºåºçš„ç´¢å¼•å€¼" width="95%">
</div>
<div class="title">å›¾ 34. å‘èšç°‡ç´¢å¼•æ’å…¥é¡ºåºçš„ç´¢å¼•å€¼</div>
</div>
<div class="paragraph">
<p>å› ä¸ºä¸»é”®çš„å€¼æ—¶é¡ºåºçš„ï¼Œæ‰€ä»¥ InnoDB æŠŠæ¯ä¸€æ¡è®°å½•éƒ½å­˜å‚¨åœ¨ä¸Šä¸€æ¡è®°å½•çš„åé¢ã€‚å½“è¾¾åˆ°é¡µçš„æœ€å¤§å¡«å……å› å­æ—¶ï¼ˆInnoDB é»˜è®¤çš„æœ€å¤§å¡«å……å› å­æ˜¯é¡µå¤§å°çš„ 15/16ï¼Œç•™å‡ºéƒ¨åˆ†ç©ºé—´ç”¨äºä»¥åä¿®æ”¹ï¼‰ï¼Œä¸‹ä¸€æ¡è®°å½•éƒ½ä¼šå†™å…¥æ–°çš„é¡µä¸­ã€‚ä¸€æ—¦æ•°æ®æŒ‰ç…§è¿™ç§é¡ºåºçš„æ–¹å¼åŠ è½½ï¼Œä¸»é”®é¡µå°±ä¼šè¿‘ä¼¼äºè¢«é¡ºåºçš„è®°å½•å¡«æ»¡ã€‚</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/InnoDB_random_insert.png" alt="å‘èšç°‡ç´¢å¼•æ’å…¥æ— åºçš„ç´¢å¼•å€¼" width="95%">
</div>
<div class="title">å›¾ 35. å‘èšç°‡ç´¢å¼•æ’å…¥æ— åºçš„ç´¢å¼•å€¼</div>
</div>
<div class="paragraph">
<p>å› ä¸ºä¸»é”®å€¼ä¸ä¸€å®šæ¯”ä¹‹å‰æ’å…¥çš„å¤§ï¼Œæ‰€ä»¥ InnoDB æ— æ³•ç®€å•åœ°æ€»æ˜¯æŠŠæ–°è¡Œæ’å…¥åˆ°ç´¢å¼•çš„æœ€åï¼Œè€Œæ˜¯éœ€è¦ä¸ºæ–°çš„è¡Œå¯»æ‰¾åˆé€‚çš„ä½ç½®&#8201;&#8212;&#8201;é€šå¸¸æ˜¯å·²æœ‰æ•°æ®çš„ä¸­é—´ä½ç½®&#8201;&#8212;&#8201;å¹¶ä¸”åˆ†å¼€ç©ºé—´ã€‚è¿™ä¼šå¢åŠ å¾ˆå¤šé¢å¤–çš„å·¥ä½œï¼Œå¹¶å¯¼è‡´æ•°æ®åˆ†å¸ƒä¸å¤Ÿä¼˜åŒ–ã€‚ç¼ºç‚¹ï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>å†™å…¥çš„ç›®æ ‡é¡µå¯èƒ½å·²ç»åˆ·åˆ°ç£ç›˜ä¸Šå¹¶ä»ç¼“å­˜ä¸­ç§»é™¤ï¼Œæˆ–è€…æ˜¯è¿˜æ²¡æœ‰è¢«åŠ è½½åˆ°ç¼“å­˜ä¸­ï¼Œ InnoDB åœ¨æ’å…¥ä¹‹å‰ä¸å¾—ä¸å…ˆæ‰¾åˆ°å¹¶ä»ç£ç›˜è¯»å–ç›®æ ‡é¡µåˆ°å†…å­˜ä¸­ã€‚è¿™å°†å¯¼è‡´å¤§é‡çš„éšæœº I/Oã€‚</p>
</li>
<li>
<p>å› ä¸ºå†™å…¥æ˜¯ä¹±åºçš„ï¼Œ InnoDB ä¸å¾—ä¸é¢‘ç¹åœ°åšé¡µåˆ†è£‚æ“ä½œï¼Œä»¥ä¾¿ä¸ºæ–°çš„è¡Œåˆ†é…ç©ºé—´ã€‚é¡µåˆ†è£‚ä¼šå¯¼è‡´ç§»åŠ¨å¤§é‡æ•°æ®ï¼Œä¸€æ¬¡æ’å…¥æœ€å°‘éœ€è¦ä¿®æ”¹ä¸‰ä¸ªé¡µè€Œä¸æ˜¯ä¸€ä¸ªé¡µã€‚ <em>ä¸ºä»€ä¹ˆæœ€å°‘æ˜¯ä¸‰ä¸ªé¡µï¼Ÿ</em></p>
</li>
<li>
<p>ç”±äºé¢‘ç¹çš„é¡µåˆ†è£‚ï¼Œé¡µä¼šå˜å¾—ç¨€ç–å¹¶è¢«ä¸è§„åˆ™åœ°å¡«å……ï¼Œæ‰€ä»¥æœ€ç»ˆæ•°æ®ä¼šæœ‰ç¢ç‰‡ã€‚</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>åœ¨æŠŠéšæœºå€¼è½½å…¥åˆ°èšç°‡ç´¢å¼•ä»¥åï¼Œä¹Ÿè®¸éœ€è¦åšä¸€æ¬¡ <code>OPTIMIZE TABLE</code> æ¥é‡å»ºè¡¨å¹¶ä¼˜åŒ–é¡µçš„å¡«å……ã€‚</p>
</div>
<div class="literalblock">
<div class="content">
<pre>.é¡ºåºä¸»é”®ä¹Ÿä¼šé€ æˆæ›´åçš„ç»“æœ
****
å¯¹äºé«˜å¹¶å‘å·¥ä½œè´Ÿè½½ï¼Œåœ¨ InnoDB ä¸­æŒ‰ä¸»é”®é¡ºåºæ’å…¥å¯èƒ½ä¼šé€ æˆæ˜æ˜¾çš„äº‰ç”¨ã€‚ä¸»é”®çš„ä¸Šç•Œä¼šæˆä¸ºâ€œçƒ­ç‚¹â€ã€‚å¹¶å‘æ’å…¥å¯èƒ½å¯¼è‡´é—´éš™é”ç«äº‰ã€‚å¦ä¸€ä¸ªçƒ­ç‚¹å¯èƒ½æ˜¯ `AUTO_INCREMENT` é”æœºåˆ¶ã€‚
****</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_è¦†ç›–ç´¢å¼•">2.5.6. è¦†ç›–ç´¢å¼•</h4>
<div class="paragraph">
<p>è®¾è®¡ä¼˜ç§€çš„ç´¢ç´¢å¼•åº”è¯¥è€ƒè™‘åˆ°æ•´ä¸ªæŸ¥è¯¢ï¼Œè€Œä¸å•å•æ˜¯ <code>WHERE</code> æ¡ä»¶éƒ¨åˆ†ã€‚</p>
</div>
<div class="paragraph">
<p>å¦‚æœä¸€ä¸ªç´¢å¼•åŒ…å«ï¼ˆæˆ–è€…è¯´è¦†ç›–ï¼‰æ‰€æœ‰éœ€è¦æŸ¥è¯¢çš„å­—æ®µçš„å€¼ï¼Œåˆ™ç§°ä¹‹ä¸ºâ€œè¦†ç›–ç´¢å¼•â€ã€‚</p>
</div>
<div class="paragraph">
<p>è¦†ç›–ç´¢å¼•æ—¶éå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œèƒ½å¤Ÿæå¤§åœ°æé«˜æ€§èƒ½ã€‚ä¼˜ç‚¹å¦‚ä¸‹ï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ç´¢å¼•æ¡ç›®é€šå¸¸è¿œå°äºæ•°æ®è¡Œå¤§å°ï¼Œæ‰€ä»¥å¦‚æœåªéœ€è¦è¯»å–ç´¢å¼•ï¼Œåˆ™ MySQL å°±ä¼šæå¤§åœ°å‡å°‘æ•°æ®è®¿é—®é‡ã€‚</p>
</li>
<li>
<p>å› ä¸ºç´¢å¼•æ—¶æŒ‰ç…§åˆ—å€¼é¡ºåºå­˜å‚¨çš„ï¼ˆè‡³å°‘åœ¨å•ä¸ªé¡µå†…æ˜¯å¦‚æ­¤ï¼‰ï¼Œæ‰€ä»¥å¯¹äº I/O å¯†é›†å‹çš„èŒƒå›´æŸ¥è¯¢ä¼šæ¯”éšæœºä»ç£ç›˜è¯»å–æ¯ä¸€è¡Œæ•°æ®çš„ I/O è¦å°‘å¾—å¤šã€‚</p>
</li>
<li>
<p>ä¸€äº›å­˜å‚¨å¼•æ“å¦‚ MyISAM åœ¨å†…å­˜ä¸­åªç¼“å­˜ç´¢å¼•ï¼Œæ•°æ®åˆ™ä¾èµ–äºæ“ä½œç³»ç»Ÿæ¥ç¼“å­˜ï¼Œå› æ­¤è¦è®¿é—®æ•°æ®éœ€è¦ä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ã€‚</p>
</li>
<li>
<p>ç”±äº InnoDB çš„èšç°‡ç´¢å¼•ï¼Œè¦†ç›–ç´¢å¼•å¯¹ InnoDB è¡¨ç‰¹åˆ«æœ‰ç”¨ã€‚å¦‚æœäºŒçº§ä¸»é”®èƒ½å¤Ÿè¦†ç›–æŸ¥è¯¢ï¼Œåˆ™å¯ä»¥é¿å…å¯¹ä¸»é”®ç´¢å¼•çš„äºŒæ¬¡æŸ¥è¯¢ã€‚</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>ä¸æ˜¯æ‰€æœ‰çš„ç´¢å¼•éƒ½å¯ä»¥æˆä¸ºè¦†ç›–ç´¢å¼•ã€‚è¦†ç›–ç´¢å¼•å¿…é¡»è¦å­˜å‚¨ç´¢å¼•åˆ—çš„å€¼ï¼Œè€Œå“ˆå¸Œç´¢å¼•ã€ç©ºé—´ç´¢å¼•å’Œå…¨æ–‡ç´¢å¼•ç­‰éƒ½ä¸å­˜å‚¨ç´¢å¼•åˆ—çš„å€¼ï¼Œæ‰€ä»¥ MySQL åªèƒ½ä½¿ç”¨ B-Tree ç´¢å¼•åšè¦†ç›–ç´¢å¼•ã€‚ä¹Ÿä¸æ˜¯æ‰€æœ‰çš„å­˜å‚¨å¼•æ“éƒ½æ”¯æŒè¦†ç›–ç´¢å¼•ï¼Œæ¯”å¦‚ Memory ä¸æ”¯æŒã€‚</p>
</div>
<div class="paragraph">
<p>ç´¢å¼•è¦†ç›–æŸ¥è¯¢è¿˜æœ‰å¾ˆå¤šé™·é˜±å¯èƒ½ä¼šå¯¼è‡´æ— æ³•å®ç°ä¼˜åŒ–ã€‚ MySQL æŸ¥è¯¢ä¼˜åŒ–å™¨ä¼šåœ¨æ‰§è¡ŒæŸ¥è¯¢å‰åˆ¤æ–­æ˜¯å¦æœ‰ä¸€ä¸ªç´¢å¼•èƒ½è¿›è¡Œè¦†ç›–ã€‚</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
è¿™é‡Œæ€è€ƒä¸€ä¸‹ï¼Œä»€ä¹ˆæ ·çš„æŸ¥è¯¢æ‰æ˜¯è¦†ç›–ç´¢å¼•ï¼Ÿéœ€è¦æ»¡è¶³ä»€ä¹ˆæ¡ä»¶ï¼Ÿä» SQL è¯­å¥çš„ç»„æˆæ¥çœ‹ã€‚
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>ä»ä¸‹é¢çš„æŸ¥è¯¢æ¥çœ‹ï¼š</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> *
<span class="keyword">FROM</span> products
<span class="keyword">WHERE</span> actor = <span class="string"><span class="delimiter">'</span><span class="content">SEAN CARREY</span><span class="delimiter">'</span></span>
      <span class="keyword">AND</span> title <span class="keyword">LIKE</span> <span class="string"><span class="delimiter">'</span><span class="content">%APOLLO%</span><span class="delimiter">'</span></span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>è¿™é‡Œç´¢å¼•æ— æ³•è¦†ç›–è¯¥æŸ¥è¯¢ï¼Œæœ‰ä¸¤ä¸ªåŸå› ï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>æ²¡æœ‰ä»»ä½•ç´¢å¼•èƒ½å¤Ÿè¦†ç›–è¿™ä¸ªæŸ¥è¯¢ã€‚æŸ¥è¯¢ä»è¡¨ä¸­é€‰æ‹©äº†æ‰€æœ‰çš„è¡Œï¼Œè€Œæ²¡æœ‰ä»»ä½•ç´¢å¼•è¦†ç›–äº†æ‰€æœ‰çš„åˆ—ã€‚</p>
</li>
<li>
<p>MySQL ä¸èƒ½åœ¨ç´¢å¼•ä¸­æ‰§è¡Œ <code>LIKE</code> æ“ä½œã€‚è¿™æ˜¯åº•å±‚å­˜å‚¨å¼•æ“ API çš„é™åˆ¶ã€‚MySQL èƒ½åœ¨ç´¢å¼•ä¸­åšæœ€å·¦å‰ç¼€åŒ¹é…çš„ <code>LIKE</code> æ¯”è¾ƒã€‚</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>å¯ä»¥é‡æ–°æŸ¥è¯¢å¹¶å·§å¦™åœ°è®¾è®¡ç´¢å¼•ï¼Œå…ˆå°†ç´¢å¼•æ‰©å±•è‡³è¦†ç›–ä¸‰ä¸ªæ•°æ®åˆ—ï¼ˆactorã€titleã€prod_idï¼‰ï¼Œç„¶åå¦‚ä¸‹æ–¹å¼é‡å†™æŸ¥è¯¢ï¼š</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> *
<span class="keyword">FROM</span> products
  <span class="keyword">JOIN</span> (<span class="class">SELECT</span> prod_id
        <span class="keyword">FROM</span> products
        <span class="keyword">WHERE</span> actor = <span class="string"><span class="delimiter">'</span><span class="content">SEAN CARREY</span><span class="delimiter">'</span></span>
              <span class="keyword">AND</span> title <span class="keyword">LIKE</span> <span class="string"><span class="delimiter">'</span><span class="content">%APOLLO%</span><span class="delimiter">'</span></span>) <span class="keyword">AS</span> t1
    <span class="keyword">ON</span> t1.prod_id = products.prod_id;</code></pre>
</div>
</div>
<div class="paragraph">
<p>è¿™ç§æ–¹å¼å«åšå»¶è¿Ÿå…³è”ï¼ˆdeferred joinï¼‰ï¼Œå› ä¸ºå»¶è¿Ÿäº†å¯¹åˆ—çš„è®¿é—®ã€‚åœ¨æŸ¥è¯¢çš„ç¬¬ä¸€é˜¶æ®µ MySQL å¯ä»¥ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼Œåœ¨ <code>FROM</code> å­å¥çš„å­æŸ¥è¯¢ä¸­æ‰¾åˆ°åŒ¹é…çš„ <code>prod_id</code>ï¼Œç„¶åæ ¹æ®è¿™äº› <code>prod_id</code> å€¼åœ¨å¤–å±‚æŸ¥è¯¢åŒ¹é…è·å–éœ€è¦çš„æ‰€æœ‰åˆ—å€¼ã€‚</p>
</div>
<div class="paragraph">
<p>è¿™ç§ä¼˜åŒ–æ–¹å¼åœ¨æ•°æ®é‡å¾ˆå¤§ï¼Œç¬¦åˆæ¡ä»¶çš„æ•°æ®å¾ˆå°æ—¶ï¼Œä¼˜åŒ–æ•ˆæœæ˜æ˜¾ï¼›åœ¨æ•°æ®é‡å¾ˆå¤§ï¼Œç¬¦åˆæ¡ä»¶çš„æ•°æ®å¾ˆå¤§æ—¶ï¼Œæ•ˆæœä¸æ˜æ˜¾ï¼Œå› ä¸ºå¤§éƒ¨åˆ†æ—¶é—´æ˜¯èŠ±åœ¨è¯»å–å’Œå‘é€æ•°æ®äº†ï¼›å¦‚æœæ•°æ®é‡å¾ˆå°ï¼Œå­æŸ¥è¯¢åè€Œä¼šæ‹–æ…¢æŸ¥è¯¢ã€‚</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
ä»¥å‰è§‰å¾—å†™ SQL è¯­å¥å°±æ˜¯ä¸ªæŠ€æœ¯æ´»ï¼Œç°åœ¨æ¥çœ‹ï¼Œå®ƒè¿˜æ˜¯ä¸€é—¨è‰ºæœ¯ï¼Œä¸€é—¨éœ€è¦æ€è€ƒçš„è‰ºæœ¯ï¼
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>è¿™é‡Œè¿˜æœ‰ä¸€ç‚¹éœ€è¦ç‰¹åˆ«ç‚¹å‡ºï¼š InnoDB çš„äºŒçº§ç´¢å¼•ä¸­è¿˜å­˜æ”¾çš„æ˜¯æŒ‡å‘æ•°æ®è¡Œçš„ä¸»é”® IDã€‚æ‰€ä»¥ï¼Œé™¤äº†ç´¢å¼•åˆ—å¤–ï¼Œè¿˜æœ‰ä¸»é”® ID ä¹Ÿå¯ä»¥åœ¨è¦†ç›–ç´¢å¼•ä¸­ä½¿ç”¨ã€‚</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">æœªæ¥ MySQL ç‰ˆæœ¬çš„æ”¹è¿›</div>
<div class="paragraph">
<p>ä¸Šé¢æåˆ°é™åˆ¶ä¸»è¦æ˜¯å› ä¸ºå­˜å‚¨å¼•æ“ API ä¸å…è®¸ MySQL å°†è¿‡æ»¤æ¡ä»¶ä¼ åˆ°å­˜å‚¨å¼•æ“å±‚å¯¼è‡´çš„ã€‚MySQL 5.6 ä¸­åŒ…å«äº†åœ¨å­˜å‚¨å¼•æ“ API ä¸Šæ‰€åšçš„ä¸€ä¸ªé‡è¦çš„æ”¹è¿›ï¼Œå…¶è¢«ç§°ä¸ºâ€œç´¢å¼•æ¡ä»¶æ¨é€â€ï¼ˆindex condition pushdownï¼‰ï¼Œå¯ä»¥å¤§å¤§æ”¹å–„ç°åœ¨çš„æŸ¥è¯¢æ‰§è¡Œæ–¹å¼ï¼Œå¦‚æ­¤ä¸€æ¥ä¸Šé¢ä»‹ç»çš„å¾ˆå¤šæŠ€å·§ä¹Ÿå°±ä¸å†éœ€è¦äº†ã€‚</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ä½¿ç”¨ç´¢å¼•æ‰«ææ¥åšæ’åº">2.5.7. ä½¿ç”¨ç´¢å¼•æ‰«ææ¥åšæ’åº</h4>
<div class="paragraph">
<p>MySQL æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥ç”Ÿæˆæœ‰åºçš„ç»“æœï¼šé€šè¿‡æ’åºæ“ä½œï¼›æˆ–è€…æŒ‰ç´¢å¼•é¡ºåºæ‰«æã€‚</p>
</div>
<div class="paragraph">
<p>MySQL å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªç´¢å¼•æ—¢æ»¡è¶³æ’åºï¼Œåˆç”¨äºæŸ¥æ‰¾è¡Œã€‚è®¾è®¡ç´¢å¼•æ—¶åº”è¯¥å°½å¯èƒ½åœ°åŒæ—¶æ»¡è¶³è¿™ä¸¤ç§ä»»åŠ¡ã€‚</p>
</div>
<div class="paragraph">
<p>åªæœ‰å½“ç´¢å¼•çš„åˆ—é¡ºåºå’Œ <code>ORDER BY</code> å­å¥çš„é¡ºåºå®Œå…¨ä¸€è‡´ï¼Œå¹¶ä¸”æ‰€æœ‰åˆ—çš„æ’åºæ–¹å‘ï¼ˆå€’åºæˆ–æ­£åºï¼‰éƒ½ä¸€æ ·æ—¶ï¼Œ MySQL æ‰èƒ½å¤Ÿä½¿ç”¨ç´¢å¼•æ¥å¯¹ç»“æœåšæ’åºã€‚å¦‚æœæŸ¥è¯¢éœ€è¦å…³è”å¤šå¼ è¡¨ï¼Œåˆ™åªæœ‰å½“ <code>ORDER BY</code> å­å¥å¼•ç”¨çš„å­—æ®µå…¨éƒ¨ä¸ºç¬¬ä¸€ä¸ªè¡¨æ—¶ï¼Œæ‰èƒ½ä½¿ç”¨ç´¢å¼•åšæ’åºã€‚ <code>ORDER BY</code> å­å¥å’ŒæŸ¥æ‰¾å‹æŸ¥è¯¢çš„é™åˆ¶æ˜¯ä¸€æ ·çš„ï¼šéœ€è¦æ»¡è¶³ç´¢å¼•çš„æœ€å·¦å‰ç¼€çš„è¦æ±‚ï¼›å¦åˆ™ï¼Œ MySQL éƒ½éœ€è¦æ‰§è¡Œæ’åºæ“ä½œï¼Œè€Œæ— æ³•åˆ©ç”¨ç´¢å¼•æ’åºã€‚</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
å¦‚æœéœ€è¦å®‰è£…ä¸åŒæ–¹å‘åšæ’åºï¼Œä¸€ä¸ªæŠ€å·§æ˜¯å­˜å‚¨è¯¥åˆ—å€¼çš„åè½¬ä¸²æˆ–è€…ç›¸åæ•°ã€‚
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>è¿˜æœ‰ä¸€ç§æƒ…å†µä¸‹ <code>ORDER BY</code> å­å¥å¯ä»¥ä¸æ»¡è¶³ç´¢å¼•çš„æœ€å·¦å‰ç¼€çš„è¦æ±‚ï¼Œå°±æ˜¯å‰å¯¼åˆ—ä¸ºå¸¸é‡çš„æ—¶å€™ã€‚å¯ä»¥åœ¨ <code>WHERE</code> å­å¥æˆ–è€… <code>JOIN</code> å­å¥ä¸­å¯¹è¿™äº›åˆ—æŒ‡å®šäº†å¸¸é‡ï¼Œå°±å¯ä»¥ â€œå¼¥è¡¥â€ ç´¢å¼•çš„ä¸è¶³ã€‚</p>
</div>
<div class="paragraph">
<p>ä½¿ç”¨ç´¢å¼•åšæ’åºçš„ä¸€ä¸ªæœ€é‡è¦çš„ç”¨æ³•æ˜¯å½“æŸ¥è¯¢åŒæ—¶æœ‰ <code>ORDER BY</code> å’Œ <code>LIMIT</code> å­å¥çš„æ—¶å€™ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_å‹ç¼©_å‰ç¼€å‹ç¼©_ç´¢å¼•">2.5.8. å‹ç¼©ï¼ˆå‰ç¼€å‹ç¼©ï¼‰ç´¢å¼•</h4>
<div class="paragraph">
<p>MyISAM ä½¿ç”¨å‰ç¼€å‹ç¼©æ¥å‡å°‘ç´¢å¼•çš„å¤§å°ï¼Œå¯è®©æ›´å¤šç´¢å¼•æ”¾å…¥å†…å­˜ä¸­ï¼ŒæŸäº›æƒ…å†µå¯ä»¥æå¤§æé«˜æ€§èƒ½ã€‚é»˜è®¤åªå‹ç¼©å­—ç¬¦ä¸²ï¼Œé€šè¿‡å‚æ•°è®¾ç½®å¯ä»¥å¯¹æ•´æ•°åšå‹ç¼©ã€‚</p>
</div>
<div class="paragraph">
<p>MyISAM å‹ç¼©æ¯ä¸ªç´¢å¼•å—çš„æ–¹æ³•æ˜¯ï¼Œå…ˆå®Œå…¨ä¿å­˜ç´¢å¼•å—ä¸­çš„ç¬¬ä¸€ä¸ªå€¼ï¼Œç„¶åå°†å…¶ä»–å€¼å’Œç¬¬ä¸€ä¸ªå€¼è¿›è¡Œæ¯”è¾ƒå¾—åˆ°ç›¸åŒå‰ç¼€çš„å­—èŠ‚æ•°å’Œå‰©ä½™çš„ä¸åŒåç¼€éƒ¨åˆ†ï¼ŒæŠŠè¿™éƒ¨åˆ†å­˜å‚¨èµ·æ¥å³å¯ã€‚</p>
</div>
<div class="paragraph">
<p>å‹ç¼©å—ä½¿ç”¨æ›´å°‘çš„ç©ºé—´ï¼Œä»£ä»·æ˜¯æŸäº›æ“ä½œå¯èƒ½æ›´æ…¢ã€‚ MyISAM æŸ¥æ‰¾æ—¶æ— æ³•å†ç´¢å¼•å—ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾è€Œåªèƒ½ä»å¤´å¼€å§‹æ‰«æã€‚æ­£åºçš„æ‰«æé€Ÿåº¦è¿˜ä¸é”™ï¼Œä½†æ˜¯å¦‚æœæ˜¯å€’åºæ‰«æï¼Œå°±æƒ¨äº†ï¼</p>
</div>
<div class="paragraph">
<p>å¯¹äº CPU å¯†é›†å‹åº”ç”¨ï¼Œå‹ç¼©ä½¿å¾— MyISAM åœ¨ç´¢å¼•æŸ¥æ‰¾ä¸Šè¦æ…¢å¥½å‡ å€ã€‚</p>
</div>
<div class="paragraph">
<p>å¯ä»¥åœ¨ <code>CREATE TABLE</code> è¯­å¥æ±‡æ€»æŒ‡å®š <code>PACK_KEYS</code> å‚æ•°æ¥æ§åˆ¶ç´¢å¼•å‹ç¼©çš„æ–¹å¼ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_å†—ä½™å’Œé‡å¤ç´¢å¼•">2.5.9. å†—ä½™å’Œé‡å¤ç´¢å¼•</h4>
<div class="paragraph">
<p>é‡å¤ç´¢å¼•æŒ‡åœ¨ç›¸åŒçš„åˆ—ä¸ŠæŒ‰ç…§ç›¸åŒçš„é¡ºåºåˆ›å»ºçš„ç›¸åŒç±»å‹çš„ç´¢å¼•ã€‚</p>
</div>
<div class="paragraph">
<p>MySQL çš„å”¯ä¸€é™åˆ¶å’Œä¸»é”®é™åˆ¶éƒ½æ˜¯é€šè¿‡ç´¢å¼•å®ç°çš„ã€‚</p>
</div>
<div class="paragraph">
<p>å†—ä½™ç´¢å¼•å’Œé‡å¤ç´¢å¼•æœ‰ä¸€äº›ä¸åŒã€‚å¦‚æœåˆ›å»ºäº†ç´¢å¼•ï¼ˆAï¼ŒBï¼‰ï¼Œå†åˆ›å»ºç´¢å¼•ï¼ˆAï¼‰å°±æ˜¯å†—ä½™ç´¢å¼•ã€‚</p>
</div>
<div class="paragraph">
<p>è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯å°†ä¸€ä¸ªç´¢å¼•æ‰©å±•ä¸ºï¼ˆAï¼ŒIDï¼‰ï¼Œå…¶ä¸­ ID æ˜¯ä¸»é”®ï¼Œå¯¹äº InnoDB æ¥è¯´ä¸»é”®åˆ—å·²ç»åŒ…å«åœ¨äºŒçº§ç´¢å¼•ä¸­ï¼Œè¿™ä¹Ÿæ˜¯å†—ä½™ã€‚</p>
</div>
<div class="paragraph">
<p>å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½ä¸éœ€è¦å†—ä½™ç´¢å¼•ï¼Œåº”è¯¥å°½å¿«æ‰©å±•å·²æœ‰çš„ç´¢å¼•è€Œä¸æ˜¯åˆ›å»ºæ–°ç´¢å¼•ã€‚ä½†æœ‰æ—¶å¤„äºæ€§èƒ½çš„è€ƒè™‘éœ€è¦å†—ä½™ï¼Œå› ä¸ºæ‰©å±•å·²æœ‰çš„ç´¢å¼•ä¼šå¯¼è‡´å…¶å˜å¾—å¤ªå¤§ï¼Œä»è€Œå½±å“å…¶ä»–ä½¿ç”¨è¯¥ç´¢å¼•çš„æŸ¥è¯¢çš„æ€§èƒ½ã€‚</p>
</div>
<div class="paragraph">
<p>æœ‰æ—¶ä¸ºäº†è¦†ç›–æŸ¥è¯¢ï¼Œä¹Ÿéœ€è¦æ‰©å±•ç´¢å¼•ã€‚</p>
</div>
<div class="paragraph">
<p>ä¸€èˆ¬æ¥è¯´ï¼Œå¢åŠ æ–°ç´¢å¼•å°†ä¼šå¯¹å¯¼è‡´ <code>INSERT</code>ã€ <code>UPDATE</code>ã€ <code>DELETE</code> ç­‰æ“ä½œçš„é€Ÿåº¦å˜æ…¢ï¼Œç‰¹åˆ«æ˜¯å½“æ–°å¢åŠ ç´¢å¼•åå¯¼è‡´è¾¾åˆ°äº†å†…å­˜ç“¶é¢ˆçš„æ—¶å€™ã€‚</p>
</div>
<div class="paragraph">
<p>è§£å†³å†—ä½™ç´¢å¼•å’Œé‡å¤ç´¢å¼•çš„æ–¹æ³•å¾ˆç®€å•ï¼Œåˆ é™¤è¿™äº›ç´¢å¼•å³å¯ï¼Œä½†é¦–å…ˆè¦åšçš„æ˜¯æ‰¾å‡ºè¿™æ ·çš„ç´¢å¼•ã€‚</p>
</div>
<div class="paragraph">
<p>åœ¨å†³å®šå“ªäº›ç´¢å¼•å¯ä»¥è¢«åˆ é™¤çš„æ—¶å€™è¦éå¸¸å°å¿ƒã€‚è¦è€ƒè™‘æŸ¥è¯¢ã€æ’åºç­‰ã€‚å¯ä»¥ä½¿ç”¨ Percona å·¥å…·ç®±ä¸­çš„ <code>pt-upgrade</code> å·¥å…·æ¥æ£€æŸ¥è®¡åˆ’ä¸­çš„ç´¢å¼•å˜æ›´ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_æœªä½¿ç”¨çš„ç´¢å¼•">2.5.10. æœªä½¿ç”¨çš„ç´¢å¼•</h4>
<div class="paragraph">
<p>é™¤äº†å†—ä½™ç´¢å¼•å’Œé‡å¤ç´¢å¼•ï¼Œå¯èƒ½è¿˜ä¼šæœ‰ä¸€äº›æœåŠ¡å™¨æ°¸è¿œä¸ç”¨çš„ç´¢å¼•ï¼Œå®Œå…¨æ˜¯ç´¯èµ˜ï¼Œå»ºè®®è€ƒè™‘åˆ é™¤ã€‚</p>
</div>
<div class="ulist">
<ul>
<li>
<p>æœ€ç®€å•æœ‰æ•ˆçš„åŠæ³•æ˜¯åœ¨ Percona Server æˆ–è€… MariaDB ä¸­å…ˆæ‰“å¼€ <code>userstates</code> å˜é‡ï¼Œè®©æœåŠ¡å™¨è¿è¡Œä¸€æ®µæ—¶é—´ï¼Œå†é€šè¿‡æŸ¥è¯¢ <code>INFORMATION_SCHEMA.INDEX_STATISTICS</code> å°±èƒ½æŸ¥åˆ°æ¯ä¸ªç´¢å¼•çš„ä½¿ç”¨é¢‘ç‡ã€‚</p>
</li>
<li>
<p>Percona Toolkit çš„  <code>pt-index-usage</code> è¯»å–æŸ¥è¯¢æ—¥å¿—ï¼Œå¹¶å¯¹æ—¥å¿—ä¸­çš„æŸ¥è¯¢è¿›è¡Œ <code>EXPLAIN</code> æŸ¥æ‰¾ï¼Œç„¶åæ‰“å°å‡ºå…³äºç´¢å¼•å’ŒæŸ¥è¯¢çš„æŠ¥å‘Šã€‚</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_ç´¢å¼•å’Œé”">2.5.11. ç´¢å¼•å’Œé”</h4>
<div class="paragraph">
<p>ç´¢å¼•å¯ä»¥è®©æŸ¥è¯¢é”å®šæ›´å°‘çš„è¡Œã€‚é”å®šè¶…è¿‡éœ€è¦çš„è¡Œä¼šå¢åŠ é”äº‰ç”¨å¹¶å‡å°‘å¹¶å‘æ€§ã€‚</p>
</div>
<div class="paragraph">
<p>InnoDB åªæœ‰åœ¨è®¿é—®è¡Œçš„æ—¶å€™æ‰ä¼šå¯¹å…¶åŠ é”ï¼Œè€Œç´¢å¼•èƒ½å¤Ÿå‡å°‘ InnoDB è®¿é—®çš„è¡Œæ•°ï¼Œä»è€Œå‡å°‘é”çš„æ•°é‡ã€‚</p>
</div>
<div class="paragraph">
<p>InnoDB åœ¨äºŒçº§ç´¢å¼•ä¸Šä½¿ç”¨å…±äº«ï¼ˆè¯»ï¼‰é”ï¼Œä½†è®¿é—®ä¸»é”®ç´¢å¼•éœ€è¦æ’ä»–ï¼ˆå†™ï¼‰é”ã€‚</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ç´¢å¼•æ¡ˆä¾‹å­¦ä¹ ">2.6. ç´¢å¼•æ¡ˆä¾‹å­¦ä¹ </h3>
<div class="paragraph">
<p>ç¬¬ä¸€ä»¶éœ€è¦è€ƒè™‘çš„äº‹æƒ…æ˜¯éœ€è¦ä½¿ç”¨ç´¢å¼•æ¥æ’åºï¼Œè¿˜æ˜¯å…ˆæ£€ç´¢æ•°æ®å†æ’åºã€‚ä½¿ç”¨ç´¢å¼•æ’åºä¼šä¸¥æ ¼é™åˆ¶ç´¢å¼•å’ŒæŸ¥è¯¢çš„è®¾è®¡ã€‚</p>
</div>
<div class="sect3">
<h4 id="_æ”¯æŒå¤šç§è¿‡æ»¤æ¡ä»¶">2.6.1. æ”¯æŒå¤šç§è¿‡æ»¤æ¡ä»¶</h4>
<div class="paragraph">
<p>éœ€è¦çœ‹çœ‹å“ªäº›åˆ—æ‹¥æœ‰å¾ˆå¤šä¸åŒçš„å–å€¼ï¼Œå“ªäº›åˆ—åœ¨ <code>WHERE</code> å­å¥ä¸­å‡ºç°å¾—æœ€é¢‘ç¹ã€‚æœ‰æ›´å¤šä¸åŒå€¼çš„åˆ—ä¸Šåˆ›å»ºç´¢å¼•çš„é€‰æ‹©æ€§ä¼šæ›´å¥½ã€‚</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ç»´æŠ¤ç´¢å¼•å’Œè¡¨">2.7. ç»´æŠ¤ç´¢å¼•å’Œè¡¨</h3>
<div class="paragraph">
<p>ç»´æŠ¤è¡¨æœ‰ä¸‰ä¸ªä¸»è¦ç›®çš„ï¼š</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>æ‰¾åˆ°å¹¶ä¿®å¤æŸåçš„è¡¨ã€‚</p>
</li>
<li>
<p>ç»´æŠ¤å‡†ç¡®çš„ç´¢å¼•ç»Ÿè®¡ä¿¡æ¯ã€‚</p>
</li>
<li>
<p>å‡å°‘ç¢ç‰‡ã€‚</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_æ‰¾åˆ°å¹¶ä¿®å¤æŸåçš„è¡¨">2.7.1. æ‰¾åˆ°å¹¶ä¿®å¤æŸåçš„è¡¨</h4>
<div class="paragraph">
<p>æŸåçš„ç´¢å¼•å¯¼ä¼šå¯¼è‡´æŸ¥è¯¢è¿”å›é”™è¯¯çš„ç»“æœæˆ–è€…è«é¡»æœ‰çš„ä¸»é”®å†²çªç­‰é—®é¢˜ï¼Œä¸¥é‡æ—¶ç”šè‡³è¿˜ä¼šå¯¼è‡´æ•°æ®åº“çš„å´©æºƒã€‚</p>
</div>
<div class="paragraph">
<p><code>CHECK TABLE</code> é€šå¸¸èƒ½å¤Ÿæ‰¾å‡ºå¤§å¤šæ•°è¡¨å’Œç´¢å¼•çš„é”™è¯¯ã€‚</p>
</div>
<div class="paragraph">
<p><code>REPAIR TABLE</code> æ¥ä¿®å¤æŸåçš„è¡¨ã€‚</p>
</div>
<div class="paragraph">
<p>å¦‚æœå­˜å‚¨å¼•æ“ä¸æ”¯æŒï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¸€ä¸ªä¸åšä»»ä½•æ“ä½œçš„ <code>ALTER</code> æ“ä½œæ¥é‡å»ºè¡¨ã€‚</p>
</div>
<div class="paragraph">
<p>å¦‚æœ InnoDB å¼•æ“çš„è¡¨å‡ºç°äº†æŸåï¼Œé‚£ä¸€å®šæ˜¯å‘ç”Ÿäº†ä¸¥é‡çš„é”™è¯¯ï¼Œéœ€è¦ç«‹åˆ»è°ƒæŸ¥ä¸€ä¸‹åŸå› ã€‚</p>
</div>
<div class="paragraph">
<p>å¦‚æœé‡åˆ°æ•°æ®æŸåï¼Œæœ€é‡è¦çš„æ˜¯æ‰¾å‡ºæ˜¯ä»€ä¹ˆå¯¼è‡´äº†æŸåï¼Œè€Œä¸åªæ˜¯ç®€å•åœ°ä¿®å¤ï¼Œå¦åˆ™å¾ˆæœ‰å¯èƒ½è¿˜ä¼šä¸æ–­æŸåã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_æ›´æ–°ç´¢å¼•ç»Ÿè®¡ä¿¡æ¯">2.7.2. æ›´æ–°ç´¢å¼•ç»Ÿè®¡ä¿¡æ¯</h4>
<div class="ulist">
<ul>
<li>
<p><code>records_in_range()</code> é€šè¿‡å‘å­˜å‚¨å¼•æ“ä¼ å…¥ä¸¤ä¸ªè¾¹ç•Œå€¼è·å–åœ¨è¿™ä¸ªèŒƒå›´å¤§æ¦‚æœ‰å¤šå°‘è®°å½•ã€‚</p>
</li>
<li>
<p><code>info()</code> è¿”å›å„ç§ç±»å‹çš„æ•°æ®ï¼ŒåŒ…æ‹¬ç´¢å¼•çš„åŸºæ•°ï¼ˆæ¯ä¸ªé”®å€¼æœ‰å¤šå°‘æ¡è®°å½•ï¼‰ã€‚</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>MySQL ä¼˜åŒ–å™¨ä½¿ç”¨çš„æ˜¯åŸºäºæˆåŠŸçš„æ¨¡å‹ï¼Œè€Œè¡¡é‡æˆæœ¬çš„ä¸»è¦æŒ‡æ ‡å°±æ˜¯ä¸€ä¸ªæŸ¥è¯¢éœ€è¦æ‰«æå¤šå°‘è¡Œã€‚å¦‚æœä¿¡æ¯ä¸å‡†ç¡®ï¼Œä¼˜åŒ–å™¨å¯èƒ½åšå‡ºé”™è¯¯çš„å†³å®šã€‚</p>
</div>
<div class="paragraph">
<p><code>ANALYZE TABLE</code> æ¥é‡æ–°ç”Ÿæˆç»Ÿè®¡ä¿¡æ¯ã€‚</p>
</div>
<div class="paragraph">
<p><code>SHOW INDEX FROM</code> æ¥æŸ¥çœ‹ç´¢å¼•çš„åŸºæ•°ï¼ˆCardinalityï¼‰ã€‚</p>
</div>
<div class="paragraph">
<p>InnoDB çš„ç»Ÿè®¡ä¿¡æ¯å€¼å¾—æ·±å…¥ç ”ç©¶ã€‚ InnoDB å¼•æ“é€šè¿‡æŠ½æ ·çš„æ–¹å¼æ¥è®¡ç®—ç»Ÿè®¡ä¿¡æ¯ï¼Œé¦–å…ˆéšæœºåœ°è¯»å–å°‘é‡çš„ç´¢å¼•é¡µé¢ï¼Œç„¶åä»¥æ­¤ä¸ºæ ·æœ¬è®¡ç®—ç´¢å¼•çš„ç»Ÿè®¡ä¿¡æ¯ã€‚</p>
</div>
<div class="paragraph">
<p>InnoDB ä¼šåœ¨è¡¨é¦–æ¬¡æ‰“å¼€ï¼Œæˆ–è€…æ‰§è¡Œ <code>ANALYZE TABLE</code>ï¼ŒæŠ‘æˆ–è¡¨çš„å¤§å°å‘ç”Ÿéå¸¸å¤§çš„å˜åŒ–æ—¶è®¡ç®—ç´¢å¼•çš„ç»Ÿè®¡ä¿¡æ¯ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_å‡å°‘ç´¢å¼•å’Œæ•°æ®çš„ç¢ç‰‡">2.7.3. å‡å°‘ç´¢å¼•å’Œæ•°æ®çš„ç¢ç‰‡</h4>
<div class="paragraph">
<p>B-Tree ç´¢å¼•å¯èƒ½ä¼šç¢ç‰‡åŒ–ï¼Œè¿™ä¼šé™ä½æŸ¥è¯¢çš„æ•ˆç‡ã€‚ç¢ç‰‡åŒ–çš„ç´¢å¼•å¯èƒ½ä¼šä»¥å¾ˆå·®æˆ–è€…æ— åºçš„æ–¹å¼å­˜å‚¨åœ¨ç£ç›˜ä¸Šã€‚</p>
</div>
<div class="paragraph">
<p>æ ¹æ®è®¾è®¡ï¼ŒB-Tree éœ€è¦éšæœºç£ç›˜è®¿é—®æ‰èƒ½å®šä½åˆ°å¶å­é¡µï¼Œæ‰€ä»¥éšæœºè®¿é—®æ˜¯ä¸å¯é¿å…çš„ã€‚ç„¶è€Œï¼Œå¦‚æœå¶å­é¡µåœ¨ç‰©ç†åˆ†å¸ƒä¸Šæ˜¯é¡ºåºä¸”ç´§å¯†çš„ï¼Œé‚£ä¹ˆæŸ¥è¯¢çš„æ€§èƒ½å°±ä¼šæ›´å¥½ã€‚å¦åˆ™ï¼Œå¯¹äºèŒƒå›´æŸ¥è¯¢ã€ç´¢å¼•è¦†ç›–æ‰«æç­‰æ“ä½œæ¥è¯´ï¼Œé€Ÿåº¦å¯èƒ½ä¼šé™ä½å¾ˆå¤šå€ï¼›å¯¹äºç´¢å¼•è¦†ç›–æ‰«æè¿™ä¸€ç‚¹æ›´åŠ æ˜æ˜¾ã€‚</p>
</div>
<div class="paragraph">
<p>å¦‚æœå¶å­é¡µåœ¨ç‰©ç†åˆ†å¸ƒä¸Šæ˜¯é¡ºåºä¸”ç´§å¯†çš„ï¼Œé‚£ä¹ˆæŸ¥è¯¢çš„æ€§èƒ½å°±ä¼šæ›´å¥½ã€‚</p>
</div>
<div class="paragraph">
<p>æ•°æ®å­˜å‚¨çš„ç¢ç‰‡åŒ–æœ‰ä¸‰ç§ç±»å‹ï¼š</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">è¡Œç¢ç‰‡ï¼ˆRow fragementationï¼‰</dt>
<dd>
<p>æŒ‡çš„æ˜¯æ•°æ®è¡Œè¢«å­˜å‚¨ä¸ºå¤šä¸ªåœ°æ–¹çš„å¤šä¸ªç‰‡æ®µä¸­ã€‚å³ä½¿æŸ¥è¯¢åªä»ç´¢å¼•ä¸­è®¿é—®ä¸€è¡Œè®°å½•ï¼Œè¡Œç¢ç‰‡ä¹Ÿä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚</p>
</dd>
<dt class="hdlist1">è¡Œé—´ç¢ç‰‡ï¼ˆIntra-row fragementationï¼‰</dt>
<dd>
<p>æŒ‡é€»è¾‘ä¸Šé¡ºåºçš„é¡µï¼Œæˆ–è€…è¡Œåœ¨ç£ç›˜ä¸Šä¸æ˜¯é¡ºåºå­˜å‚¨çš„ã€‚å¯¹å…¨è¡¨æ‰«ææˆ–èšç°‡ç´¢å¼•æ‰«æä¹‹ç±»çš„æ“ä½œæœ‰å¾ˆå¤§çš„å½±å“ã€‚</p>
</dd>
<dt class="hdlist1">å‰©ä½™ç©ºé—´ç¢ç‰‡ï¼ˆFree space fragementationï¼‰</dt>
<dd>
<p>æŒ‡æ•°æ®é¡µä¸­æœ‰å¤§é‡çš„ç©ºä½™ç©ºé—´ã€‚ä¼šå¯¼è‡´æœåŠ¡å™¨è¯»å–å¤§é‡ä¸éœ€è¦çš„æ•°æ®ï¼Œä»è€Œé€ æˆæµªè´¹ã€‚</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>å¯¹äº MyISAM è¡¨ï¼Œè¿™ä¸‰ç±»ç¢ç‰‡åŒ–éƒ½å¯èƒ½å‘ç”Ÿã€‚ä½† InnoDB ä¸ä¼šå‡ºç°çŸ­å°çš„è¡Œç¢ç‰‡ï¼›InnoDB ä¼šç§»åŠ¨çŸ­å°çš„è¡Œå¹¶é‡å†™åˆ°ä¸€ä¸ªç‰‡æ®µä¸­ã€‚</p>
</div>
<div class="paragraph">
<p><code>OPTIMIZE TABLE</code> æˆ–è€…å¯¼å‡ºå†å¯¼å…¥çš„æ–¹å¼é‡æ–°æ•´ç†æ•°æ®ã€‚</p>
</div>
<div class="paragraph">
<p>å¯¹ä¸æ”¯æŒ <code>OPTIMIZE TABLE</code> çš„å­˜å‚¨å¼•æ“ï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸ªä¸åšä»»ä½•æ“ä½œçš„ <code>ALTER TABLE</code> æ“ä½œæ¥é‡å»ºè¡¨ã€‚åªéœ€è¦å°†è¡¨çš„å­˜å‚¨å¼•æ“ä¿®æ”¹ä¸ºå½“å‰çš„å¼•æ“å³å¯ï¼š</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">ALTER</span> <span class="type">TABLE</span> &lt;<span class="type">table</span>&gt; <span class="directive">ENGINE</span>=&lt;<span class="directive">engine</span>&gt;;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_æ€»ç»“_2">2.8. æ€»ç»“</h3>
<div class="paragraph">
<p>åœ¨é€‰æ‹©ç´¢å¼•å’Œç¼–å†™åˆ©ç”¨è¿™äº›ç´¢å¼•çš„æŸ¥è¯¢æ—¶ï¼Œæœ‰ä¸‰ä¸ªåŸåˆ™å§‹ç»ˆéœ€è¦è®°ä½ï¼š</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>å•è¡Œè®¿é—®æ—¶å¾ˆæ…¢çš„ã€‚æœ€å¥½è¯»å–çš„å—ä¸­èƒ½åŒ…å«å°½å¯èƒ½å¤šæ‰€éœ€è¦çš„è¡Œã€‚</p>
</li>
<li>
<p>æŒ‰é¡ºåºè®¿é—®èŒƒå›´æ•°æ®æ˜¯å¾ˆå¿«çš„ã€‚</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>é¡ºåº I/O ä¸éœ€è¦å¤šæ¬¡ç£ç›˜å¯»é“ï¼Œæ‰€ä»¥æ¯”éšæœº I/O è¦å¿«å¾ˆå¤š</p>
</li>
<li>
<p>å¦‚æœæœåŠ¡å™¨èƒ½å¤ŸæŒ‰éœ€è¦é¡ºåºè¯»å–æ•°æ®ï¼Œé‚£ä¹ˆä¹…ä¸å†éœ€è¦é¢å¤–çš„æ’åºæ“ä½œï¼Œå¹¶ä¸” <code>GROUP BY</code> æŸ¥è¯¢ä¹Ÿæ— é¡»å†åšæ’åºå’Œå°†è¡ŒæŒ‰ç»„è¿›è¡Œèšåˆè®¡ç®—äº†ã€‚</p>
</li>
</ol>
</div>
</li>
<li>
<p>ç´¢å¼•è¦†ç›–æŸ¥è¯¢å¾ˆå¿«ã€‚</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>è¿™ä¸ä¸Šå®Œæåˆ°çš„ <a href="#three-star-system">â€œä¸‰æ˜Ÿç´¢å¼•â€</a> æ˜¯ä¸€è‡´çš„ã€‚</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–">3. æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–</h2>
<div class="sectionbody">
<div class="paragraph">
<p>æŸ¥è¯¢ä¼˜åŒ–ã€ç´¢å¼•ä¼˜åŒ–ã€åº“è¡¨ç»“æ„ä¼˜åŒ–éœ€è¦é½å¤´å¹¶è¿›ï¼Œä¸€ä¸ªä¸è½ã€‚</p>
</div>
<div class="sect2">
<h3 id="_ä¸ºä»€ä¹ˆæŸ¥è¯¢é€Ÿåº¦ä¼šæ…¢">3.1. ä¸ºä»€ä¹ˆæŸ¥è¯¢é€Ÿåº¦ä¼šæ…¢ï¼Ÿ</h3>
<div class="paragraph">
<p>çœŸæ­£é‡è¦çš„æ˜¯å“åº”æ—¶é—´ã€‚</p>
</div>
<div class="paragraph">
<p>æŸ¥è¯¢çš„ç”Ÿå‘½å‘¨æœŸå¤§è‡´å¯ä»¥æŒ‰ç…§é¡ºåºæ¥çœ‹ï¼šä»å®¢æˆ·ç«¯ï¼Œåˆ°æœåŠ¡å™¨ï¼Œç„¶ååœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œè§£æï¼Œç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼Œæ‰§è¡Œï¼Œå¹¶è¿”å›ç»“æœç»™å®¢æˆ·ç«¯ã€‚åœ¨å®Œæˆè¿™äº›ä»»åŠ¡çš„æ—¶å€™ï¼ŒæŸ¥è¯¢éœ€è¦åœ¨ä¸åŒçš„åœ°æ–¹èŠ±è´¹æ—¶é—´ï¼ŒåŒ…æ‹¬ç½‘ç»œï¼ŒCPU è®¡ç®—ï¼Œç”Ÿæˆç»Ÿè®¡ä¿¡æ¯å’Œæ‰§è¡Œè®¡åˆ’ã€é”ç­‰å¾…ï¼ˆäº’æ–¥ç­‰å¾…ï¼‰ç­‰æ“ä½œï¼Œå°¤å…¶æ˜¯å‘åœ°åŸå­˜å‚¨å¼•æ“æ£€ç´¢æ•°æ®çš„è°ƒç”¨ï¼Œè¿™äº›è°ƒç”¨éœ€è¦åœ¨å†…å­˜æ“ä½œã€CPU æ“ä½œå’Œå†…å­˜ä¸è¶³æ—¶å¯¼è‡´çš„ I/O æ“ä½œä¸Šæ¶ˆè€—æ—¶é—´ã€‚</p>
</div>
<div class="paragraph">
<p>äº†è§£æŸ¥è¯¢çš„ç”Ÿå‘½å‘¨æœŸã€æ¸…æ¥šæŸ¥è¯¢çš„æ—¶é—´æ¶ˆè€—æƒ…å†µå¯¹äºä¼˜åŒ–æŸ¥è¯¢æœ‰å¾ˆå¤§çš„æ„ä¹‰ã€‚</p>
</div>
</div>
<div class="sect2">
<h3 id="_æ…¢æŸ¥è¯¢åŸºç¡€_ä¼˜åŒ–æ•°æ®è®¿é—®">3.2. æ…¢æŸ¥è¯¢åŸºç¡€ï¼šä¼˜åŒ–æ•°æ®è®¿é—®</h3>
<div class="paragraph">
<p>æŸ¥è¯¢æ€§èƒ½ä½ä¸‹æœ€åŸºæœ¬çš„åŸå› æ˜¯è®¿é—®çš„æ•°æ®å¤ªå¤šã€‚</p>
</div>
<div class="paragraph">
<p>å¯¹äºä½æ•ˆçš„æŸ¥è¯¢ï¼Œä¸‹é¢ä¸¤æ­¥åˆ†ææ€»æ˜¯æœ‰æ•ˆçš„ï¼š</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>ç¡®è®¤åº”ç”¨ç¨‹åºæ˜¯å¦åœ¨æ£€ç´¢å¤§é‡è¶…è¿‡éœ€è¦çš„æ•°æ®ã€‚è®¿é—®äº†å¤ªå¤šçš„è¡Œï¼Œæœ‰æ—¶ä¹Ÿå¯èƒ½è®¿é—®å¤ªå¤šçš„åˆ—ã€‚</p>
</li>
<li>
<p>ç¡®è®¤ MySQL æœåŠ¡å™¨å±‚æ˜¯å¦åœ¨åˆ†æå¤§é‡è¶…è¿‡éœ€è¦çš„æ•°æ®è¡Œã€‚</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>æŸ¥è¯¢å¤§é‡ä¸éœ€è¦çš„æ•°æ®çš„å…¸å‹æ¡ˆä¾‹ï¼š</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>æŸ¥è¯¢ä¸éœ€è¦çš„è®°å½•</p>
<div class="ulist">
<ul>
<li>
<p>æœ€ç®€å•æœ‰æ•ˆçš„è§£å†³æ–¹æ³•å°±æ˜¯åœ¨è¿™æ ·çš„æŸ¥è¯¢åé¢åŠ ä¸Š <code>LIMIT</code>ã€‚</p>
</li>
</ul>
</div>
</li>
<li>
<p>å¤šè¡¨å…³è”æ—¶è¿”å›å…¨éƒ¨åˆ—</p>
</li>
<li>
<p>æ€»æ˜¯å–å‡ºå…¨éƒ¨åˆ—</p>
<div class="ulist">
<ul>
<li>
<p>æ¯æ¬¡çœ‹åˆ° <code>SELECT *</code> æ—¶éƒ½éœ€è¦ç”¨æ€€ç–‘çš„çœ¼å…‰å®¡è§†ï¼Œæ˜¯ä¸æ˜¯çœŸçš„éœ€è¦è¿”å›å…¨éƒ¨çš„åˆ—ï¼</p>
</li>
</ul>
</div>
</li>
<li>
<p>é‡å¤æŸ¥è¯¢ç›¸åŒçš„æ•°æ®</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>æœ€ç®€å•çš„è¡¡é‡æŸ¥è¯¢å¼€é”€çš„ä¸‰ä¸ªæŒ‡æ ‡å¦‚ä¸‹ï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>å“åº”æ—¶é—´</p>
</li>
<li>
<p>æ‰«æçš„è¡Œæ•°</p>
</li>
<li>
<p>è¿”å›çš„è¡Œæ•°</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>è¿™ä¸‰ä¸ªæŒ‡æ ‡éƒ½ä¼šè®°å½•åˆ° MySQL çš„æ…¢æ—¥å¿—ä¸­ï¼Œæ‰€ä»¥æ£€æŸ¥æ…¢æ—¥å¿—è®°å½•æ˜¯æ‰¾å‡ºæ‰«æè¡Œæ•°è¿‡å¤šçš„æŸ¥è¯¢çš„å¥½åŠæ³•ã€‚</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
å¯ä»¥å†™ä¸€ä¸ªè„šæœ¬æ¥åˆ†æ MySQL çš„æ—¥å¿—ï¼Œè¿›è€Œæ‰¾å‡ºæ¯”è¾ƒæ…¢çš„æŸ¥è¯¢ã€‚
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">å“åº”æ—¶é—´</dt>
<dd>
<p>å“åº”æ—¶é—´åªæ˜¯è¡¨é¢ä¸Šçš„ä¸€ä¸ªå€¼ï¼›ä½†ï¼Œå“åº”æ—¶é—´ä»ç„¶æ˜¯æœ€é‡è¦çš„æŒ‡æ ‡ã€‚</p>
<div class="paragraph">
<p>å“åº”æ—¶é—´æ˜¯ä¸¤éƒ¨åˆ†ä¹‹å’Œï¼šæœåŠ¡æ—¶é—´å’Œæ’é˜Ÿæ—¶é—´ã€‚</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">æœåŠ¡æ—¶é—´</dt>
<dd>
<p>æŒ‡æ•°æ®åº“å¤„ç†è¿™ä¸ªæŸ¥è¯¢çœŸæ­£èŠ±äº†å¤šé•¿æ—¶é—´ã€‚</p>
</dd>
<dt class="hdlist1">æ’é˜Ÿæ—¶é—´</dt>
<dd>
<p>æŒ‡æœåŠ¡å™¨å› ä¸ºç­‰å¾…æŸäº›èµ„æºè€Œæ²¡æœ‰çœŸæ­£æ‰§è¡ŒæŸ¥è¯¢çš„æ—¶é—´&#8212;&#8203;å¯èƒ½æ˜¯ç­‰ I/O æ“ä½œå®Œæˆï¼Œä¹Ÿå¯èƒ½æ˜¯ç­‰å¾…è¡Œé”ç­‰å¾…ã€‚</p>
<div class="paragraph">
<p>ä¸€èˆ¬æœ€å¸¸è§å’Œé‡è¦çš„ç­‰å¾…æ˜¯ I/O å’Œé”ç­‰å¾…ã€‚</p>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://book.douban.com/subject/26419771/">æ•°æ®åº“ç´¢å¼•è®¾è®¡ä¸ä¼˜åŒ–</a> ä¸€ä¹¦è®²è¿°äº†ä¸€ç§ä¼°ç®—æŸ¥è¯¢çš„å“åº”æ—¶é—´æ–¹æ³•ï¼šå¿«é€Ÿä¸Šé™ä¼°è®¡ã€‚æ¦‚æ‹¬åœ°è¯´ï¼Œäº†è§£è¿™ä¸ªæŸ¥è¯¢éœ€è¦å“ªäº›ç´¢å¼•ä»¥åŠå®ƒçš„æ‰§è¡Œè®¡åˆ’æ˜¯ä»€ä¹ˆï¼Œç„¶åè®¡ç®—å¤§æ¦‚éœ€è¦å¤šå°‘ä¸ªé¡ºåºå’Œéšæœº I/Oï¼Œå†ç”¨å…¶ä¹˜ä»¥åœ¨å…·ä½“ç¡¬ä»¶æ¡ä»¶ä¸‹ä¸€æ¬¡ I/O çš„æ¶ˆè€—æ—¶é—´ã€‚æœ€åæŠŠè¿™äº›æ¶ˆè€—éƒ½åŠ èµ·æ¥ï¼Œå°±å¯ä»¥è·å¾—ä¸€ä¸ªå¤§æ¦‚å‚è€ƒå€¼æ¥åˆ¤æ–­å½“å‰å“åº”æ—¶é—´æ˜¯ä¸æ˜¯ä¸€ä¸ªåˆç†çš„å€¼ã€‚</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">æ‰«æçš„è¡Œæ•°å’Œè¿”å›çš„è¡Œæ•°</dt>
<dd>
<p>å¹¶ä¸æ˜¯æ‰€æœ‰çš„è¡Œçš„è®¿é—®ä»£ä»·æ˜¯ç›¸åŒçš„ã€‚è¾ƒçŸ­çš„è¡Œçš„è®¿é—®é€Ÿåº¦æ›´å¿«ï¼Œå†…å­˜ä¸­çš„è¡Œä¹Ÿæ¯”ç£ç›˜ä¸­çš„è¡Œçš„è®¿é—®é€Ÿåº¦è¦å¿«å¾—å¤šã€‚</p>
<div class="paragraph">
<p>ç†æƒ³æƒ…å†µä¸‹æ‰«æçš„è¡Œæ•°å’Œè¿”å›çš„è¡Œæ•°åº”è¯¥æ˜¯ç›¸åŒçš„ã€‚æ‰«æçš„è¡Œæ•°å¯¹è¿”å›çš„è¡Œæ•°æ¯”ç‡é€šå¸¸å¾ˆå°ï¼Œä¸€èˆ¬åœ¨ 1:1 å’Œ 10:1 ä¹‹é—´ã€‚</p>
</div>
</dd>
<dt class="hdlist1">æ‰«æçš„è¡Œæ•°å’Œè®¿é—®ç±»å‹</dt>
<dd>
<p>åœ¨è¯„ä¼°æŸ¥è¯¢å¼€é”€çš„æ—¶å€™ï¼Œéœ€è¦è€ƒè™‘ä¸€ä¸‹ä»è¡¨ä¸­æ‰¾åˆ°æŸä¸€è¡Œæ•°æ®çš„æˆæœ¬ã€‚</p>
<div class="paragraph">
<p>åœ¨ <code>EXPLAIN</code> è¯­å¥ä¸­çš„ <code>type</code> åˆ—ååº”äº†è®¿é—®ç±»å‹ã€‚è®¿é—®ç±»å‹æœ‰å¾ˆå¤šç§ï¼Œä»å…¨è¡¨æ‰«æåˆ°ç´¢å¼•æ‰«æã€èŒƒå›´æ‰«æã€å”¯ä¸€ç´¢å¼•æŸ¥è¯¢ã€å¸¸æ•°å¼•ç”¨ç­‰ã€‚</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>å¦‚æœæŸ¥è¯¢æ²¡æœ‰åŠæ³•æ‰¾åˆ°åˆé€‚çš„è®¿é—®ç±»å‹ï¼Œé‚£ä¹ˆè§£å†³çš„æœ€å¥½åŠæ³•é€šå¸¸å°±æ˜¯å¢åŠ ä¸€ä¸ªåˆé€‚çš„ç´¢å¼•ã€‚ç´¢å¼•è®© MySQL ä»¥æœ€é«˜æ•ˆã€æ‰«æè¡Œæ•°æœ€å°‘çš„æ–¹å¼æ‰¾åˆ°éœ€è¦çš„è®°å½•ã€‚</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">USE sakila;

EXPLAIN
<span class="class">SELECT</span> *
<span class="keyword">FROM</span> film_actor
<span class="keyword">WHERE</span> film_id = <span class="integer">1</span>;

mysql&gt; EXPLAIN <span class="class">SELECT</span> * <span class="keyword">FROM</span> film_actor <span class="keyword">WHERE</span> film_id = <span class="integer">1</span> <span class="error">\</span>G <i class="conum" data-value="1"></i><b>(1)</b>
*************************** <span class="error">1</span>. <span class="type">row</span> ***************************
           id: <span class="integer">1</span>
  select_type: SIMPLE
        <span class="type">table</span>: film_actor
   partitions: <span class="predefined-constant">NULL</span>
         type: ref
possible_keys: idx_fk_film_id
          <span class="type">key</span>: idx_fk_film_id
      key_len: <span class="integer">2</span>
          ref: const
         rows: <span class="integer">10</span>
     filtered: <span class="float">100.00</span>
        Extra: <span class="predefined-constant">NULL</span>
<span class="integer">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="class">set</span>, <span class="integer">1</span> warning (<span class="float">0.00</span> sec)

<span class="class">ALTER</span> <span class="type">TABLE</span> film_actor
  <span class="class">DROP</span> <span class="directive">FOREIGN</span> <span class="type">KEY</span> fk_film_actor_film;

<span class="class">ALTER</span> <span class="type">TABLE</span> film_actor
  <span class="class">DROP</span> <span class="type">KEY</span> idx_fk_film_id;

EXPLAIN
<span class="class">SELECT</span> *
<span class="keyword">FROM</span> film_actor
<span class="keyword">WHERE</span> film_id = <span class="integer">1</span>;

mysql&gt; EXPLAIN <span class="class">SELECT</span> * <span class="keyword">FROM</span> film_actor <span class="keyword">WHERE</span> film_id = <span class="integer">1</span> <span class="error">\</span>G <i class="conum" data-value="2"></i><b>(2)</b>
*************************** <span class="error">1</span>. <span class="type">row</span> ***************************
           id: <span class="integer">1</span>
  select_type: SIMPLE
        <span class="type">table</span>: film_actor
   partitions: <span class="predefined-constant">NULL</span>
         type: <span class="keyword">ALL</span>
possible_keys: <span class="predefined-constant">NULL</span>
          <span class="type">key</span>: <span class="predefined-constant">NULL</span>
      key_len: <span class="predefined-constant">NULL</span>
          ref: <span class="predefined-constant">NULL</span>
         rows: <span class="integer">5462</span>
     filtered: <span class="float">10.00</span>
        Extra: <span class="keyword">Using</span> <span class="keyword">where</span>
<span class="integer">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="class">set</span>, <span class="integer">1</span> warning (<span class="float">0.00</span> sec)</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>ä»ä¸‹é¢çš„ç»“æœä¹Ÿèƒ½çœ‹å‡ºï¼ŒMySQL åœ¨ç´¢å¼• idx_fk_film_id ä¸Šä½¿ç”¨äº† <code>ref</code> è®¿é—®ç±»å‹æ¥æ‰§è¡Œ SQLã€‚</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>åˆ é™¤ç´¢å¼•åï¼Œè®¿é—®ç±»å‹å˜æˆäº†ä¸€ä¸ªå…¨è¡¨æ‰«æï¼ˆ <code>ALL</code> ï¼‰ï¼Œç°åœ¨ MySQL é¢„ä¼°éœ€è¦æ‰«æ 5073 æ¡è®°å½•æ¥å®Œæˆè¿™ä¸ªæŸ¥è¯¢ã€‚ <code>Using where</code> è¡¨ç¤º MySQL å°†é€šè¿‡ <code>WHERE</code> æ¡ä»¶æ¥ç­›é€‰å­˜å‚¨å¼•æ“è¿”å›çš„è®°å½•ã€‚</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>ä¸€èˆ¬ MySQL èƒ½å¤Ÿä½¿ç”¨å¦‚ä¸‹ä¸‰ç§æ–¹å¼åº”ç”¨ <code>WHERE</code> æ¡ä»¶ï¼Œä»å¥½åˆ°åä»¥æ­¤ä¸ºï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>åœ¨ç´¢å¼•ä¸­ä½¿ç”¨ <code>WHERE</code> æ¡ä»¶æ¥è¿‡æ»¤ä¸åŒ¹é…çš„è®°å½•ã€‚è¿™æ˜¯åœ¨å­˜å‚¨å¼•æ“å±‚å®Œæˆçš„ã€‚</p>
</li>
<li>
<p>ä½¿ç”¨ç´¢å¼•è¦†ç›–æ‰«æï¼ˆåœ¨ <code>Extra</code> åˆ—ä¸­å‡ºç°äº† <code>Using index</code>ï¼‰æ¥è¿”å›è®°å½•ï¼Œç›´æ¥ä»ç´¢å¼•ä¸­è¿‡æ»¤æ‰ä¸éœ€è¦çš„è®°å½•å¹¶è¿”å›å‘½ä¸­çš„ç»“æœã€‚è¿™æ˜¯åœ¨ MySQL æœåŠ¡å™¨å±‚å®Œæˆçš„ï¼Œä½†æ— é¡»å†å›è¡¨æŸ¥è¯¢è®°å½•ã€‚</p>
</li>
<li>
<p>ä»æ•°æ®è¡¨ä¸­è¿”å›æ•°æ®ï¼Œç„¶åè¿‡æ»¤æ‰ä¸æ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼ˆåœ¨ <code>Extra</code> åˆ—ä¸­å‡ºç° <code>Using Where</code>ï¼‰ã€‚è¿™åœ¨ MySQL æœåŠ¡å™¨å±‚å®Œæˆï¼ŒMySQL éœ€è¦å…ˆä»æ•°æ®è¡¨è¯»å‡ºè®°å½•ç„¶åè¿‡æ»¤ã€‚</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>å¥½çš„ç´¢å¼•å¯ä»¥è®©æŸ¥è¯¢ä½¿ç”¨åˆé€‚çš„è®¿é—®ç±»å‹ï¼Œå°½å¯èƒ½åœ°å€¼æ‰«æéœ€è¦çš„æ•°æ®è¡Œã€‚ä½†ä¹Ÿä¸æ˜¯è¯´å¢åŠ ç´¢å¼•å°±èƒ½è®©æ‰«æçš„è¡Œæ•°ç­‰äºè¿”å›çš„è¡Œæ•°ã€‚ä¾‹å¦‚ <code>COUNT(*)</code> æŸ¥è¯¢ã€‚</p>
</div>
<div class="paragraph">
<p>ä¸å¹¸çš„æ˜¯ï¼ŒMySQL ä¸ä¼šå‘Šè¯‰æˆ‘ä»¬ç”Ÿæˆç»“æœå®é™…ä¸Šéœ€è¦æ‰«æå¤šå°‘è¡Œæ•°æ®ï¼Œè€Œåªä¼šå‘Šè¯‰æˆ‘ä»¬ç”Ÿæˆç»“æœæ—¶ä¸€å…±æ‰«æäº†å¤šå°‘è¡Œæ•°æ®ã€‚æ‰«æçš„è¡Œæ•°ä¸­çš„å¤§éƒ¨åˆ†éƒ½å¾ˆå¯èƒ½æ˜¯è¢« <code>WHERE</code> æ¡ä»¶è¿‡æ»¤æ‰çš„ï¼Œå¯¹æœ€ç»ˆçš„ç»“æœé›†å¹¶æ²¡æœ‰è´¡çŒ®ã€‚ç†è§£ä¸€ä¸ªæŸ¥è¯¢éœ€è¦æ‰«æå¤šå°‘è¡Œå’Œå®é™…éœ€è¦ä½¿ç”¨çš„è¡Œæ•°éœ€è¦å…ˆå»ç†è§£è¿™ä¸ªæŸ¥è¯¢èƒŒåçš„é€»è¾‘å’Œæ€æƒ³ã€‚</p>
</div>
<div class="paragraph">
<p>å¦‚æœå‘ç°æŸ¥è¯¢éœ€è¦æ‰«æå¤§é‡çš„æ•°æ®ä½†åªè¿”å›å°‘æ•°çš„è¡Œï¼Œé‚£ä¹ˆé€šå¸¸å¯ä»¥å°è¯•ä¸‹é¢çš„æŠ€å·§å»ä¼˜åŒ–å®ƒï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ä½¿ç”¨ç´¢å¼•è¦†ç›–æ‰«æï¼ŒæŠŠæ‰€æœ‰éœ€è¦ç”¨åˆ°çš„åˆ—éƒ½æ”¾åˆ°ç´¢å¼•ä¸­ï¼Œè¿™æ ·å­˜å‚¨å¼•æ“æ— é¡»å›è¡¨è·å–å¯¹åº”è¡Œå°±å¯ä»¥è¿”å›ç»“æœäº†ã€‚</p>
</li>
<li>
<p>æ”¹å˜åº“è¡¨ç»“æ„ã€‚ä¾‹å¦‚ä½¿ç”¨å•ç‹¬çš„æ±‡æ€»è¡¨ã€‚</p>
</li>
<li>
<p>é‡å†™è¿™ä¸ªå¤æ‚çš„æŸ¥è¯¢ï¼Œè®© MySQL ä¼˜åŒ–å™¨èƒ½å¤Ÿä»¥æ›´ä¼˜åŒ–çš„æ–¹å¼æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ã€‚</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_é‡æ„æŸ¥è¯¢çš„æ–¹å¼">3.3. é‡æ„æŸ¥è¯¢çš„æ–¹å¼</h3>
<div class="paragraph">
<p>åœ¨ä¼˜åŒ–æœ‰é—®é¢˜çš„æŸ¥è¯¢æ—¶ï¼Œç›®æ ‡åº”è¯¥æ˜¯æ‰¾åˆ°ä¸€ä¸ªæ›´ä¼˜çš„æ–¹æ³•è·å–å®é™…éœ€è¦çš„ç»“æœ&#8212;&#8203;è€Œä¸ä¸€å®šæ€»æ˜¯éœ€è¦ä» MySQL è·å–ä¸€æ¨¡ä¸€æ ·çš„ç»“æœé›†ã€‚</p>
</div>
<div class="sect3">
<h4 id="_ä¸€ä¸ªå¤æ‚æŸ¥è¯¢è¿˜æ˜¯å¤šä¸ªç®€å•æŸ¥è¯¢">3.3.1. ä¸€ä¸ªå¤æ‚æŸ¥è¯¢è¿˜æ˜¯å¤šä¸ªç®€å•æŸ¥è¯¢</h4>
<div class="paragraph">
<p>è®¾è®¡æŸ¥è¯¢çš„æ—¶å€™ä¸€ä¸ªéœ€è¦è€ƒè™‘çš„é‡è¦é—®é¢˜æ˜¯ï¼Œæ˜¯å¦éœ€è¦å°†ä¸€ä¸ªå¤æ‚çš„æŸ¥è¯¢åˆ†æˆå¤šä¸ªç®€å•çš„æŸ¥è¯¢ã€‚</p>
</div>
<div class="paragraph">
<p>MySQL ä»è®¾è®¡ä¸Šè®©è¿æ¥å’Œæ–­å¼€è¿æ¥éƒ½ å¾ˆè½»é‡çº§ï¼Œåœ¨è¿”å›ä¸€ä¸ªå°çš„æŸ¥è¯¢ç»“æœæ–¹é¢å¾ˆé«˜æ•ˆã€‚</p>
</div>
<div class="paragraph">
<p>MySQL å†…éƒ¨æ¯ç§’èƒ½å¤Ÿæ‰«æå†…å­˜ä¸­ä¸Šç™¾ä¸‡è¡Œæ•°æ®ã€‚</p>
</div>
<div class="paragraph">
<p>åœ¨åº”ç”¨è®¾è®¡çš„æ—¶å€™ï¼Œå¦‚æœä¸€ä¸ªæŸ¥è¯¢èƒ½å¤Ÿèƒœä»»æ—¶è¿˜å†™æˆå¤šä¸ªç‹¬ç«‹æŸ¥è¯¢æ˜¯ä¸æ˜æ™ºçš„ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_åˆ‡åˆ†æŸ¥è¯¢">3.3.2. åˆ‡åˆ†æŸ¥è¯¢</h4>
<div class="paragraph">
<p>æœ‰æ—¶å€™å¯¹äºä¸€ä¸ªå¤§æŸ¥è¯¢æˆ‘ä»¬éœ€è¦â€œåˆ†è€Œæ²»ä¹‹â€ï¼Œå°†å¤§æŸ¥è¯¢åˆ‡åˆ†æˆå°æŸ¥è¯¢ï¼Œæ¯ä¸ªæŸ¥è¯¢åŠŸèƒ½å®Œå…¨ä¸€æ ·ï¼Œåªå®Œæˆä¸€å°éƒ¨åˆ†ï¼Œæ¯æ¬¡åªè¿”å›ä¸€å°éƒ¨åˆ†æŸ¥è¯¢ç»“æœã€‚ä¾‹å¦‚åˆ é™¤æ—§çš„æ•°æ®ã€‚</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
è¿™ä¸ªåŸåˆ™ä¸ä»…ä»…é€‚ç”¨äºæ•°æ®åº“ï¼Œåœ¨å¾ˆå¤šåœ°æ–¹éƒ½é€‚ç”¨ã€‚
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_åˆ†è§£å…³è”æŸ¥è¯¢">3.3.3. åˆ†è§£å…³è”æŸ¥è¯¢</h4>
<div class="paragraph">
<p>å¯ä»¥å¯¹æ¯ä¸€ä¸ªè¡¨è¿›è¡Œä¸€æ¬¡å•è¡¨æŸ¥è¯¢ï¼Œç„¶åå°†ç»“æœåœ¨åº”ç”¨ç¨‹åºä¸­è¿›è¡Œå…³è”ã€‚</p>
</div>
<div class="paragraph">
<p>ç”¨åˆ†è§£å…³è”æŸ¥è¯¢çš„æ–¹å¼é‡æ„æŸ¥è¯¢æœ‰å¦‚ä¸‹çš„ä¼˜åŠ¿ï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>è®©ç¼“å­˜çš„æ•ˆç‡æ›´é«˜ã€‚</p>
</li>
<li>
<p>å°†æŸ¥è¯¢åˆ†è§£åï¼Œæ‰§è¡Œå•ä¸ªæŸ¥è¯¢å¯ä»¥å‡å°‘é”çš„ç«äº‰ã€‚</p>
</li>
<li>
<p>åœ¨åº”ç”¨å±‚åšå…³è”ï¼Œå¯ä»¥æ›´å®¹æ˜“å¯¹æ•°æ®åº“è¿›è¡Œæ‹†åˆ†ï¼Œæ›´å®¹æ˜“åšåˆ°é«˜æ€§èƒ½å’Œå¯æ‰©å±•ã€‚</p>
</li>
<li>
<p>æŸ¥è¯¢æœ¬èº«æ•ˆç‡ä¹Ÿå¯èƒ½ä¼šæœ‰æ‰€æå‡ã€‚</p>
</li>
<li>
<p>å¯ä»¥å‡å°‘å†—ä½™è®°å½•çš„æŸ¥è¯¢ã€‚</p>
</li>
<li>
<p>è¿™æ ·åšç›¸å½“äºåœ¨åº”ç”¨ä¸­å®ç°äº†å“ˆå¸Œå…³è”ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ MySQL çš„åµŒå¥—å¾ªç¯å…³è”ã€‚æŸäº›åœºæ™¯å“ˆå¸Œå…³è”çš„æ•ˆç‡è¦é«˜å¾ˆå¤šã€‚</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_æŸ¥è¯¢æ‰§è¡Œçš„åŸºç¡€">3.4. æŸ¥è¯¢æ‰§è¡Œçš„åŸºç¡€</h3>
<div class="paragraph">
<p>å½“å¸Œæœ› MySQL èƒ½å¤Ÿä»¥æ›´é«˜çš„æ€§èƒ½è¿è¡ŒæŸ¥è¯¢æ—¶ï¼Œæœ€å¥½çš„åŠæ³•å°±æ˜¯å¼„æ¸…æ¥š MySQL æ˜¯å¦‚ä½•ä¼˜åŒ–å’Œæ‰§è¡ŒæŸ¥è¯¢çš„ã€‚</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/query_execution_path.png" alt="æŸ¥è¯¢æ‰§è¡Œè·¯å¾„" width="95%">
</div>
<div class="title">å›¾ 36. æŸ¥è¯¢æ‰§è¡Œè·¯å¾„</div>
</div>
<div class="paragraph">
<p>å½“æˆ‘ä»¬å‘ MySQL å‘é€ä¸€ä¸ªè¯·æ±‚çš„æ—¶å€™ï¼Œ MySQL æ‰§è¡Œå¦‚ä¸‹æ“ä½œï¼š</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>å®¢æˆ·ç«¯å‘é€ä¸€æ¡æŸ¥è¯¢ç»™æœåŠ¡å™¨ã€‚</p>
</li>
<li>
<p>æœåŠ¡å™¨å…ˆæ£€æŸ¥æŸ¥è¯¢ç¼“å­˜ï¼Œå¦‚æœå‘½ä¸­äº†ç¼“å­˜ï¼Œåˆ™ç«‹åˆ»è¿”å›å­˜å‚¨åœ¨ç¼“å­˜ä¸­çš„ç»“æœã€‚å¦åˆ™è¿›å…¥ä¸‹ä¸€é˜¶æ®µã€‚</p>
</li>
<li>
<p>æœåŠ¡å™¨è¿›è¡Œ SQL è§£æã€é¢„å¤„ç†ï¼Œå†ç”±ä¼˜åŒ–å™¨ç”Ÿæˆå¯¹åº”çš„æ‰§è¡Œè®¡åˆ’ã€‚</p>
</li>
<li>
<p>MySQL æ ¹æ®ä¼˜åŒ–å™¨ç”Ÿæˆçš„æ‰§è¡Œè®¡åˆ’ï¼Œè°ƒç”¨å­˜å‚¨å¼•æ“çš„ API æ¥æ‰§è¡ŒæŸ¥è¯¢ã€‚</p>
</li>
<li>
<p>å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_mysql_å®¢æˆ·ç«¯_æœåŠ¡å™¨é€šä¿¡åè®®">3.4.1. MySQL å®¢æˆ·ç«¯/æœåŠ¡å™¨é€šä¿¡åè®®</h4>
<div class="paragraph">
<p>ä¸€èˆ¬æ¥è¯´ï¼Œä¸éœ€è¦å»ç†è§£ MySQL é€šä¿¡åè®®çš„å†…éƒ¨å®ç°ç»†èŠ‚ï¼Œåªéœ€è¦å¤§è‡´ç†è§£é€šä¿¡åè®®æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚MySQL å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡å¿ƒæ„æ˜¯â€œåŠåŒå·¥â€çš„ï¼Œè¿™æ„å‘³ç€ï¼Œåœ¨ä»»ä½•ä¸€ä¸ªæ—¶åˆ»ï¼Œè¦ä¹ˆæ˜¯ç”±æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å‘é€æ•°æ®ï¼Œè¦ä¹ˆæ˜¯ç”±å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼Œè¿™ä¸¤ä¸ªåŠ¨ä½œä¸èƒ½åŒæ—¶å‘ç”Ÿã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æ— æ³•ä¹Ÿæ— é¡»å°†ä¸€ä¸ªæ¶ˆæ¯åˆ‡åˆ†æˆå°å—ç‹¬ç«‹æ¥å‘é€ã€‚</p>
</div>
<div class="paragraph">
<p>é€šä¿¡ç®€å•ï¼Œä¹Ÿæœ‰å¾ˆå¤šé™åˆ¶ã€‚ä¸€ä¸ªæ˜æ˜¾çš„é™åˆ¶æ˜¯ï¼Œè¿™æ„å‘³ç€æ²¡æ³•è¿›è¡Œæµé‡æ§åˆ¶ã€‚ä¸€æ—¦ä¸€æ®µå¼€å§‹å‘é€æ¶ˆæ¯ï¼Œå¦ä¸€æ®µè¦æ¥æ”¶å®Œæ•´ä¸ªæ¶ˆæ¯æ‰èƒ½å“åº”å®ƒã€‚</p>
</div>
<div class="paragraph">
<p>å®¢æˆ·ç«¯ç”¨ä¸€ä¸ªç‹¬ç«‹çš„æ•°æ®åŒ…å°†æŸ¥è¯¢ä¼ ç»™æœåŠ¡å™¨ã€‚</p>
</div>
<div class="paragraph">
<p>ç›¸åçš„ï¼Œä¸€èˆ¬æœåŠ¡å™¨å“åº”ç»™ç”¨æˆ·çš„æ•°æ®é€šå¸¸å¾ˆå¤šï¼Œç”±å¤šä¸ªæ•°æ®åŒ…ç»„æˆã€‚å½“æœåŠ¡å™¨å¼€å§‹å“åº”å®¢æˆ·ç«¯è¯·æ±‚æ—¶ï¼Œå®¢æˆ·ç«¯å¿…é¡»å®Œæ•´åœ°æ¥æ”¶æ•´ä¸ªè¿”å›ç»“æœï¼Œè€Œä¸èƒ½ç®€å•åœ°åªå–å‰é¢å‡ æ¡ç»“æœï¼Œç„¶åè®©æœåŠ¡å™¨åœæ­¢å‘é€æ•°æ®ã€‚è¿™ä¹Ÿæ˜¯åœ¨å¿…è¦çš„æ—¶å€™ä¸€å®šè¦åœ¨æŸ¥è¯¢ä¸­åŠ ä¸Š <code>LIMIT</code> é™åˆ¶çš„åŸå› ã€‚</p>
</div>
<div class="paragraph">
<p>å½“å®¢æˆ·ç«¯ä»æœåŠ¡å™¨å–æ•°æ®æ—¶ï¼Œçœ‹èµ·æ¥æ˜¯ä¸€ä¸ªæ‹‰æ•°æ®çš„è¿‡ç¨‹ï¼Œä½†å®é™…ä¸Šæ˜¯ MySQL åœ¨å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®çš„è¿‡ç¨‹ã€‚å®¢æˆ·ç«¯æ²¡æ³•è®©æœåŠ¡å™¨åœä¸‹æ¥ã€‚</p>
</div>
<div class="paragraph">
<p>å¤šæ•°è¿æ¥ MySQL çš„åº“å‡½æ•°éƒ½å¯ä»¥è·å¾—å…¨éƒ¨ç»“æœé›†å¹¶ç¼“å­˜åˆ°å†…å­˜é‡Œï¼Œè¿˜å¯ä»¥é€è¡Œè·å–éœ€è¦çš„æ•°æ®ã€‚é»˜è®¤ä¸€èˆ¬æ˜¯è·å¾—å…¨éƒ¨ç»“æœé›†å¹¶ç¼“å­˜åˆ°å†…å­˜ä¸­ã€‚</p>
</div>
<div class="paragraph">
<p>å½“ä½¿ç”¨å¤šæ•°è¿æ¥ MySQL çš„åº“å‡½æ•°ä» MySQL è·å–æ•°æ®æ—¶ï¼Œå…¶ç»“æœçœ‹èµ·æ¥éƒ½åƒæ˜¯ä» MySQL æœåŠ¡å™¨è·å–æ•°æ®ï¼Œè€Œå®é™…ä¸Šéƒ½æ˜¯ä»è¿™ä¸ªåº“å‡½æ•°çš„ç¼“å­˜è·å–æ•°æ®ã€‚</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
è¿™é‡Œçš„æ„æ€æ˜¯ï¼Œå¤„ç† <code>ResultSet</code> æ—¶ï¼Œæ•°æ®å·²ç»ä» MySQL æœåŠ¡å™¨ä¸Šè¯»å–è¿‡æ¥æ•°æ®ï¼Œç„¶åç›´æ¥ä» <code>ResultSet</code> ä¸­å–æ•°æ®ã€‚
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">æŸ¥è¯¢çŠ¶æ€</dt>
<dd>
<p>å¯¹äºä¸€ä¸ª MySQL è¿æ¥ï¼Œæˆ–è€…è¯´ä¸€ä¸ªçº¿ç¨‹ï¼Œä»»ä½•æ—¶åˆ»éƒ½æœ‰ä¸€ä¸ªçŠ¶æ€ï¼Œè¯¥çŠ¶æ€è¡¨ç¤ºäº† MySQL å½“å‰æ­£åœ¨åšä»€ä¹ˆã€‚æœ‰å¾ˆå¤šæ–¹å¼æŸ¥çœ‹å½“å‰çš„çŠ¶æ€ï¼Œæœ€ç®€å•çš„æ˜¯ä½¿ç”¨ <code>SHOW FULL PROCESSLIST</code> å‘½ä»¤ã€‚</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Sleep</dt>
<dd>
<p>çº¿ç¨‹æ­£åœ¨ç­‰å¾…å®¢æˆ·ç«¯å‘é€æ–°çš„è¯·æ±‚ã€‚</p>
</dd>
<dt class="hdlist1">Query</dt>
<dd>
<p>çº¿ç¨‹æ­£åœ¨æ‰§è¡ŒæŸ¥è¯¢æˆ–è€…æ­£åœ¨å°†ç»“æœå‘é€ç»™å®¢æˆ·ç«¯ã€‚</p>
</dd>
<dt class="hdlist1">Locked</dt>
<dd>
<p>åœ¨ MySQL æœåŠ¡å™¨å±‚ï¼Œè¯¥çº¿ç¨‹æ­£åœ¨ç­‰å¾…è¡¨é”ã€‚åœ¨å­˜å‚¨å¼•æ“çº§åˆ«å®ç°çš„é”ï¼Œä¾‹å¦‚ InnoDB çš„è¡Œé”ï¼Œå¹¶ä¸ä¼šä½“ç°åœ¨çº¿ç¨‹çŠ¶æ€ä¸­ã€‚</p>
</dd>
<dt class="hdlist1">Analyzing and statistics</dt>
<dd>
<p>çº¿ç¨‹æ­£åœ¨æ”¶é›†å­˜å‚¨å¼•æ“çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œå¹¶ç”ŸæˆæŸ¥è¯¢çš„æ‰§è¡Œè®¡åˆ’ã€‚</p>
</dd>
<dt class="hdlist1">Copying to tmp table [on disk]</dt>
<dd>
<p>çº¿ç¨‹æ­£åœ¨æ‰§è¡ŒæŸ¥è¯¢ï¼Œå¹¶ä¸”å°†ç»“æœé›†éƒ½å¤åˆ¶åˆ°ä¸€ä¸ªä¸´æ—¶è¡¨ä¸­ï¼Œè¿™ç§çŠ¶æ€ä¸€èˆ¬è¦ä¹ˆæ˜¯åœ¨åš <code>GROUP BY</code> æ“ä½œï¼Œè¦ä¹ˆæ˜¯æ–‡ä»¶æ’åºæ“ä½œï¼Œæˆ–è€…æ˜¯ <code>UNION</code> æ“ä½œã€‚å¦‚æœè¿™ä¸ªçŠ¶æ€åé¢è¿˜æœ‰ <code>on disk</code> æ ‡è®°ï¼Œé‚£è¡¨ç¤º MySQL æ­£åœ¨å°†ä¸€ä¸ªå†…å­˜ä¸´æ—¶è¡¨æ”¾åˆ°ç£ç›˜ä¸Šã€‚</p>
</dd>
<dt class="hdlist1">Sorting result</dt>
<dd>
<p>çº¿ç¨‹æ­£åœ¨å¯¹ç»“æœé›†è¿›è¡Œæ’åºã€‚</p>
</dd>
<dt class="hdlist1">Sending data</dt>
<dd>
<p>è¿™è¡¨ç¤ºå¤šç§æƒ…å†µï¼šçº¿ç¨‹å¯èƒ½åœ¨å¤šä¸ªçŠ¶æ€ä¹‹é—´ä¼ é€æ•°æ®ï¼Œæˆ–è€…åœ¨ç”Ÿæˆç»“æœé›†ï¼Œæˆ–è€…åœ¨å‘å®¢æˆ·ç«¯è¿”å›æ•°æ®ã€‚</p>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_æŸ¥è¯¢ç¼“å­˜">3.4.2. æŸ¥è¯¢ç¼“å­˜</h4>
<div class="paragraph">
<p>åœ¨è§£æä¸€ä¸ªæŸ¥è¯¢è¯­å¥ä¹‹å‰ï¼Œå¦‚æœæŸ¥è¯¢ç¼“å­˜æ˜¯æ‰“å¼€çš„ï¼Œé‚£ä¹ˆ MySQL ä¼šä¼˜å…ˆæ£€æŸ¥è¿™ä¸ªæŸ¥è¯¢æ˜¯å¦å‘½ä¸­æŸ¥è¯¢ç¼“å­˜ä¸­çš„æ•°æ®ã€‚æ£€æŸ¥æ˜¯é€šè¿‡å¯¹å¤§å°å†™æ•æ„Ÿçš„å“ˆå¸ŒæŸ¥æ‰¾å®ç°çš„ã€‚ä¸åŒ¹é…åˆ™è¿›è¡Œä¸‹ä¸€é˜¶æ®µå¤„ç†ã€‚</p>
</div>
<div class="paragraph">
<p>å‘½ä¸­ç¼“å­˜ï¼Œé‚£ä¹ˆåœ¨è¿”å›ç»“æœå‰ MySQL ä¼šæ£€æŸ¥ä¸€æ¬¡ç”¨æˆ·æƒé™ã€‚å¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œåˆ™ç›´æ¥ä»ç¼“å­˜ä¸­æ‹¿åˆ°ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚è¿™ç§æƒ…å†µä¸‹ï¼ŒæŸ¥è¯¢ä¸ä¼šè¢«è§£æï¼Œä¸ç”¨ç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼Œä¸ä¼šæ‰§è¡Œã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_æŸ¥è¯¢ä¼˜åŒ–å¤„ç†">3.4.3. æŸ¥è¯¢ä¼˜åŒ–å¤„ç†</h4>
<div class="paragraph">
<p>æŸ¥è¯¢çš„ç”Ÿå‘½å‘¨æœŸçš„ä¸‹ä¸€æ­¥æ˜¯å°†ä¸€ä¸ª SQL è½¬æ¢æˆä¸€ä¸ªæ‰§è¡Œè®¡åˆ’ï¼ŒMySQL å†æŒ‰ç…§è¿™ä¸ªæ‰§è¡Œè®¡åˆ’å’Œå­˜å‚¨å¼•æ“è¿›è¡Œäº¤äº’ã€‚è¿™åŒ…å«å¤šä¸ªå­é˜¶æ®µï¼š è§£æ SQLã€é¢„å¤„ç†ã€ä¼˜åŒ– SQL æ‰§è¡Œè®¡åˆ’ã€‚</p>
</div>
<div class="sect4">
<h5 id="_è¯­æ³•è§£æå™¨å’Œé¢„å¤„ç†">3.4.3.1. è¯­æ³•è§£æå™¨å’Œé¢„å¤„ç†</h5>
<div class="paragraph">
<p>é¦–å…ˆï¼ŒMySQL é€šè¿‡å…³é”®å­—å°† SQL è¯­å¥è¿›è¡Œè§£æï¼Œå¹¶ç”Ÿæˆä¸€è¯¾å¯¹åº”çš„â€œè§£ææ ‘â€ã€‚MySQL è§£æå™¨å°†ä½¿ç”¨ MySQL è¯­æ³•è§„åˆ™éªŒè¯å’Œè§£ææŸ¥è¯¢ã€‚</p>
</div>
<div class="paragraph">
<p>é¢„å¤„ç†å™¨åˆ™æ ¹æ®ä¸€äº› MySQL è§„åˆ™è¿›ä¸€æ­¥æ£€æŸ¥è§£ææ ‘æ˜¯å¦åˆæ³•ã€‚</p>
</div>
<div class="paragraph">
<p>ä¸‹ä¸€æ­¥é¢„å¤„ç†å™¨ä¼šéªŒè¯æƒé™ã€‚é€šå¸¸å¾ˆå¿«ï¼Œé™¤éæœ‰éå¸¸å¤šçš„æƒé™é…ç½®ã€‚</p>
</div>
</div>
<div class="sect4">
<h5 id="_æŸ¥è¯¢ä¼˜åŒ–å™¨">3.4.3.2. æŸ¥è¯¢ä¼˜åŒ–å™¨</h5>
<div class="paragraph">
<p>ä¸€æ¡æŸ¥è¯¢å¯ä»¥æœ‰å¾ˆå¤šç§æ‰§è¡Œæ–¹å¼ï¼Œæœ€åéƒ½è¿”å›ç›¸åŒçš„ç»“æœã€‚ä¼˜åŒ–å™¨çš„ä½œç”¨å°±æ˜¯æ‰¾åˆ°è¿™å…¶ä¸­æœ€å¥½çš„æ‰§è¡Œè®¡åˆ’ã€‚</p>
</div>
<div class="paragraph">
<p>MySQL ä½¿ç”¨åŸºäºæˆæœ¬çš„ä¼˜åŒ–å™¨ï¼Œå®ƒå°†å°è¯•é¢„æµ‹ä¸€ä¸ªæŸ¥è¯¢ä½¿ç”¨æŸç§æ‰§è¡Œè®¡åˆ’æ—¶çš„æˆæœ¬ï¼Œå¹¶é€‰æ‹©å…¶ä¸­æˆæœ¬æœ€å°çš„ä¸€ä¸ªã€‚å¯ä»¥é€šè¿‡æŸ¥è¯¢å½“å‰ä¼šè¯çš„ <code>Last_query_cost</code> çš„å€¼æ¥å¾—çŸ¥ MySQL è®¡ç®—çš„å½“å‰æŸ¥è¯¢çš„æˆæœ¬ã€‚</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> SQL_NO_CACHE <span class="predefined">count</span>(*)
<span class="keyword">FROM</span> film_actor;

<span class="class">SHOW</span> STATUS <span class="keyword">LIKE</span> <span class="string"><span class="delimiter">'</span><span class="content">Last_query_cost</span><span class="delimiter">'</span></span>; <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>åœ¨ä¸åŒæœºå™¨ä¸Šï¼Œç»“æœå¯èƒ½ä¸ä¸€æ ·ã€‚</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>è¿™æ˜¯æ ¹æ®ä¸€ç³»åˆ—çš„ç»Ÿè®¡ä¿¡æ¯è®¡ç®—å¾—æ¥çš„ï¼šæ¯ä¸ªè¡¨æˆ–è€…ç´¢å¼•çš„é¡µé¢ä¸ªæ•°ã€ç´¢å¼•çš„åŸºæ•°ï¼ˆç´¢å¼•ä¸­ä¸åŒå€¼çš„æ•°é‡ï¼‰ã€ç´¢å¼•å’Œæ•°æ®è¡Œçš„é•¿åº¦ã€ç´¢å¼•åˆ†å¸ƒæƒ…å†µã€‚</p>
</div>
<div class="paragraph">
<p>ä¼˜åŒ–å™¨åœ¨è¯„ä¼°æˆæœ¬çš„æ—¶å€™å¹¶ä¸è€ƒè™‘ä»»ä½•å±‚é¢çš„ç¼“å­˜ï¼Œå®ƒå‡è®¾è¯»å–ä»»ä½•æ•°æ®éƒ½éœ€è¦ä¸€æ¬¡ç£ç›˜ I/Oã€‚</p>
</div>
<div class="paragraph">
<p>å¯¼è‡´ MySQL ä¼˜åŒ–å™¨é€‰æ‹©é”™è¯¯çš„æ‰§è¡Œè®¡åˆ’çš„åŸå› ï¼š</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ç»Ÿè®¡ä¿¡æ¯ä¸å‡†ç¡®ã€‚ MySQL ä¾èµ–å­˜å‚¨å¼•æ“æä¾›çš„ç»Ÿè®¡ä¿¡æ¯æ¥è¯„ä¼°æˆæœ¬ï¼Œä½†æ˜¯æœ‰çš„å­˜å‚¨å¼•æ“æä¾›çš„ä¿¡æ¯æ˜¯å‡†ç¡®çš„ï¼Œæœ‰çš„åå·®å¯èƒ½éå¸¸å¤§ã€‚</p>
</li>
<li>
<p>æ‰§è¡Œè®¡åˆ’ä¸­çš„æˆæœ¬ä¼°ç®—ä¸ç­‰åŒäºå®é™…æ‰§è¡Œçš„æˆæœ¬ã€‚æ‰€ä»¥å³ä½¿ç»Ÿè®¡ä¿¡æ¯ç²¾ç¡®ï¼Œä¼˜åŒ–å™¨ç»™å‡ºçš„æ‰§è¡Œè®¡åˆ’ä¹Ÿå¯èƒ½ä¸æ˜¯æœ€ä¼˜çš„ã€‚</p>
</li>
<li>
<p>MySQL çš„æœ€ä¼˜å¯èƒ½å’Œä½ æƒ³çš„æœ€ä¼˜ä¸ä¸€æ ·ã€‚ç”±æ­¤å¯è§ï¼Œæ ¹æ®æ‰§è¡Œæˆæœ¬é€‰æ‹©æ‰§è¡Œè®¡åˆ’å¹¶ä¸æ˜¯å®Œç¾çš„æ¨¡å‹ã€‚</p>
</li>
<li>
<p>MySQL ä»ä¸è€ƒè™‘å…¶ä»–å¹¶å‘æ‰§è¡Œçš„æŸ¥è¯¢ï¼Œè¿™å¯èƒ½ä¼šå½±å“åˆ°å½“å‰æŸ¥è¯¢çš„é€Ÿåº¦ã€‚</p>
</li>
<li>
<p>MySQL ä¹Ÿå¹¶ä¸æ˜¯ä»»ä½•æ—¶å€™éƒ½æ˜¯åŸºäºæˆæœ¬çš„ä¼˜åŒ–ã€‚ä¾‹å¦‚å…¨æ–‡æ£€ç´¢ã€‚</p>
</li>
<li>
<p>MySQL ä¸ä¼šè€ƒè™‘ä¸å—å…¶æ§åˆ¶çš„æ“ä½œçš„æˆæœ¬ã€‚</p>
</li>
<li>
<p>ä¼˜åŒ–å™¨æœ‰æ—¶æ— æ³•å»ä¼°ç®—æ‰€æœ‰å¯èƒ½çš„æ‰§è¡Œè®¡åˆ’ã€‚</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>MySQL çš„æŸ¥è¯¢ä¼˜åŒ–å™¨æ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„éƒ¨ä»¶ï¼Œå®ƒä½¿ç”¨äº†å¾ˆå¤šä¼˜åŒ–ç­–ç•¥æ¥ç”Ÿæˆä¸€ä¸ªæœ€ä¼˜çš„æ‰§è¡Œè®¡åˆ’ã€‚ä¼˜åŒ–ç­–ç•¥å¯ä»¥ç®€å•åœ°åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯é™æ€ä¼˜åŒ–ï¼Œä¸€ç§æ˜¯åŠ¨æ€ä¼˜åŒ–ã€‚é™æ€ä¼˜åŒ–å¯ä»¥ç›´æ¥å¯¹è§£ææ ‘è¿›è¡Œåˆ†æï¼Œå¹¶å®Œæˆä¼˜åŒ–ã€‚é™æ€ä¼˜åŒ–ä¸ä¾èµ–äºç‰¹åˆ«çš„æ•°å€¼ã€‚é™æ€ä¼˜åŒ–åœ¨ç¬¬ä¸€æ¬¡å®Œæˆåå°±ä¸€ç›´æœ‰æ•ˆï¼Œå³ä½¿ä½¿ç”¨ä¸åŒçš„å‚æ•°å€¼é‡å¤æ‰§è¡ŒæŸ¥è¯¢ä¹Ÿä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚å¯ä»¥è®¤ä¸ºè¿™æ˜¯ä¸€ç§â€œç¼–è¯‘æ—¶ä¼˜åŒ–â€ã€‚</p>
</div>
<div class="paragraph">
<p>åŠ¨æ€ä¼˜åŒ–åˆ™å’ŒæŸ¥è¯¢çš„ä¸Šä¸‹æ–‡æœ‰å…³ï¼Œä¹Ÿå¯èƒ½å’Œå¾ˆå¤šå…¶ä»–å› ç´ æœ‰å…³ï¼Œéœ€è¦åœ¨æ¯æ¬¡æŸ¥è¯¢æ—¶éƒ½é‡æ–°è¯„ä¼°ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯â€œè¿è¡Œæ—¶ä¼˜åŒ–â€ã€‚æœ‰æ—¶ç”šè‡³åœ¨æŸ¥è¯¢çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ä¹Ÿä¼šé‡æ–°ä¼˜åŒ–ã€‚</p>
</div>
<div class="paragraph">
<p>MySQL èƒ½å¤Ÿå¤„ç†çš„ä¼˜åŒ–ç±»å‹ï¼š</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">é‡æ–°å®šä¹‰å…³è”è¡¨çš„é¡ºåº</dt>
<dd>
<p>æ•°æ®è¡¨çš„å…³è”å¹¶ä¸æ€»æ˜¯å®‰è£…åœ¨æŸ¥è¯¢ä¸­æŒ‡å®šçš„é¡ºåºè¿›è¡Œã€‚å†³å®šå…³è”çš„é¡ºåºæ˜¯ä¼˜åŒ–å™¨å¾ˆé‡è¦çš„ä¸€éƒ¨åˆ†åŠŸèƒ½ã€‚</p>
</dd>
<dt class="hdlist1">å°†å¤–è¿æ¥è½¬åŒ–æˆå†…è¿æ¥</dt>
<dd>
<p>å¹¶ä¸æ˜¯æ‰€æœ‰çš„ <code>OUTER JOIN</code> è¯­å¥éƒ½å¿…é¡»ä»¥å¤–è¿æ¥çš„æ–¹å¼æ‰§è¡Œã€‚</p>
</dd>
<dt class="hdlist1">ä½¿ç”¨ç­‰ä»·å˜æ¢è§„åˆ™</dt>
<dd>
<p>MySQL å¯ä»¥ä½¿ç”¨ä¸€äº›ç­‰ä»·å˜æ¢æ¥ç®€åŒ–å¹¶è§„èŒƒè¡¨è¾¾å¼ã€‚å¯ä»¥ç§‘æ¯”èƒ½å¤Ÿä¸€äº›æ¯”è¾ƒï¼Œç§»é™¤ä¸€äº›æ’æˆç«‹å’Œä¸€äº›æ’ä¸æˆç«‹çš„åˆ¤æ–­ç­‰ç­‰ã€‚</p>
</dd>
<dt class="hdlist1">ä¼˜åŒ– <code>COUNT()</code>ã€<code>MIN()</code> å’Œ <code>MAX()</code></dt>
<dd>
<p>ç´¢å¼•å’Œåˆ—æ˜¯å¦å¯ä¸ºç©ºé€šå¸¸å¯ä»¥å¸®åŠ© MySQL ä¼˜åŒ–è¿™ç±»è¡¨è¾¾å¼ã€‚ä¾‹å¦‚ï¼šä» B-Tree ç´¢å¼•ä¸­å–æœ€å¤§å€¼æˆ–è€…æœ€å°å€¼ï¼›æ²¡æœ‰ä»»ä½• <code>WHERE</code> æ¡ä»¶çš„ <code>COUNT(*)</code> æŸ¥è¯¢ã€‚</p>
</dd>
<dt class="hdlist1">é¢„ä¼°å¹¶è½¬åŒ–ä¸ºå¸¸æ•°è¡¨è¾¾å¼</dt>
<dd>
<p>å½“ MySQL æ£€æµ‹åˆ°ä¸€ä¸ªè¡¨è¾¾å¼å¯ä»¥è½¬åŒ–ä¸ºå¸¸æ•°çš„æ—¶å€™ï¼Œå°±ä¼šä¸€ç›´æŠŠè¯¥è¡¨è¾¾å¼ä½œä¸ºå¸¸æ•°è¿›è¡Œä¼˜åŒ–å¤„ç†ã€‚</p>
<div class="paragraph">
<p>è®©äººæƒŠè®¶çš„æ˜¯ï¼Œåœ¨ä¼˜åŒ–é˜¶æ®µï¼Œæœ‰æ—¶å€™ç”šè‡³ä¸€ä¸ªæŸ¥è¯¢ä¹Ÿèƒ½å¤Ÿè½¬åŒ–ä¸ºä¸€ä¸ªå¸¸æ•°ã€‚ä¾‹å¦‚ï¼šåœ¨ç´¢å¼•åˆ—ä¸Šæ‰§è¡Œ <code>MIN()</code>ï¼›ç”šè‡³ä¸»é”®æˆ–è€…å”¯ä¸€é”®æŸ¥æ‰¾è¯­å¥ã€‚</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">EXPLAIN
<span class="class">SELECT</span>
  f.film_id,
  fa.actor_id
<span class="keyword">FROM</span> film f
  <span class="keyword">INNER</span> <span class="keyword">JOIN</span> film_actor fa <span class="keyword">USING</span> (film_id)
<span class="keyword">WHERE</span> f.film_id = <span class="integer">1</span> <span class="error">\</span>G

*************************** <span class="error">1</span>. <span class="type">row</span> ***************************
           id: <span class="integer">1</span>
  select_type: SIMPLE
        <span class="type">table</span>: f
   partitions: <span class="predefined-constant">NULL</span>
         type: const
possible_keys: <span class="directive">PRIMARY</span>
          <span class="type">key</span>: <span class="directive">PRIMARY</span>
      key_len: <span class="integer">2</span>
          ref: const
         rows: <span class="integer">1</span>
     filtered: <span class="float">100.00</span>
        Extra: <span class="keyword">Using</span> <span class="type">index</span>
*************************** <span class="error">2</span>. <span class="type">row</span> ***************************
           id: <span class="integer">1</span>
  select_type: SIMPLE
        <span class="type">table</span>: fa
   partitions: <span class="predefined-constant">NULL</span>
         type: ref
possible_keys: idx_fk_film_id
          <span class="type">key</span>: idx_fk_film_id
      key_len: <span class="integer">2</span>
          ref: const
         rows: <span class="integer">10</span>
     filtered: <span class="float">100.00</span>
        Extra: <span class="keyword">Using</span> <span class="type">index</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>MySQL åˆ†ä¸¤æ­¥æ¥æ‰§è¡ŒæŸ¥è¯¢ã€‚ç¬¬ä¸€æ­¥ä» <code>film</code> è¡¨æ‰¾åˆ°éœ€è¦çš„è¡Œã€‚å› ä¸ºåœ¨ <code>film_id</code> å­—æ®µä¸Šæœ‰ä¸»é”®ç´¢å¼•ï¼Œæ‰€ä»¥ MySQL ä¼˜åŒ–å™¨çŸ¥é“è¿™åªä¼šè¿”å›ä¸€è¡Œæ•°æ®ï¼Œä¼˜åŒ–å™¨åœ¨ç”Ÿæˆæ‰§è¡Œè®¡åˆ’çš„æ—¶å€™ï¼Œå°±å·²ç»é€šè¿‡ç´¢å¼•ä¿¡æ¯çŸ¥é“å°†è¿”å›å¤šå°‘è¡Œæ•°æ®ã€‚å› ä¸ºä¼˜åŒ–å™¨å·²ç»æ˜ç¡®çŸ¥é“æœ‰å¤šå°‘ä¸ªå€¼ï¼ˆ <code>WHERE</code> æ¡ä»¶ä¸­çš„å€¼ï¼‰éœ€è¦åšç´¢å¼•æŸ¥è¯¢ï¼Œæ‰€ä»¥è¿™é‡Œçš„è¡¨è®¿é—®ç±»å‹æ˜¯ <code>const</code>ã€‚<br>
ç¬¬äºŒæ­¥ï¼ŒMySQL å°†ç¬¬ä¸€æ­¥ä¸­è¿”å›çš„ <code>film_id</code> åˆ—å½“åšä¸€ä¸ªå·²çŸ¥å–å€¼çš„åˆ—æ¥å¤„ç†ã€‚å› ä¸ºä¼˜åŒ–å™¨æ¸…æ¥šå†ç¬¬ä¸€æ­¥æ‰§è¡Œå®Œæˆåï¼Œè¯¥å€¼å°±ä¼šæ˜¯æ˜ç¡®çš„äº†ã€‚æ³¨æ„åˆ°æ­£å¦‚ç¬¬ä¸€æ­¥ä¸­ä¸€æ ·ï¼Œä½¿ç”¨ <code>film_actor</code> å­—æ®µå¯¹è¡¨çš„è®¿é—®ç±»å‹ä¹Ÿæ˜¯ <code>const</code>ã€‚P212</p>
</div>
<div class="paragraph">
<p>å¦ä¸€ç§ä¼šçœ‹åˆ°å¸¸æ•°æ¡ä»¶çš„æƒ…å†µæ˜¯é€šè¿‡ç­‰å¼å°†å¸¸æ•°å€¼ä»ä¸€ä¸ªè¡¨ä¼ ç»™å¦ä¸€ä¸ªè¡¨ï¼Œè¿™å¯ä»¥é€šè¿‡ <code>WHERE</code>ã€<code>USING</code> æˆ–è€… <code>ON</code> è¯­å¥æ¥é™åˆ¶æŸåˆ—å€¼ä¸ºå¸¸æ•°ã€‚</p>
</div>
</dd>
<dt class="hdlist1">è¦†ç›–ç´¢å¼•æ‰«æ</dt>
<dd>
<p>å½“ç´¢å¼•ä¸­çš„åˆ—åŒ…å«æ‰€æœ‰æŸ¥è¯¢ä¸­éœ€è¦ä½¿ç”¨çš„åˆ—çš„æ—¶å€™ï¼Œ MySQL å°±å¯ä»¥ä½¿ç”¨ç´¢å¼•è¿”å›éœ€è¦çš„æ•°æ®ï¼Œè€Œæ— é¡»æŸ¥è¯¢å¯¹åº”çš„æ•°æ®è¡Œã€‚</p>
</dd>
<dt class="hdlist1">å­æŸ¥è¯¢ä¼˜åŒ–</dt>
<dd>
<p>MySQL åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥å°†å­æŸ¥è¯¢è½¬æ¢æˆä¸€ç§æ•ˆç‡æ›´é«˜çš„å½¢å¼ï¼Œä»è€Œå‡å°‘å¤šä¸ªæŸ¥è¯¢å¤šæ¬¡å¯¹æ•°æ®è¿›è¡Œè®¿é—®ã€‚</p>
</dd>
<dt class="hdlist1">æå‰ç»ˆæ­¢æŸ¥è¯¢</dt>
<dd>
<p>åœ¨å‘ç°å·²ç»æ»¡è¶³æŸ¥è¯¢éœ€æ±‚çš„æ—¶å€™ï¼ŒMySQL æ€»æ˜¯èƒ½å¤Ÿç«‹åˆ»ç»ˆæ­¢æŸ¥è¯¢ã€‚ä¾‹å¦‚ï¼š<code>LIMIT</code> å­å¥ï¼›å†ä¾‹å¦‚ï¼Œå‘ç°ä¸€ä¸ªä¸æˆç«‹çš„æ¡ä»¶ã€‚</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">EXPLAIN
<span class="class">SELECT</span> film_id
<span class="keyword">FROM</span> film
<span class="keyword">WHERE</span> film_id = <span class="integer">-1</span> <span class="error">\</span>G
*************************** <span class="error">1</span>. <span class="type">row</span> ***************************
           id: <span class="integer">1</span>
  select_type: SIMPLE
        <span class="type">table</span>: <span class="predefined-constant">NULL</span>
   partitions: <span class="predefined-constant">NULL</span>
         type: <span class="predefined-constant">NULL</span>
possible_keys: <span class="predefined-constant">NULL</span>
          <span class="type">key</span>: <span class="predefined-constant">NULL</span>
      key_len: <span class="predefined-constant">NULL</span>
          ref: <span class="predefined-constant">NULL</span>
         rows: <span class="predefined-constant">NULL</span>
     filtered: <span class="predefined-constant">NULL</span>
        Extra: no matching <span class="type">row</span> <span class="keyword">in</span> const <span class="type">table</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>ä»è¿™ä¸ªä¾‹å­çœ‹åˆ°ï¼ŒæŸ¥è¯¢åœ¨ä¼˜åŒ–é˜¶æ®µå°±å·²ç»ç»ˆæ­¢ã€‚</p>
</div>
</dd>
<dt class="hdlist1">ç­‰å€¼ä¼ æ’­</dt>
<dd>
<p>å¦‚æœä¸¤ä¸ªåˆ—çš„å€¼é€šè¿‡ç­‰å¼å…³è”ï¼Œé‚£ä¹ˆ MySQL èƒ½å¤ŸæŠŠå…¶ä¸­ä¸€ä¸ªåˆ—çš„ <code>WHERE</code> æ¡ä»¶ä¼ é€’åˆ°å¦ä¸€åˆ—ä¸Šã€‚</p>
</dd>
<dt class="hdlist1">åˆ—è¡¨ <code>IN()</code> çš„æ¯”è¾ƒ</dt>
<dd>
<p>åœ¨å¾ˆå¤šæ•°æ®åº“ç³»ç»Ÿä¸­ï¼Œ<code>IN()</code> å®Œå…¨ç­‰åŒäºå¤šä¸ª <code>OR</code> æ¡ä»¶çš„å­å¥ï¼Œå› ä¸ºè¿™ä¸¤è€…æ˜¯å®Œå…¨ç­‰ä»·çš„ã€‚è€Œ MySQL å°† <code>IN()</code> åˆ—è¡¨ä¸­çš„æ•°æ®å…ˆè¿›è¡Œæ’åºï¼Œç„¶åé€šè¿‡äºŒåˆ†æŸ¥æ‰¾çš„æ–¹å¼æ¥ç¡®å®šåˆ—è¡¨ä¸­çš„å€¼æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼Œè¿™æ˜¯ O(log <em>n</em>) å¤æ‚åº¦ï¼›è½¬åŒ–æˆ <code>OR</code> æŸ¥è¯¢åˆ™ä¸º O(<em>n</em>)ã€‚</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>ä¸è¦è‡ªä»¥ä¸ºæ¯”ä¼˜åŒ–å™¨æ›´èªæ˜ï¼</strong></p>
</div>
</div>
<div class="sect4">
<h5 id="_æ•°æ®å’Œç´¢å¼•çš„ç»Ÿè®¡ä¿¡æ¯">3.4.3.3. æ•°æ®å’Œç´¢å¼•çš„ç»Ÿè®¡ä¿¡æ¯</h5>
<div class="paragraph">
<p>ä¸åŒçš„å­˜å‚¨å¼•æ“å¯èƒ½ä¼šå­˜å‚¨ä¸åŒçš„ç»Ÿè®¡ä¿¡æ¯ï¼ˆä¹Ÿå¯ä»¥æŒ‰ç…§ä¸åŒçš„æ ¼å¼å­˜å‚¨ç»Ÿè®¡ä¿¡æ¯ï¼‰ã€‚</p>
</div>
<div class="paragraph">
<p>MySQL æŸ¥è¯¢ä¼˜åŒ–å™¨åœ¨ç”ŸæˆæŸ¥è¯¢çš„æ‰§è¡Œè®¡åˆ’æ—¶ï¼Œéœ€è¦å‘å­˜å‚¨å¼•æ“è·å–ç›¸åº”çš„ç»Ÿè®¡ä¿¡æ¯ã€‚å­˜å‚¨å¼•æ“åˆ™æä¾›ç»™ä¼˜åŒ–å™¨å¯¹åº”çš„ç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼šæ¯ä¸ªè¡¨æˆ–è€…ç´¢å¼•æœ‰å¤šå°‘ä¸ªé¡µé¢ã€æ¯ä¸ªè¡¨çš„æ¯ä¸ªç´¢å¼•çš„åŸºæ•°æ˜¯å¤šå°‘ã€æ•°æ®è¡Œå’Œç´¢å¼•é•¿åº¦ã€ç´¢å¼•çš„åˆ†å¸ƒä¿¡æ¯ç­‰ç­‰</p>
</div>
</div>
<div class="sect4">
<h5 id="_mysql_å¦‚ä½•æ‰§è¡Œå…³è”æŸ¥è¯¢">3.4.3.4. MySQL å¦‚ä½•æ‰§è¡Œå…³è”æŸ¥è¯¢</h5>
<div class="paragraph">
<p>MySQL è®¤ä¸ºä»»ä½•ä¸€ä¸ªæŸ¥è¯¢éƒ½æ˜¯ä¸€æ¬¡â€œå…³è”â€&#8201;&#8212;&#8201;å¹¶ä¸ä»…ä»…æ˜¯ä¸€ä¸ªæŸ¥è¯¢éœ€è¦åˆ°ä¸¤ä¸ªè¡¨åŒ¹é…æ‰å«å…³è”ï¼Œæ‰€ä»¥åœ¨ MySQL ä¸­ï¼Œæ¯ä¸€ä¸ªæŸ¥è¯¢ï¼Œæ¯ä¸€ä¸ªç‰‡æ®µï¼ˆåŒ…æ‹¬å­æŸ¥è¯¢ï¼Œç”šè‡³åŸºäºå•è¡¨çš„ <code>SELECT</code>ï¼‰éƒ½å¯èƒ½ä½¿å…³è”ã€‚</p>
</div>
<div class="paragraph">
<p>å¯¹äº <code>UNION</code> æŸ¥è¯¢ï¼ŒMySQL å…ˆå°†ä¸€ç³»åˆ—çš„å•ä¸ªæŸ¥è¯¢ç»“æœæ”¾åˆ°ä¸€ä¸ªä¸´æ—¶è¡¨ä¸­ï¼Œç„¶åå†é‡æ–°è¯»å‡ºä¸´æ—¶è¡¨æ•°æ®æ¥å®Œæˆ <code>UNION</code> æŸ¥è¯¢ã€‚</p>
</div>
<div class="paragraph">
<p>MySQL å…³è”æ‰§è¡Œçš„ç­–ç•¥ï¼šMySQL å¯¹ä»»ä½•å…³è”éƒ½æ‰§è¡ŒåµŒå¥—å¾ªç¯å…³è”æ“ä½œï¼Œå³ MySQL å…ˆåœ¨ä¸€ä¸ªè¡¨ä¸­å¾ªç¯å–å‡ºå•æ¡æ•°æ®ï¼Œç„¶åå†åµŒå¥—å¾ªç¯åˆ°ä¸‹ä¸€ä¸ªè¡¨ä¸­å¯»æ‰¾åŒ¹é…çš„è¡Œï¼Œä¾æ¬¡ä¸‹å»ï¼ŒçŸ¥é“æ‰¾åˆ°æ‰€æœ‰è¡¨ä¸­åŒ¹é…çš„è¡Œä½ç½®ã€‚ç„¶åæ ¹æ®å„ä¸ªè¡¨åŒ¹é…çš„è¡Œï¼Œè¿”å›æŸ¥è¯¢ä¸­éœ€è¦çš„å„ä¸ªåˆ—ã€‚MySQL ä¼šå°è¯•åœ¨æœ€åä¸€ä¸ªå…³è”è¡¨ä¸­æ‰¾åˆ°æ‰€æœ‰åŒ¹é…çš„è¡Œï¼Œå¦‚æœæœ€åä¸€ä¸ªå…³è”è¡¨æ— æ³•æ‰¾åˆ°æ›´å¤šçš„è¡Œä»¥åï¼ŒMySQL è¿”å›åˆ°ä¸Šä¸€å±‚æ¬¡å…³è”è¡¨ï¼Œçœ‹æ˜¯å¦èƒ½å¤Ÿæ‰¾åˆ°æ›´å¤šçš„åŒ¹é…è®°å½•ï¼Œä»¥æ­¤ç±»æ¨è¿­ä»£æ‰§è¡Œã€‚å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç æ¥è§£é‡Šï¼š</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="comment">-- å†…å…³è”æŸ¥è¯¢ ----------------------------------------------------</span>
<span class="class">SELECT</span>
  tbl1.col1,
  tbl2.col2
<span class="keyword">FROM</span> tbl1
  <span class="keyword">INNER</span> <span class="keyword">JOIN</span> tbl2 <span class="keyword">USING</span> (col3)
<span class="keyword">WHERE</span> tbl1.col1 <span class="keyword">IN</span> (<span class="integer">5</span>, <span class="integer">6</span>);

<span class="comment">-- ç”¨ä¼ªä»£ç æ¥è§£é‡Š MySQL å…³è”æ‰§è¡Œçš„ç­–ç•¥åˆ™æ˜¯å¦‚ä¸‹ï¼š</span>
outer_iter = iteratro <span class="keyword">over</span> tbl1 <span class="keyword">WHERE</span> col1 <span class="keyword">IN</span> (<span class="integer">5</span>, <span class="integer">6</span>)
outer_row = outer_iter.next
while outer_row
    inner_iter = iteratro <span class="keyword">over</span> tbl2 <span class="keyword">WHERE</span> col3 = outer_row.col3
    inner_row  = inner_iter.next
    while inner_row
        output [outer_row.col1, inner_row.col2]
        inner_row = inner_iter.next
    <span class="keyword">end</span>
    outer_row = outer_iter.next
<span class="keyword">end</span>

<span class="comment">-- å·¦å¤–å…³è”æŸ¥è¯¢ --------------------------------------------------</span>

<span class="class">SELECT</span>
  tbl1.col1,
  tbl2.col2
<span class="keyword">FROM</span> tbl1
  <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> tbl2 <span class="keyword">USING</span> (col3)
<span class="keyword">WHERE</span> tbl1.col1 <span class="keyword">IN</span> (<span class="integer">5</span>, <span class="integer">6</span>);

<span class="comment">-- ç”¨ä¼ªä»£ç æ¥è§£é‡Š MySQL å…³è”æ‰§è¡Œçš„ç­–ç•¥åˆ™æ˜¯å¦‚ä¸‹ï¼š</span>
outer_iter = iteratro <span class="keyword">over</span> tbl1 <span class="keyword">WHERE</span> col1 <span class="keyword">IN</span> (<span class="integer">5</span>, <span class="integer">6</span>)
outer_row = outer_iter.next
while outer_row
    inner_iter = iteratro <span class="keyword">over</span> tbl2 <span class="keyword">WHERE</span> col3 = outer_row.col3
    inner_row  = inner_iter.next
    <span class="keyword">if</span> inner_row
        while inner_row
            output [outer_row.col1, inner_row.col2]
            inner_row = inner_iter.next
        <span class="keyword">end</span>
    <span class="keyword">else</span>
        output [outer_row.col1, <span class="predefined-constant">NULL</span>]
    <span class="keyword">end</span>
    outer_row = outer_iter.next
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>å¯è§†åŒ–æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’çš„æ–¹æ³•æ˜¯æ ¹æ®ä¼˜åŒ–å™¨æ‰§è¡Œçš„è·¯å¾„ç»˜åˆ¶å‡ºå¯¹åº”çš„â€œæ³³é“å›¾â€ã€‚</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/related_query_lane.png" alt="å…³è”æŸ¥è¯¢æ³³é“å›¾" width="95%">
</div>
<div class="title">å›¾ 37. å…³è”æŸ¥è¯¢æ³³é“å›¾</div>
</div>
<div class="paragraph">
<p>ä»æœ¬è´¨ä¸Šæ¥è¯´ï¼ŒMySQL å¯¹æ‰€æœ‰çš„ç±»å‹çš„æŸ¥è¯¢éƒ½ä»¥åŒæ ·çš„æ–¹å¼è¿è¡Œã€‚ä¾‹å¦‚ï¼šå­æŸ¥è¯¢å…ˆæ”¾åˆ°ä¸€ä¸ªä¸´æ—¶è¡¨ï¼›<code>UNION</code> ä¹Ÿç”¨ç±»ä¼¼çš„ä¸´æ—¶è¡¨ã€‚</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
åœ¨ MySQL 5.6 å’Œ MariaDB ä¸­æœ‰äº†é‡å¤§æ”¹å˜ï¼Œè¿™ä¸¤ä¸ªç‰ˆæœ¬éƒ½å¼•å…¥äº†æ›´åŠ å¤æ‚çš„æ‰§è¡Œè®¡åˆ’ã€‚
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_æ‰§è¡Œè®¡åˆ’">3.4.3.5. æ‰§è¡Œè®¡åˆ’</h5>
<div class="paragraph">
<p>MySQL ç”ŸæˆæŸ¥è¯¢çš„ä¸€æ£µæŒ‡ä»¤æ ‘ï¼Œç„¶åé€šè¿‡å­˜å‚¨å¼•æ“æ‰§è¡Œå®Œæˆè¿™é¢—æŒ‡ä»¤æ ‘å¹¶è¿”å›ç»“æœã€‚æœ€ç»ˆçš„æ‰§è¡Œè®¡åˆ’åŒ…å«äº†é‡æ„æŸ¥è¯¢çš„å…¨éƒ¨ä¿¡æ¯ã€‚</p>
</div>
<div class="paragraph">
<p>å¦‚æœè¯»æŸä¸ªæŸ¥è¯¢æ‰§è¡Œ <code>EXPLAIN EXTENDED</code> åï¼Œå†æ‰§è¡Œ <code>SHOW WARNINGS</code>ï¼Œå°±å¯ä»¥çœ‹åˆ°é‡æ„å‡ºçš„æŸ¥è¯¢ã€‚</p>
</div>
</div>
<div class="sect4">
<h5 id="_å…³è”æŸ¥è¯¢ä¼˜åŒ–å™¨">3.4.3.6. å…³è”æŸ¥è¯¢ä¼˜åŒ–å™¨</h5>
<div class="paragraph">
<p>MySQL ä¼˜åŒ–å™¨æœ€é‡è¦çš„ä¸€éƒ¨åˆ†å°±æ˜¯å…³è”æŸ¥è¯¢ä¼˜åŒ–ï¼Œå®ƒå†³å®šäº†å¤šä¸ªè¡¨å…³è”æ—¶çš„é¡ºåºã€‚å…³è”æŸ¥è¯¢ä¼˜åŒ–å™¨é€šè¿‡è¯„ä¼°ä¸åŒå…³è”é¡ºåºæ—¶çš„æˆæœ¬æ¥é€‰æ‹©ä¸€ä¸ªä»£ä»·æœ€å°çš„å…³è”é¡ºåºã€‚</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">EXPLAIN
<span class="class">SELECT</span>
  film.film_id,
  film.title,
  film.release_year,
  actor.actor_id,
  actor.first_name,
  actor.last_name
<span class="keyword">FROM</span> film
  <span class="keyword">INNER</span> <span class="keyword">JOIN</span> film_actor <span class="keyword">USING</span> (film_id)
  <span class="keyword">INNER</span> <span class="keyword">JOIN</span> actor <span class="keyword">USING</span> (actor_id) <span class="error">\</span>G

*************************** <span class="error">1</span>. <span class="type">row</span> ***************************
           id: <span class="integer">1</span>
  select_type: SIMPLE
        <span class="type">table</span>: actor
   partitions: <span class="predefined-constant">NULL</span>
         type: <span class="keyword">ALL</span>
possible_keys: <span class="directive">PRIMARY</span>
          <span class="type">key</span>: <span class="predefined-constant">NULL</span>
      key_len: <span class="predefined-constant">NULL</span>
          ref: <span class="predefined-constant">NULL</span>
         rows: <span class="integer">200</span>
     filtered: <span class="float">100.00</span>
        Extra: <span class="predefined-constant">NULL</span>
*************************** <span class="error">2</span>. <span class="type">row</span> ***************************
           id: <span class="integer">1</span>
  select_type: SIMPLE
        <span class="type">table</span>: film_actor
   partitions: <span class="predefined-constant">NULL</span>
         type: ref
possible_keys: <span class="directive">PRIMARY</span>,idx_fk_film_id
          <span class="type">key</span>: <span class="directive">PRIMARY</span>
      key_len: <span class="integer">2</span>
          ref: sakila.actor.actor_id
         rows: <span class="integer">27</span>
     filtered: <span class="float">100.00</span>
        Extra: <span class="keyword">Using</span> <span class="type">index</span>
*************************** <span class="error">3</span>. <span class="type">row</span> ***************************
           id: <span class="integer">1</span>
  select_type: SIMPLE
        <span class="type">table</span>: film
   partitions: <span class="predefined-constant">NULL</span>
         type: eq_ref
possible_keys: <span class="directive">PRIMARY</span>
          <span class="type">key</span>: <span class="directive">PRIMARY</span>
      key_len: <span class="integer">2</span>
          ref: sakila.film_actor.film_id
         rows: <span class="integer">1</span>
     filtered: <span class="float">100.00</span>
        Extra: <span class="predefined-constant">NULL</span>
<span class="integer">3</span> rows <span class="keyword">in</span> <span class="class">set</span>, <span class="integer">1</span> warning (<span class="float">0.00</span> sec)</code></pre>
</div>
</div>
<div class="paragraph">
<p>ä»è¿™ä¸ªæ‰§è¡Œè®¡åˆ’å°±èƒ½èƒ½çœ‹å‡ºè¿™ä¸ªæŸ¥è¯¢æ˜¯ä» <code>actor</code> å¼€å§‹æŸ¥è¯¢çš„ã€‚å¯¹æ¯”ä¸€ä¸‹ï¼š</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">EXPLAIN
<span class="class">SELECT</span> STRAIGHT_JOIN
  film.film_id,
  film.title,
  film.release_year,
  actor.actor_id,
  actor.first_name,
  actor.last_name
<span class="keyword">FROM</span> film
  <span class="keyword">INNER</span> <span class="keyword">JOIN</span> film_actor <span class="keyword">USING</span> (film_id)
  <span class="keyword">INNER</span> <span class="keyword">JOIN</span> actor <span class="keyword">USING</span> (actor_id) <span class="error">\</span>G

*************************** <span class="error">1</span>. <span class="type">row</span> ***************************
           id: <span class="integer">1</span>
  select_type: SIMPLE
        <span class="type">table</span>: film
   partitions: <span class="predefined-constant">NULL</span>
         type: <span class="keyword">ALL</span>
possible_keys: <span class="directive">PRIMARY</span>
          <span class="type">key</span>: <span class="predefined-constant">NULL</span>
      key_len: <span class="predefined-constant">NULL</span>
          ref: <span class="predefined-constant">NULL</span>
         rows: <span class="integer">1000</span>
     filtered: <span class="float">100.00</span>
        Extra: <span class="predefined-constant">NULL</span>
*************************** <span class="error">2</span>. <span class="type">row</span> ***************************
           id: <span class="integer">1</span>
  select_type: SIMPLE
        <span class="type">table</span>: film_actor
   partitions: <span class="predefined-constant">NULL</span>
         type: ref
possible_keys: <span class="directive">PRIMARY</span>,idx_fk_film_id
          <span class="type">key</span>: idx_fk_film_id
      key_len: <span class="integer">2</span>
          ref: sakila.film.film_id
         rows: <span class="integer">5</span>
     filtered: <span class="float">100.00</span>
        Extra: <span class="keyword">Using</span> <span class="type">index</span>
*************************** <span class="error">3</span>. <span class="type">row</span> ***************************
           id: <span class="integer">1</span>
  select_type: SIMPLE
        <span class="type">table</span>: actor
   partitions: <span class="predefined-constant">NULL</span>
         type: eq_ref
possible_keys: <span class="directive">PRIMARY</span>
          <span class="type">key</span>: <span class="directive">PRIMARY</span>
      key_len: <span class="integer">2</span>
          ref: sakila.film_actor.actor_id
         rows: <span class="integer">1</span>
     filtered: <span class="float">100.00</span>
        Extra: <span class="predefined-constant">NULL</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>å¦‚æœä¼˜åŒ–å™¨ç»™å‡ºçš„å¹¶ä¸æ˜¯æœ€ä¼˜çš„å…³è”é¡ºåºï¼Œå¯ä»¥ä½¿ç”¨ <code>STRAIGHT_JOIN</code> å…³é”®å­—é‡æ–°æŸ¥è¯¢ï¼Œè®©ä¼˜åŒ–å™¨æŒ‰ç…§ä½ è®¤ä¸ºçš„æœ€ä¼˜çš„å…³è”é¡ºåºæ‰§è¡Œã€‚ç»å¤§å¤šæ•°æ—¶å€™ï¼Œä¼˜åŒ–å™¨åšå‡ºçš„é€‰æ‹©éƒ½æ¯”æ™®é€šäººçš„åˆ¤æ–­æ›´å‡†ç¡®ã€‚</p>
</div>
<div class="paragraph">
<p>å…³è”ä¼˜åŒ–å™¨ä¼šå°è¯•åœ¨æ‰€æœ‰çš„å…³è”é¡ºåºä¸­é€‰æ‹©ä¸€ä¸ªæˆæœ¬æœ€å°çš„æ¥ç”Ÿæˆæ‰§è¡Œè®¡åˆ’æ ‘ã€‚</p>
</div>
<div class="paragraph">
<p>ç³Ÿç³•çš„æ˜¯ï¼Œå¦‚æœæœ‰è¶…è¿‡ n ä¸ªè¡¨å…³è”ï¼Œé‚£ä¹ˆéœ€è¦æ£€æŸ¥ n çš„é˜¶ä¹˜ç§å…³è”å…³ç³»ï¼Œç§°ä¹‹ä¸ºæ‰€æœ‰å¯èƒ½çš„æ‰§è¡Œè®¡åˆ’çš„ â€œæœç´¢ç©ºé—´â€ï¼Œæœç´¢ç©ºé—´çš„å¢é•¿éå¸¸å¿«ã€‚å½“æœç´¢ç©ºé—´éå¸¸å¤§çš„æ—¶å€™ï¼Œä¼˜åŒ–å™¨ä¸å¯èƒ½é€ä¸€è¯„ä¼°æ¯ä¸€ç§å…³è”é¡ºåºçš„æˆæœ¬ï¼Œä¼˜åŒ–å™¨é€‰æ‹©ä½¿ç”¨â€œè´ªå©ªâ€æœç´¢çš„æ–¹å¼æŸ¥æ‰¾â€œæœ€ä¼˜â€çš„å…³è”é¡ºåºã€‚</p>
</div>
</div>
<div class="sect4">
<h5 id="_æ’åºä¼˜åŒ–">3.4.3.7. æ’åºä¼˜åŒ–</h5>
<div class="paragraph">
<p>æ— è®ºå¦‚ä½•æ’åºéƒ½æ˜¯ä¸€ä¸ªæˆæœ¬å¾ˆé«˜çš„æ“ä½œï¼Œæ‰€ä»¥ä»æ€§èƒ½è§’åº¦è€ƒè™‘ï¼Œåº”å°½å¯èƒ½é¿å…æ’åºæˆ–è€…å°½å¯èƒ½é¿å…å¯¹å¤§é‡æ•°æ®è¿›è¡Œæ’åºã€‚</p>
</div>
<div class="paragraph">
<p>å¦‚æœéœ€è¦æ’åºçš„æ•°é‡å°äºâ€œæ’åºç¼“å†²åŒºâ€ï¼ŒMySQL ä½¿ç”¨å†…å­˜è¿›è¡Œâ€œå¿«é€Ÿæ’åºâ€æ“ä½œã€‚å¦‚æœå†…å­˜ä¸å¤Ÿæ’åºï¼Œé‚£ä¹ˆ MySQL ä¼šå…ˆå°†æ•°æ®åˆ†å—ï¼Œå¯¹æ¯ä¸ªç‹¬ç«‹çš„å—ä½¿ç”¨â€œå¿«é€Ÿæ’åºâ€è¿›è¡Œæ’åºï¼Œå¹¶å°†å„ä¸ªå—çš„æ’åºç»“æœå­˜æ”¾åœ¨ç£ç›˜ä¸Šï¼Œç„¶åå°†å„ä¸ªæ’å¥½åºçš„å—è¿›è¡Œåˆå¹¶ï¼Œæœ€åè¿”å›æ’åºç»“æœã€‚</p>
</div>
<div class="paragraph">
<p>MySQL æœ‰å¦‚ä¸‹ä¸¤ç§æ’åºç®—æ³•ï¼š</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">ä¸¤æ¬¡ä¼ è¾“æ’åºï¼ˆæ—§ç‰ˆæœ¬ä½¿ç”¨ï¼‰</dt>
<dd>
<p>è¯»å–è¡ŒæŒ‡é’ˆå’Œéœ€è¦æ’åºçš„å­—æ®µï¼Œå¯¹å…¶è¿›è¡Œæ’åºï¼Œç„¶åå†æ ¹æ®æ’åºç»“æœè¯»å–æ‰€éœ€è¦çš„æ•°æ®è¡Œã€‚</p>
<div class="paragraph">
<p>éœ€è¦ä¸¤æ¬¡æ•°æ®ä¼ è¾“ï¼Œå³éœ€è¦ä»æ•°æ®è¡¨ä¸­è¯»å–ä¸¤æ¬¡æ•°æ®ï¼Œç¬¬äºŒæ¬¡è¯»å–æ•°æ®çš„æ—¶å€™ï¼Œå› ä¸ºæ˜¯è¯»å–æ’åºåˆ—è¿›è¡Œæ’åºåçš„æ‰€æœ‰è®°å½•ï¼Œä¼šäº§ç”Ÿå¤§é‡çš„éšæœº I/Oã€‚</p>
</div>
<div class="paragraph">
<p>ä¼˜ç‚¹ï¼šåœ¨æ’åºçš„æ—¶å€™å­˜å‚¨å°½å¯èƒ½å°‘çš„æ•°æ®ï¼Œè®©â€œæ’åºç¼“å†²åŒºâ€ä¸­å¯èƒ½å®¹çº³å°½å¯èƒ½å¤šçš„è¡Œæ•°è¿›è¡Œæ’åºã€‚</p>
</div>
</dd>
<dt class="hdlist1">å•æ¬¡ä¼ è¾“æ’åºï¼ˆæ–°ç‰ˆæœ¬ä½¿ç”¨ï¼‰</dt>
<dd>
<p>å…ˆè¯»å–æŸ¥è¯¢æ‰€éœ€è¦çš„æ‰€æœ‰åˆ—ï¼Œç„¶åå†æ ¹æ®ç»™å®šåˆ—è¿›è¡Œæ’åºï¼Œæœ€åç›´æ¥è¿”å›æ’åºç»“æœã€‚</p>
<div class="paragraph">
<p>åœ¨ MySQL 4.1 å’Œåç»­æ›´æ–°çš„ç‰ˆæœ¬æ‰å¼•å…¥ã€‚</p>
</div>
<div class="paragraph">
<p>ä¼˜ç‚¹ï¼šä¸éœ€è¦è¯»å–ä¸¤æ¬¡æ•°æ®ï¼Œå¯¹äº I/O å¯†é›†å‹çš„åº”ç”¨ï¼Œæ•ˆç‡é«˜å¾ˆå¤šï¼Œåªéœ€ä¸€æ¬¡é¡ºåº I/O è¯»å–æ‰€æœ‰çš„æ•°æ®ï¼Œæ— é¡»ä»»ä½•çš„éšæœº I/Oã€‚</p>
</div>
<div class="paragraph">
<p>ç¼ºç‚¹ï¼šå¦‚æœè¿”å›çš„åˆ—éå¸¸å¤šã€éå¸¸å¤§ï¼Œä¼šé¢å¤–å ç”¨å¤§é‡çš„ç©ºé—´ã€‚</p>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
å¯ä»¥é€šè¿‡è°ƒæ•´ <code>max_length_for_sort_data</code> æ¥å½±å“ MySQL æ’åºç®—æ³•çš„é€‰æ‹©ã€‚
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
MySQL åœ¨è¿›è¡Œæ–‡ä»¶æ’åºçš„æ—¶å€™éœ€è¦ä½¿ç”¨çš„ä¸´æ—¶å­˜å‚¨ç©ºé—´å¯èƒ½ä¼šæ¯”æƒ³è±¡çš„è¦å¤§å¾—å¤šã€‚
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>å¦‚æœ <code>ORDER BY</code> å­å¥ä¸­çš„æ‰€æœ‰åˆ—éƒ½æ¥è‡ªå…³è”çš„ç¬¬ä¸€ä¸ªè¡¨ï¼Œé‚£ä¹ˆ MySQL åœ¨å…³è”å¤„ç†ç¬¬ä¸€ä¸ªè¡¨çš„æ—¶å€™å°±è¿›è¡Œæ–‡ä»¶æ’åºã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œé‚£ä¹ˆåœ¨ MySQL çš„ <code>EXPLAIN</code> ç»“æœä¸­å¯ä»¥çœ‹åˆ° <code>Extra</code> å­—æ®µä¼šæœ‰ <code>Using filesort</code>ã€‚é™¤æ­¤ä¹‹å¤–çš„æ‰€æœ‰æƒ…å†µï¼ŒMySQL éƒ½ä¼šå…ˆå°†ç®¡ç†çš„ç»“æœå­˜æ”¾åˆ°ä¸€ä¸ªä¸´æ—¶è¡¨ä¸­ï¼Œç„¶ååœ¨æ‰€æœ‰çš„å…³è”éƒ½ç»“æŸåï¼Œå†è¿›è¡Œæ–‡ä»¶æ’åºã€‚è¿™æ—¶ï¼Œåœ¨ MySQL çš„ <code>EXPLAIN</code> ç»“æœçš„ <code>Extra</code> å­—æ®µå¯ä»¥çœ‹åˆ° <code>Using temporary; Using filesort</code>ã€‚<code>LIMIT</code> ä¼šåœ¨æ’åºååº”ç”¨ã€‚</p>
</div>
<div class="paragraph">
<p>MySQL 5.6 å½“è¿˜éœ€è¦è¿”å›éƒ¨åˆ†æŸ¥è¯¢ç»“æœæ—¶ï¼Œä¸å†å¯¹æ‰€æœ‰ç»“æœè¿›è¡Œæ’åºã€‚</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
ä»è¿™å¥è¯ä¸­ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œå¦‚æœå¯ä»¥ï¼Œå°½é‡ä½¿ç”¨ä¸€å¼ è¡¨ä¸­çš„å­—æ®µã€‚
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_æŸ¥è¯¢æ‰§è¡Œå¼•æ“">3.4.4. æŸ¥è¯¢æ‰§è¡Œå¼•æ“</h4>
<div class="paragraph">
<p>æŸ¥è¯¢æ‰§è¡Œé˜¶æ®µä¸æ˜¯é‚£ä¹ˆå¤æ‚ï¼šMySQL åªæ˜¯ç®€å•åœ°æ ¹æ®æ‰§è¡Œè®¡åˆ’ç»™å‡ºçš„æŒ‡ä»¤é€æ­¥æ‰§è¡Œã€‚</p>
</div>
<div class="paragraph">
<p>å­˜å‚¨å¼•æ“æ¥å£æœ‰ç€éå¸¸ä¸°å¯Œçš„åŠŸèƒ½ï¼Œä½†åº•å±‚æ¥å£å´åªæœ‰å‡ åä¸ªï¼Œè¿™äº›æ¥å£åƒâ€œæ­ç§¯æœ¨â€ä¸€æ ·èƒ½å¤Ÿå®ŒæˆæŸ¥è¯¢çš„å¤§éƒ¨åˆ†æ“ä½œã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_è¿”å›ç»“æœç»™å®¢æˆ·ç«¯">3.4.5. è¿”å›ç»“æœç»™å®¢æˆ·ç«¯</h4>
<div class="paragraph">
<p>æŸ¥è¯¢æ‰§è¡Œçš„æœ€åä¸€ä¸ªé˜¶æ®µæ˜¯å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p>
</div>
<div class="paragraph">
<p>å¦‚æœæŸ¥è¯¢å¯ä»¥è¢«ç¼“å­˜ï¼Œé‚£ä¹ˆ MySQL åœ¨è¿™ä¸ªé˜¶æ®µä¹Ÿä¼šå°†ç»“æœå­˜æ”¾åˆ°æŸ¥è¯¢ç¼“å­˜ä¸­ã€‚</p>
</div>
<div class="paragraph">
<p>MySQL å°†ç»“æœé›†è¿”å›å®¢æˆ·ç«¯æ˜¯ä¸€ä¸ªå¢é‡ã€é€æ­¥è¿”å›çš„è¿‡ç¨‹ã€‚</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mysql_æŸ¥è¯¢ä¼˜åŒ–å™¨çš„å±€é™æ€§">3.5. MySQL æŸ¥è¯¢ä¼˜åŒ–å™¨çš„å±€é™æ€§</h3>
<div class="paragraph">
<p>MySQL çš„ä¸‡èƒ½â€œåµŒå¥—å¾ªç¯â€å¹¶ä¸æ˜¯å¯¹æ¯ç§æŸ¥è¯¢éƒ½æ˜¯æœ€ä¼˜çš„ã€‚MySQL æŸ¥è¯¢ä¼˜åŒ–å™¨åªå¯¹å°‘éƒ¨åˆ†æŸ¥è¯¢ä¸é€‚ç”¨ï¼Œå¾€å¾€å¯ä»¥é€šè¿‡æ”¹å†™æŸ¥è¯¢è®© MySQL é«˜æ•ˆåœ°å®Œæˆå·¥ä½œã€‚</p>
</div>
<div class="sect3">
<h4 id="_å…³è”å­æŸ¥è¯¢">3.5.1. å…³è”å­æŸ¥è¯¢</h4>
<div class="paragraph">
<p>MySQL çš„å­æŸ¥è¯¢å®ç°å¾—éå¸¸ç³Ÿç³•ã€‚æœ€ç³Ÿç³•çš„ä¸€ç±»æŸ¥è¯¢æ˜¯ <code>WHERE</code> æ¡ä»¶ä¸­åŒ…å« <code>IN()</code> çš„å­æŸ¥è¯¢è¯­å¥ã€‚</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="comment">-- åŸå§‹å†™æ³•</span>
<span class="class">SELECT</span> *
<span class="keyword">FROM</span> film
<span class="keyword">WHERE</span> film_id <span class="keyword">IN</span> (
  <span class="class">SELECT</span> film_id
  <span class="keyword">FROM</span> film_actor
  <span class="keyword">WHERE</span> actor_id = <span class="integer">1</span>);

<span class="comment">-- æ”¹è¿›åçš„å†™æ³•</span>
<span class="class">SELECT</span> film.*
<span class="keyword">FROM</span> film
  <span class="keyword">INNER</span> <span class="keyword">JOIN</span> film_actor <span class="keyword">USING</span> (film_id)
<span class="keyword">WHERE</span> actor_id = <span class="integer">1</span>;

<span class="comment">-- ä¹¦ä¸Šæåˆ°çš„ç¬¬äºŒç§å†™æ³•ï¼Œä½†æ˜¯ä¹¦ä¸Šå‰åçŸ›ç›¾ï¼Œ</span>
<span class="comment">-- æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’ä¹Ÿå‘ç°ï¼Œè¿™ç§å†™æ³•æœ‰é—®é¢˜ã€‚</span>
<span class="class">SELECT</span> *
<span class="keyword">FROM</span> film
<span class="keyword">WHERE</span> <span class="keyword">EXISTS</span>(
    <span class="class">SELECT</span> *
    <span class="keyword">FROM</span> film_actor
    <span class="keyword">WHERE</span> actor_id = <span class="integer">1</span>
          <span class="keyword">AND</span> film_actor.film_id = film.film_id);</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
åœ¨ MySQL 5.7 ä¸­ï¼Œä¸Šé¢ç¬¬ä¸€ç§ SQL å­˜åœ¨çš„é—®é¢˜å·²ç»å¾—åˆ°è§£å†³ã€‚å¯ä»¥å’Œç¬¬äºŒç§æœ‰åŒæ ·çš„è¡¨ç°ã€‚
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_å¦‚ä½•ç”¨å¥½å…³è”å­æŸ¥è¯¢">3.5.1.1. å¦‚ä½•ç”¨å¥½å…³è”å­æŸ¥è¯¢</h5>
<div class="paragraph">
<p>å¹¶ä¸æ˜¯æ‰€æœ‰å…³è”å­æŸ¥è¯¢çš„æ€§èƒ½éƒ½ä¼šå¾ˆå·®ã€‚å…ˆæµ‹è¯•ï¼Œç„¶ååšå‡ºè‡ªå·±çš„åˆ¤æ–­ã€‚å¾ˆå¤šæ—¶å€™ï¼Œå…³è”å­æŸ¥è¯¢æ˜¯ä¸€ç§éå¸¸åˆç†ã€è‡ªç„¶ï¼Œç”šè‡³æ˜¯æ€§èƒ½æœ€å¥½çš„å†™æ³•ã€‚</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">EXPLAIN
<span class="class">SELECT</span>
  film_id,
  language_id
<span class="keyword">FROM</span> film
<span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>(
    <span class="class">SELECT</span> *
    <span class="keyword">FROM</span> film_actor
    <span class="keyword">WHERE</span> film_actor.film_id = film.film_id);

*************************** <span class="error">1</span>. <span class="type">row</span> ***************************
           id: <span class="integer">1</span>
  select_type: <span class="directive">PRIMARY</span>
        <span class="type">table</span>: film
   partitions: <span class="predefined-constant">NULL</span>
         type: <span class="type">index</span>
possible_keys: <span class="predefined-constant">NULL</span>
          <span class="type">key</span>: idx_fk_language_id
      key_len: <span class="integer">1</span>
          ref: <span class="predefined-constant">NULL</span>
         rows: <span class="integer">1000</span>
     filtered: <span class="float">100.00</span>
        Extra: <span class="keyword">Using</span> <span class="keyword">where</span>; <span class="keyword">Using</span> <span class="type">index</span> <i class="conum" data-value="2"></i><b>(2)</b>
*************************** <span class="error">2</span>. <span class="type">row</span> ***************************
           id: <span class="integer">2</span>
  select_type: DEPENDENT SUBQUERY  <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="type">table</span>: film_actor
   partitions: <span class="predefined-constant">NULL</span>
         type: ref
possible_keys: idx_fk_film_id
          <span class="type">key</span>: idx_fk_film_id
      key_len: <span class="integer">2</span>
          ref: sakila.film.film_id
         rows: <span class="integer">5</span>
     filtered: <span class="float">100.00</span>
        Extra: <span class="keyword">Using</span> <span class="type">index</span>  <i class="conum" data-value="3"></i><b>(3)</b>


<span class="comment">-- ä½¿ç”¨å·¦å¤–é“¾æ¥â€œä¼˜åŒ–â€åçš„ SQL</span>
EXPLAIN
<span class="class">SELECT</span>
  film.film_id,
  film.language_id
<span class="keyword">FROM</span> film
  <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> film_actor <span class="keyword">USING</span> (film_id)
<span class="keyword">WHERE</span> film_actor.film_id <span class="keyword">IS</span> <span class="predefined-constant">NULL</span> <span class="error">\</span>G

*************************** <span class="error">1</span>. <span class="type">row</span> ***************************
           id: <span class="integer">1</span>
  select_type: SIMPLE
        <span class="type">table</span>: film
   partitions: <span class="predefined-constant">NULL</span>
         type: <span class="type">index</span>
possible_keys: <span class="predefined-constant">NULL</span>
          <span class="type">key</span>: idx_fk_language_id
      key_len: <span class="integer">1</span>
          ref: <span class="predefined-constant">NULL</span>
         rows: <span class="integer">1000</span>
     filtered: <span class="float">100.00</span>
        Extra: <span class="keyword">Using</span> <span class="type">index</span> <i class="conum" data-value="2"></i><b>(2)</b>
*************************** <span class="error">2</span>. <span class="type">row</span> ***************************
           id: <span class="integer">1</span>
  select_type: SIMPLE  <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="type">table</span>: film_actor
   partitions: <span class="predefined-constant">NULL</span>
         type: ref
possible_keys: idx_fk_film_id
          <span class="type">key</span>: idx_fk_film_id
      key_len: <span class="integer">2</span>
          ref: sakila.film.film_id
         rows: <span class="integer">5</span>
     filtered: <span class="float">100.00</span>
        Extra: <span class="keyword">Using</span> <span class="keyword">where</span>; <span class="keyword">Not</span> <span class="keyword">exists</span>; <span class="keyword">Using</span> <span class="type">index</span> <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>è¡¨ film_actor çš„è®¿é—®ç±»å‹ä¸€ä¸ªæ˜¯ <code>DEPENDENT SUBQUERY</code>ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯ <code>SIMPLE</code>ã€‚è¿™æ˜¯ç”±äºè¯­å¥çš„å†™æ³•ä¸åŒå¯¼è‡´çš„ï¼Œä¸€ä¸ªæ˜¯æ™®é€šæŸ¥è¯¢ï¼Œä¸€ä¸ªæ˜¯å­æŸ¥è¯¢ã€‚å¯¹äºåº•å±‚å­˜å‚¨å¼•æ“æ¥å£æ¥è¯´ï¼Œæ²¡æœ‰ä»»ä½•ä¸åŒã€‚</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>å¯¹äº film è¡¨ï¼Œç¬¬äºŒä¸ªæŸ¥è¯¢çš„ <code>Extra</code> ä¸­æ²¡æœ‰ <code>Using where</code>ï¼Œä½†ä¸é‡è¦ï¼Œç¬¬äºŒä¸ªæŸ¥è¯¢çš„ <code>USING</code> å­å¥å’Œç¬¬ä¸€ä¸ªæŸ¥è¯¢çš„ <code>WHERE</code> å­å¥å®é™…ä¸Šæ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>ç¬¬äºŒä¸ªè¡¨ film_actor çš„æ‰§è¡Œè®¡åˆ’çš„ <code>Extra</code> åˆ—æœ‰ <code>Not exists</code>ã€‚è¿™æ˜¯æå‰ç»ˆæ­¢ç®—æ³•ï¼ˆearly-termination algorithmï¼‰ï¼ŒMySQL é€šè¿‡ä½¿ç”¨ <code>Not exists</code> ä¼˜åŒ–æ¥é¿å…åœ¨è¡¨ film_actor çš„ç´¢å¼•ä¸­è¯»å–é¢å¤–çš„è¡Œã€‚è¿™å®Œå…¨ç­‰æ•ˆäºç›´æ¥ç¼–å†™ <code>NOT EXISTS</code> å­æŸ¥è¯¢ã€‚</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>ç»¼ä¸Šï¼Œä»ç†è®ºä¸Šæ¥è®²ï¼ŒMySQL å°†ä½¿ç”¨å®Œå…¨ç›¸åŒçš„æ‰§è¡Œè®¡åˆ’æ¥å®Œæˆè¿™ä¸ªæŸ¥è¯¢ã€‚</p>
</div>
<div class="paragraph">
<p><strong>å†æ¬¡å¼ºè°ƒï¼šåº”è¯¥ç”¨æµ‹è¯•æ¥éªŒè¯å¯¹å­æŸ¥è¯¢çš„æ‰§è¡Œè®¡åˆ’å’Œå“åº”æ—¶é—´çš„å‡è®¾ï¼</strong></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="__code_union_code_çš„é™åˆ¶">3.5.2. <code>UNION</code> çš„é™åˆ¶</h4>
<div class="paragraph">
<p>MySQL æ— æ³•å°†é™åˆ¶æ¡ä»¶ä»å¤–å±‚â€œä¸‹æ¨â€åˆ°å†…å±‚ã€‚ä¾‹å¦‚ï¼Œæ— æ³•å°† <code>LIMIT</code> â€œä¸‹æ¨â€åˆ° <code>UNION</code> çš„å„ä¸ªå­å¥ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_ç´¢å¼•åˆå¹¶ä¼˜åŒ–">3.5.3. ç´¢å¼•åˆå¹¶ä¼˜åŒ–</h4>
<div class="paragraph">
<p>åœ¨ MySQL 5.0 å’Œæ›´æ–°çš„ç‰ˆæœ¬ä¸­ï¼Œå½“ <code>WHERE</code> å­å¥ä¸­åŒ…å«å¤šä¸ªå¤æ‚æ¡ä»¶çš„æ—¶å€™ï¼ŒMySQL èƒ½å¤Ÿè®¿é—®å•ä¸ªè¡¨çš„å¤šä¸ªç´¢å¼•ä»¥åˆå¹¶å’Œäº¤å‰è¿‡æ»¤çš„æ–¹å¼æ¥å®šä½éœ€è¦æŸ¥æ‰¾çš„è¡Œã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_ç­‰å€¼ä¼ é€’">3.5.4. ç­‰å€¼ä¼ é€’</h4>
<div class="paragraph">
<p>æŸäº›æ—¶å€™ï¼Œç­‰å€¼ä¼ é€’ä¼šå¸¦æ¥ä¸€äº›æ„æƒ³ä¸åˆ°çš„é¢å¤–æ¶ˆè€—ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªéå¸¸å¤§çš„ <code>IN()</code> åˆ—è¡¨ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_å¹¶è¡Œæ‰§è¡Œ">3.5.5. å¹¶è¡Œæ‰§è¡Œ</h4>
<div class="paragraph">
<p>MySQL æ— æ³•åˆ©ç”¨å¤šæ ¸ç‰¹æ€§æ¥å¹¶è¡Œæ‰§è¡ŒæŸ¥è¯¢ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_å“ˆå¸Œå…³è”">3.5.6. å“ˆå¸Œå…³è”</h4>
<div class="paragraph">
<p>MariaDB å·²ç»å®ç°äº†çœŸæ­£çš„å“ˆå¸Œå…³è”ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_æ¾æ•£ç´¢å¼•æ‰«æ">3.5.7. æ¾æ•£ç´¢å¼•æ‰«æ</h4>
<div class="paragraph">
<p>MySQL å¹¶ä¸æ”¯æŒæ¾æ•£ç´¢å¼•æ‰«æã€‚é€šå¸¸ï¼ŒMySQL çš„ç´¢å¼•æ‰«æéœ€è¦å…ˆå®šä¹‰ä¸€ä¸ªèµ·ç‚¹å’Œç»ˆç‚¹ï¼Œå³ä½¿éœ€è¦çš„æ•°æ®åªæ˜¯è¿™æ®µç´¢å¼•ä¸­å¾ˆå°‘æ•°çš„å‡ ä¸ªï¼ŒMySQL ä»éœ€è¦æ‰«æè¿™æ®µç´¢å¼•ä¸­æ¯ä¸€ä¸ªæ¡ç›®ã€‚</p>
</div>
<div class="paragraph">
<p>ä¾‹å¦‚ï¼šæ‰€ä»¥å­—æ®µæ˜¯ï¼ˆa, bï¼‰ï¼ŒæŸ¥è¯¢ b å­—æ®µåŒºé—´å€¼ã€‚å¯ä»¥é€ä¸ª a å»å®šä½æŒ‡ç‚¹ bï¼Œè¿™æ ·æ•ˆæœå°±ä¼šå¾ˆå¥½ã€‚</p>
</div>
<div class="paragraph">
<p>MySQL 5.0 ä¹‹åçš„ç‰ˆæœ¬ï¼Œåœ¨æŸäº›ç‰¹æ®Šçš„åœºæ™¯ä¸‹æ˜¯å¯ä»¥ä½¿ç”¨æ¾æ•£ç´¢å¼•æ‰«æçš„ï¼Œä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªåˆ†ç»„æŸ¥è¯¢ä¸­éœ€è¦æ‰¾åˆ°åˆ†ç»„çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼š</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">EXPLAIN
<span class="class">SELECT</span>
  actor_id,
  <span class="predefined">max</span>(film_id)
<span class="keyword">FROM</span> film_actor
<span class="keyword">GROUP</span> <span class="keyword">BY</span> actor_id <span class="error">\</span>G

*************************** <span class="error">1</span>. <span class="type">row</span> ***************************
           id: <span class="integer">1</span>
  select_type: SIMPLE
        <span class="type">table</span>: film_actor
   partitions: <span class="predefined-constant">NULL</span>
         type: range
possible_keys: <span class="directive">PRIMARY</span>,idx_fk_film_id
          <span class="type">key</span>: <span class="directive">PRIMARY</span>
      key_len: <span class="integer">2</span>
          ref: <span class="predefined-constant">NULL</span>
         rows: <span class="integer">201</span>
     filtered: <span class="float">100.00</span>
        Extra: <span class="keyword">Using</span> <span class="type">index</span> <span class="keyword">for</span> <span class="keyword">group</span>-<span class="keyword">by</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>åœ¨ <code>EXPLAIN</code> çš„ <code>Extra</code> å­—æ®µæ˜¾ç¤º â€œUsing index for group-byâ€ï¼Œè¡¨ç¤ºè¿™é‡Œå°†ä½¿ç”¨æ¾æ•£ç´¢å¼•æ‰«æã€‚å¦‚æœ MySQL èƒ½å†™ä¸Š â€œloose index probeâ€ï¼Œç›¸ä¿¡ä¼šæ›´å¥½ç†è§£ã€‚</p>
</div>
<div class="paragraph">
<p>ä¸€ä¸ªç®€å•çš„ç»•è¿‡é—®é¢˜çš„åŠæ³•å°±æ˜¯ç»™å‰é¢çš„åˆ—åŠ ä¸Šå¯èƒ½çš„å¸¸æ•°å€¼ã€‚</p>
</div>
<div class="paragraph">
<p>åœ¨ MySQL 5.6 ä¹‹åçš„ç‰ˆæœ¬ï¼Œå…³äºæ¾æ•£ç´¢å¼•æ‰«æçš„ä¸€äº›é™åˆ¶ä¼šé€šè¿‡â€œç´¢å¼•æ¡ä»¶ä¸‹æ¨ï¼ˆindex condition pushdownï¼‰â€çš„æ–¹å¼æ¥è§£å†³ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_æœ€å¤§å€¼å’Œæœ€å°å€¼ä¼˜åŒ–">3.5.8. æœ€å¤§å€¼å’Œæœ€å°å€¼ä¼˜åŒ–</h4>
<div class="paragraph">
<p>å¯¹äº <code>MIN()</code> å’Œ <code>MAX()</code> æŸ¥è¯¢ï¼ŒMySQL çš„ä¼˜åŒ–åšå¾—å¹¶ä¸å¥½ã€‚</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> <span class="predefined">MIN</span>(actor_id)
<span class="keyword">FROM</span> actor
<span class="keyword">WHERE</span> first_name = <span class="string"><span class="delimiter">'</span><span class="content">PENELOPE</span><span class="delimiter">'</span></span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>first_name</code> å­—æ®µæ²¡æœ‰ç´¢å¼•ï¼Œä¼šåšä¸€æ¬¡å…¨è¡¨æ‰«æã€‚å¦‚èƒ½ä½¿ç”¨ä¸»é”®æ‰«æï¼Œå½“ MySQL è¯»åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„è®°å½•çš„æ—¶å€™ï¼Œå°±æ˜¯æˆ‘ä»¬éœ€è¦çš„æœ€å°å€¼äº†ã€‚å¯ä»¥é€šè¿‡æŸ¥çœ‹ <code>SHOW STATUS</code> çš„å…¨è¡¨æ‰«æè®¡æ•°å™¨æ¥éªŒè¯è¿™ç‚¹ã€‚</p>
</div>
<div class="paragraph">
<p>ä¸€ä¸ªæ›²çº¿çš„ä¼˜åŒ–æ–¹æ³•æ˜¯ç§»é™¤ <code>MIN()</code>ï¼Œç„¶åä½¿ç”¨ <code>LIMIT</code> æ¥é‡å†™æŸ¥è¯¢ï¼š</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span> actor_id
<span class="keyword">FROM</span> actor
USE <span class="type">INDEX</span> (<span class="directive">PRIMARY</span>)
<span class="keyword">WHERE</span> first_name = <span class="string"><span class="delimiter">'</span><span class="content">PENELOPE</span><span class="delimiter">'</span></span>
LIMIT <span class="integer">1</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>è¿™ä¸ª SQL å·²ç»æ— æ³•è¡¨è¾¾å¥¹çš„æœ¬æ„äº†ã€‚</p>
</div>
<div class="paragraph">
<p>ä¸€èˆ¬æˆ‘ä»¬é€šè¿‡ SQL å‘Šè¯‰æœåŠ¡å™¨æˆ‘ä»¬éœ€è¦ä»€ä¹ˆæ•°æ®ï¼Œç”±æœåŠ¡å™¨æ¥å†³å®šå¦‚ä½•æœ€ä¼˜åœ°è·å–æ•°æ®ã€‚</p>
</div>
<div class="paragraph">
<p>æœ‰æ—¶å€™ä¸ºäº†è·å¾—æ›´é«˜çš„æ€§èƒ½ï¼Œæˆ‘ä»¬ä¸å¾—ä¸æ”¾å¼ƒä¸€äº›åŸåˆ™ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_åœ¨åŒä¸€ä¸ªè¡¨ä¸ŠæŸ¥è¯¢å’Œæ›´æ–°">3.5.9. åœ¨åŒä¸€ä¸ªè¡¨ä¸ŠæŸ¥è¯¢å’Œæ›´æ–°</h4>
<div class="paragraph">
<p>MySQL ä¸å…è®¸å¯¹åŒä¸€å¼ è¡¨åŒæ—¶è¿›è¡ŒæŸ¥è¯¢å’Œæ›´æ–°ã€‚</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="comment">-- ä¹¦ä¸Šæ²¡æœ‰ç»™è¡¨çš„å®šä¹‰ï¼Œæ ¹æ®ä¸Šä¸‹æ–‡ SQL è‡ªè¡Œæ·»åŠ </span>
<span class="class">DROP</span> <span class="type">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> tbl;
<span class="class">CREATE</span> <span class="type">TABLE</span> tbl (
  id   <span class="predefined-type">INTEGER</span> <span class="directive">AUTO_INCREMENT</span> <span class="directive">PRIMARY</span> <span class="type">KEY</span>,
  type <span class="predefined-type">TINYINT</span>,
  cnt  <span class="predefined-type">INTEGER</span> <span class="directive">DEFAULT</span> <span class="integer">0</span>
);

<span class="class">UPDATE</span> tbl <span class="keyword">AS</span> outer_tbl
<span class="class">SET</span> cnt = (
  <span class="class">SELECT</span> <span class="predefined">count</span>(*)
  <span class="keyword">FROM</span> tbl <span class="keyword">AS</span> inner_tbl
  <span class="keyword">WHERE</span> inner_tbl.type = outer_tbl.type
);  <i class="conum" data-value="1"></i><b>(1)</b>

<span class="class">UPDATE</span> tbl
  <span class="keyword">INNER</span> <span class="keyword">JOIN</span> (
               <span class="class">SELECT</span>
                 type,
                 <span class="predefined">count</span>(*) <span class="keyword">AS</span> cnt
               <span class="keyword">FROM</span> tbl
               <span class="keyword">GROUP</span> <span class="keyword">BY</span> type
             ) <span class="keyword">AS</span> der <span class="keyword">USING</span> (type)
<span class="class">SET</span> tbl.cnt = der.cnt; <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>æŠ¥é”™ â€œ[HY000][1093] You can&#8217;t specify target table 'outer_tbl' for update in FROM clauseâ€</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>é€šè¿‡ä½¿ç”¨ç”Ÿæˆè¡¨çš„å½¢å¼æ¥ç»•è¿‡ä¸Šé¢çš„é™åˆ¶ã€‚</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_æŸ¥è¯¢ä¼˜åŒ–å™¨çš„æç¤º_hint">3.6. æŸ¥è¯¢ä¼˜åŒ–å™¨çš„æç¤ºï¼ˆhintï¼‰</h3>
<div class="paragraph">
<p>å¦‚æœå¯¹æŸ¥è¯¢ä¼˜åŒ–å™¨é€‰æ‹©çš„æ‰§è¡Œè®¡åˆ’ä¸æ»¡æ„ï¼Œå¯ä»¥ä½¿ç”¨ä¼˜åŒ–å™¨æä¾›çš„å‡ ä¸ªæç¤ºæ¥æ§åˆ¶æœ€ç»ˆçš„æ‰§è¡Œè®¡åˆ’ã€‚</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">HIGH_PRIORITY å’Œ LOW_PRIORITY</dt>
<dd>
<p>å½“å¤šä¸ªè¯­å¥åŒäº‹è®¿é—®æŸä¸€ä¸ªè¡¨çš„æ—¶å€™ï¼Œå“ªäº›è¯­å¥çš„ä¼˜å…ˆçº§ç›¸å¯¹é«˜äº›ã€å“ªäº›è¯­å¥çš„ä¼˜å…ˆçº§ç›¸å¯¹ä½äº›ã€‚</p>
<div class="paragraph">
<p>è¿™ä¸¤ä¸ªæç¤ºåªå¯¹ä½¿ç”¨è¡¨é”çš„å­˜å‚¨å¼•æ“æœ‰æ•ˆï¼Œåƒä¸‡ä¸è¦åœ¨ InnoDB æˆ–è€…å…¶ä»–æœ‰ç»†ç²’åº¦é”æœºåˆ¶å’Œå¹¶å‘æ§åˆ¶çš„å¼•æ“ä¸­ä½¿ç”¨ã€‚</p>
</div>
</dd>
<dt class="hdlist1">DELAYED</dt>
<dd>
<p>åªå¯¹ <code>INSERT</code> å’Œ <code>REPLACE</code> æœ‰æ•ˆã€‚</p>
<div class="paragraph">
<p>MySQL ä¼šå°†ä½¿ç”¨è¯¥æç¤ºçš„è¯­å¥ç«‹å³è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå¹¶å°†æ’å…¥çš„è¡Œæ•°æ®æ”¾å…¥åˆ°ç¼“å†²åŒºï¼Œç„¶ååœ¨è¡¨ç©ºé—²æ—¶æ‰¹é‡å°†æ•°æ®å†™å…¥ã€‚</p>
</div>
<div class="paragraph">
<p>å¹¶ä¸æ˜¯æ‰€æœ‰çš„å­˜å‚¨å¼•æ“éƒ½æ”¯æŒï¼›è¯¥æç¤ºä¼šå¯¼è‡´å‡½æ•° <code>LAST_INSERT_ID()</code> æ— æ³•æ­£å¸¸å·¥ä½œã€‚</p>
</div>
</dd>
<dt class="hdlist1">STRAIGHT_JOIN</dt>
<dd>
<p>æ”¾ç½®åœ¨ <code>SELECT</code> è¯­å¥çš„ <code>SELECT</code> å…³é”®å­—ä¹‹åï¼šæ˜¯è®©æŸ¥è¯¢ä¸­æ‰€æœ‰çš„è¡¨æŒ‰ç…§åœ¨è¯­å¥ä¸­å‡ºç°çš„é¡ºåºè¿›è¡Œå…³è”ï¼›</p>
<div class="paragraph">
<p>æ”¾ç½®åœ¨ä»»ä½•ä¸¤ä¸ªå…³è”è¡¨çš„åå­—ä¹‹é—´ï¼šå›ºå®šå…¶å‰åä¸¤ä¸ªè¡¨çš„å…³è”é¡ºåºã€‚</p>
</div>
</dd>
<dt class="hdlist1">SQL_SMALL_RESULT å’Œ SQL_BIG_RESULT</dt>
<dd>
<p>åªå¯¹ <code>SELECT</code> è¯­å¥æœ‰æ•ˆã€‚</p>
<div class="paragraph">
<p>å‘Šè¯‰ä¼˜åŒ–å™¨å¯¹ <code>GROUP BY</code> å’Œ <code>DISTINCT</code> æŸ¥è¯¢å¦‚ä½•ä½¿ç”¨ä¸´æ—¶è¡¨åŠæ’åºã€‚</p>
</div>
<div class="paragraph">
<p><code>SQL_SMALL_RESULT</code> å‘Šè¯‰ä¼˜åŒ–å™¨ç»“æœé›†å¾ˆå°ï¼Œå¯ä»¥å°†ç»“æœé›†æ”¾åœ¨å†…å­˜ä¸­çš„ç´¢å¼•ä¸´æ—¶è¡¨ï¼Œä»¥é¿å…æ’åºæ“ä½œã€‚<br>
<code>SQL_BIG_RESULT</code> å‘Šè¯‰ä¼˜åŒ–å™¨ç»“æœé›†å¯èƒ½ä¼šéå¸¸å¤§ï¼Œå»ºè®®ä½¿ç”¨ç£ç›˜ä¸´æ—¶è¡¨åšæ’åºæ“ä½œã€‚</p>
</div>
</dd>
<dt class="hdlist1">SQL_BUFFER_RESULT</dt>
<dd>
<p>å‘Šè¯‰ä¼˜åŒ–å™¨å°†æŸ¥è¯¢ç»“æœæ”¾å…¥åˆ°ä¸€ä¸ªä¸´æ—¶è¡¨ï¼Œç„¶åå°½å¯èƒ½å¿«åœ°é‡Šæ”¾è¡¨é”ã€‚ä½¿ç”¨æœåŠ¡ç«¯ç¼“å­˜æ— é¡»åœ¨å®¢æˆ·ç«¯ä¸Šæ¶ˆè€—å¤ªå¤šå†…å­˜ï¼Œå¯ä»¥å°½å¿«é‡Šæ”¾å¯¹åº”çš„è¡¨é”ã€‚ä»£ä»·æ˜¯ï¼ŒæœåŠ¡å™¨ç«¯éœ€è¦æ›´å¤šçš„å†…å­˜ã€‚</p>
</dd>
<dt class="hdlist1">SQL_CACHE å’Œ SQL_NO_CACHE</dt>
<dd>
<p>å‘Šè¯‰ MySQL è¿™ä¸ªç»“æœé›†é‡Šæ”¾åº”è¯¥ç¼“å­˜åœ¨æŸ¥è¯¢ç¼“å­˜ä¸­ã€‚</p>
</dd>
<dt class="hdlist1">SQL_CALC_FOUND_ROWS</dt>
<dd>
<p>è®© MySQL è¿”å›çš„ç»“æœé›†åŒ…å«æ›´å¤šçš„ä¿¡æ¯ã€‚æŸ¥è¯¢ä¸­åŠ ä¸Šè¯¥æç¤º MySQL ä¼šè®¡ç®—é™¤å» <code>LIMIT</code> å­å¥åè¿™ä¸ªæŸ¥è¯¢è¦è¿”å›çš„ç»“æœé›†çš„æ€»æ•°ï¼Œè€Œå®é™…ä¸Šåªè¿”å› <code>LIMIT</code> è¦æ±‚çš„ç»“æœé›†ã€‚å¯ä»¥é€šè¿‡å‡½æ•° <code>FOUND_ROW()</code> è·å–è¿™ä¸ªå€¼ã€‚</p>
</dd>
<dt class="hdlist1">FOR UPDATE å’Œ LOCK IN SHARE MODE</dt>
<dd>
<p>ä¸»è¦æ§åˆ¶ <code>SELECT</code> è¯­å¥çš„é”æœºåˆ¶ï¼Œä½†åªå¯¹å®ç°äº†è¡Œçº§é”çš„å­˜å‚¨å¼•æ“æœ‰æ•ˆã€‚è¯¥æç¤ºä¼šå¯¹ç¬¦åˆæŸ¥è¯¢æ¡ä»¶çš„æ•°æ®è¡ŒåŠ é”ã€‚å¯¹ <code>INSERT&#8230;&#8203;SELECT</code> è¯­å¥åœ¨ MySQL 5.0 å’Œæ›´æ–°ç‰ˆæœ¬ä¼šé»˜è®¤ç»™è¿™äº›è®°å½•åŠ ä¸Šé”ã€‚</p>
<div class="paragraph">
<p>å”¯ä¸€å†…ç½®çš„æ”¯æŒè¿™ä¸¤ä¸ªæç¤ºçš„å¼•æ“å°±æ˜¯ InnoDBã€‚è¿™ä¸¤ä¸ªæç¤ºä¼šè®©æŸäº›ä¼˜åŒ–æ— æ³•æ­£å¸¸ä½¿ç”¨ï¼Œä¾‹å¦‚ç´¢å¼•è¦†ç›–æ‰«æã€‚InnoDB ä¸èƒ½åœ¨ä¸è®¿é—®ä¸»é”®çš„æƒ…å†µä¸‹æ’ä»–æ€§åœ°é”å®šè¡Œï¼Œå› ä¸ºè¡Œçš„ç‰ˆæœ¬ä¿¡æ¯ä¿å­˜åœ¨ä¸»é”®ä¸­ã€‚</p>
</div>
</dd>
<dt class="hdlist1">USE INDEXã€IGNORE INDEX å’Œ FORCE INDEX</dt>
<dd>
<p>å‘Šè¯‰ä¼˜åŒ–å™¨ä½¿ç”¨æˆ–è€…ä¸ä½¿ç”¨å“ªäº›ç´¢å¼•æ¥æŸ¥è¯¢è®°å½•ã€‚åœ¨ MySQL 5.1 å’Œä¹‹åçš„ç‰ˆæœ¬å¯ä»¥é€šè¿‡æ–°å¢é€‰é¡¹ <code>FOR ORDER BY</code> å’Œ <code>FOR GROUP BY</code> æ¥æŒ‡å®šæ˜¯å¦å¯¹æ’åºå’Œåˆ†ç»„æœ‰æ•ˆã€‚</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>åœ¨ MySQL 5.0 å’Œæ›´æ–°ç‰ˆæœ¬ä¸­ï¼Œæ–°å¢äº†ä¸€äº›å‚æ•°ç”¨æ¥æ§åˆ¶ä¼˜åŒ–å™¨çš„è¡Œä¸ºï¼š</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">optimizer_search_depth</dt>
<dd>
<p>æ§åˆ¶ä¼˜åŒ–å™¨åœ¨ç©·ä¸¾æ‰§è¡Œè®¡åˆ’æ—¶çš„é™åº¦ã€‚å¦‚æœæŸ¥è¯¢é•¿æ—¶é—´å¤„äº â€œStatisticsâ€ çŠ¶æ€ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘è°ƒä½æ­¤å‚æ•°ã€‚</p>
</dd>
<dt class="hdlist1">optimizer_prune_level</dt>
<dd>
<p>é»˜è®¤æ‰“å¼€ã€‚è®©ä¼˜åŒ–å™¨æ ¹æ®éœ€è¦æ‰«æçš„è¡Œæ•°æ¥å†³å®šæ˜¯å¦è·³è¿‡æŸäº›æ‰§è¡Œè®¡åˆ’ã€‚</p>
</dd>
<dt class="hdlist1">optimizer_switch</dt>
<dd>
<p>åŒ…å«äº†ä¸€äº›å¼€å¯/å…³é—­ä¼˜åŒ–å™¨ç‰¹æ€§çš„æ ‡å¿—ä½ã€‚</p>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">MySQL å‡çº§åçš„éªŒè¯</div>
<div class="paragraph">
<p>åœ¨ä¼˜åŒ–å™¨é¢å‰è€ä¸€äº›â€œå°èªæ˜â€æ˜¯ä¸å¥½çš„ã€‚è®¾ç½®çš„â€œä¼˜åŒ–å™¨æç¤ºâ€å¾ˆå¯èƒ½ä¼šè®©æ–°ç‰ˆçš„ä¼˜åŒ–ç­–ç•¥å¤±æ•ˆã€‚</p>
</div>
<div class="paragraph">
<p>åœ¨ MySQL 5.6 ä¸­ï¼Œä¼˜åŒ–å™¨çš„æ”¹è¿›ä¹Ÿæ˜¯è¿‘äº›å¹´æ¥æœ€å¤§çš„ä¸€æ¬¡æ”¹è¿›ã€‚</p>
</div>
<div class="paragraph">
<p>å‡çº§æ“ä½œå»ºè®®ä»”ç»†æ£€æŸ¥å„ä¸ªç»†èŠ‚ï¼Œä»¥é˜²æ­¢ä¸€äº›è¾¹ç•Œæƒ…å†µå½±å“ä½ çš„åº”ç”¨ç¨‹åºã€‚</p>
</div>
<div class="paragraph">
<p>ä½¿ç”¨ Percona Toolkit ä¸­çš„ <code>pt-upgrade</code> å·¥å…·ï¼Œå°±å¯ä»¥æ£€æŸ¥åœ¨æ–°ç‰ˆä¸­è¿è¡Œçš„ SQL æ˜¯å¦ä¸è€ç‰ˆæœ¬ä¸€æ ·ï¼Œè¿”å›ç›¸åŒçš„ç»“æœã€‚</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ä¼˜åŒ–ç‰¹å®šç±»å‹çš„æŸ¥è¯¢">3.7. ä¼˜åŒ–ç‰¹å®šç±»å‹çš„æŸ¥è¯¢</h3>
<div class="sect3">
<h4 id="_ä¼˜åŒ–_code_count_code_æŸ¥è¯¢">3.7.1. ä¼˜åŒ– <code>COUNT()</code> æŸ¥è¯¢</h4>
<div class="sect4">
<h5 id="__code_count_code_çš„ä½œç”¨">3.7.1.1. <code>COUNT()</code> çš„ä½œç”¨</h5>
<div class="paragraph">
<p><code>COUNT()</code> æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ï¼Œæœ‰ä¸¤ç§éå¸¸ä¸åŒçš„ä½œç”¨ï¼šå¯ä»¥ç»Ÿè®¡æŸä¸ªåˆ—å€¼çš„æ•°é‡ï¼Œä¹Ÿå¯ä»¥ç»Ÿè®¡è¡Œæ•°ã€‚åœ¨ç»Ÿè®¡åˆ—å€¼æ—¶è¦æ±‚æ˜¯éç©ºçš„ï¼ˆä¸ç»Ÿè®¡ <code>NULL</code>ï¼‰ã€‚</p>
</div>
<div class="paragraph">
<p>å½“ MySQL ç¡®è®¤æ‹¬å·å†…çš„è¡¨è¾¾å¼å€¼ä¸å¯èƒ½ä¸ºç©ºæ—¶ï¼Œå®é™…å°±æ˜¯åœ¨ç»Ÿè®¡è¡Œæ•°ã€‚ <code>COUNT(*)</code> ä¸ä¼šæ‰©å±•æˆæ‰€æœ‰çš„åˆ—ï¼›å®ƒä¼šå¿½ç•¥æ‰€æœ‰çš„åˆ—è€Œç›´æ¥ç»Ÿè®¡æ‰€æœ‰çš„è¡Œæ•°ã€‚</p>
</div>
<div class="paragraph">
<p>ä¸€ä¸ªå¸¸è§é”™è¯¯æ˜¯ï¼šåœ¨æ‹¬å·å†…æŒ‡å®šäº†ä¸€ä¸ªåˆ—å´å¸Œæœ›ç»Ÿè®¡ç»“æœé›†çš„è¡Œæ•°ã€‚å¦‚æœç»Ÿè®¡ç»“æœé›†çš„è¡Œæ•°ï¼Œæœ€å¥½ä½¿ç”¨ <code>COUNT(*)</code> ï¼Œæ„ä¹‰æ¸…æ™°ï¼Œæ€§èƒ½ä¹Ÿå¾ˆå¥½ã€‚</p>
</div>
</div>
<div class="sect4">
<h5 id="_å…³äº_myisam_çš„ç¥è¯">3.7.1.2. å…³äº MyISAM çš„ç¥è¯</h5>
<div class="paragraph">
<p>ä¸€ä¸ªå®¹æ˜“äº§ç”Ÿçš„è¯¯è§£ï¼šMyISAM çš„ <code>COUNT()</code> å‡½æ•°æ€»æ˜¯éå¸¸å¿«ï¼Œä¸è¿‡è¿™æ˜¯æœ‰å‰ææ¡ä»¶çš„ï¼Œå³åªæœ‰æ²¡æœ‰ä»»ä½• <code>WHERE</code> æ¡ä»¶çš„ <code>COUNT(*)</code> æ‰éå¸¸å¿«ã€‚MySQL åˆ©ç”¨å­˜å‚¨å¼•æ“çš„ç‰¹æ€§ç›´æ¥è·å–è¿™ä¸ªå€¼ã€‚</p>
</div>
<div class="paragraph">
<p>å¦‚æœ MySQL çŸ¥é“æŸä¸ªåˆ— col ä¸å¯èƒ½ä¸º <code>NULL</code> å€¼ï¼Œé‚£ä¹ˆ MySQL å†…éƒ¨ä¼šå°† <code>COUNT(col)</code> è¡¨è¾¾å¼è½¬åŒ–ä¸º <code>COUNT(*)</code>ã€‚</p>
</div>
<div class="paragraph">
<p>å½“ç»Ÿè®¡å¸¦ <code>WHERE</code> å­å¥çš„ç»“æœé›†è¡Œæ•°ï¼Œå¯ä»¥æ˜¯ç»Ÿè®¡æŸä¸ªåˆ—å€¼çš„æ•°é‡æ—¶ï¼ŒMyISAM çš„ <code>COUNT()</code> å’Œå…¶ä»–å­˜å‚¨å¼•æ“æ²¡æœ‰ä»»ä½•ä¸åŒã€‚</p>
</div>
</div>
<div class="sect4">
<h5 id="_ç®€å•çš„ä¼˜åŒ–">3.7.1.3. ç®€å•çš„ä¼˜åŒ–</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="comment">-- ä¹¦ä¸­æ²¡æœ‰å»ºè¡¨è¯­å¥ï¼Œæ ¹æ®ä¸Šä¸‹æ–‡ SQL åˆ›å»º</span>
<span class="class">DROP</span> <span class="type">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> city;
<span class="class">CREATE</span> <span class="type">TABLE</span> city (
  id   <span class="predefined-type">INTEGER</span> <span class="directive">AUTO_INCREMENT</span> <span class="directive">PRIMARY</span> <span class="type">KEY</span>,
  name <span class="predefined-type">VARCHAR</span>(<span class="integer">100</span>) <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>
) <span class="directive">ENGINE</span> = MyISAM;

<span class="comment">-- æ²¡æœ‰ä¼˜åŒ–çš„ SQLï¼Œéœ€è¦æ‰«æå¤§å¤šæ•°è¡Œ</span>
<span class="class">SELECT</span> <span class="predefined">COUNT</span>(*)
<span class="keyword">FROM</span> city
<span class="keyword">WHERE</span> id &gt; <span class="integer">5</span>;

<span class="comment">-- ä¼˜åŒ–åçš„ SQLï¼Œåªéœ€è¦æ‰«æå°‘é‡çš„è¡Œ</span>
<span class="class">SELECT</span> (<span class="class">SELECT</span> <span class="predefined">COUNT</span>(*)
        <span class="keyword">FROM</span> city) - <span class="predefined">COUNT</span>(*)
<span class="keyword">FROM</span> city
<span class="keyword">WHERE</span> id &lt;= <span class="integer">5</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>åœ¨åŒä¸€ä¸ªæŸ¥è¯¢ä¸­ç»Ÿè®¡åŒä¸€åˆ—çš„ä¸åŒå€¼çš„æ•°é‡ï¼Œä»¥å‡å°‘æŸ¥è¯¢çš„è¯­å¥é‡ã€‚å¯ä»¥è¿™æ ·ï¼š</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">DROP</span> <span class="type">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> items;
<span class="class">CREATE</span> <span class="type">TABLE</span> items (
  id    <span class="predefined-type">INTEGER</span> <span class="directive">AUTO_INCREMENT</span> <span class="directive">PRIMARY</span> <span class="type">KEY</span>,
  color <span class="predefined-type">VARCHAR</span>(<span class="integer">50</span>)
);

<span class="class">SELECT</span>
  <span class="predefined">SUM</span>(<span class="keyword">IF</span>(color = <span class="string"><span class="delimiter">'</span><span class="content">blue</span><span class="delimiter">'</span></span>, <span class="integer">1</span>, <span class="integer">0</span>)) <span class="keyword">AS</span> blue,
  <span class="predefined">SUM</span>(<span class="keyword">IF</span>(color = <span class="string"><span class="delimiter">'</span><span class="content">red</span><span class="delimiter">'</span></span>, <span class="integer">1</span>, <span class="integer">0</span>))  <span class="keyword">AS</span> red
<span class="keyword">FROM</span> items;

<span class="class">SELECT</span>
  <span class="predefined">COUNT</span>(color = <span class="string"><span class="delimiter">'</span><span class="content">blue</span><span class="delimiter">'</span></span> <span class="keyword">OR</span> <span class="predefined-constant">NULL</span>) <span class="keyword">AS</span> blue,
  <span class="predefined">COUNT</span>(color = <span class="string"><span class="delimiter">'</span><span class="content">red</span><span class="delimiter">'</span></span> <span class="keyword">OR</span> <span class="predefined-constant">NULL</span>)  <span class="keyword">AS</span> red
<span class="keyword">FROM</span> items;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ä½¿ç”¨è¿‘ä¼¼å€¼">3.7.1.4. ä½¿ç”¨è¿‘ä¼¼å€¼</h5>
<div class="paragraph">
<p>æœ‰æ—¶å€™æŸäº›ä¸šåŠ¡åœºæ™¯å¹¶ä¸è¦æ±‚å®Œå…¨ç²¾ç¡®çš„ <code>COUNT</code> å€¼ï¼Œæ­¤æ—¶å¯ä»¥ç”¨è¿‘ä¼¼å€¼ä»£æ›¿ã€‚<code>EXPLAIN</code> å‡ºæ¥çš„ä¼˜åŒ–å™¨ä¼°ç®—çš„è¡Œæ•°å°±æ˜¯ä¸€ä¸ªä¸é”™çš„è¿‘ä¼¼å€¼ï¼Œæ‰§è¡Œ <code>EXPLAIN</code> å¹¶ä¸éœ€è¦çœŸæ­£åœ°å»æ‰§è¡ŒæŸ¥è¯¢ï¼Œæ‰€ä»¥æˆæœ¬å¾ˆä½ã€‚</p>
</div>
<div class="paragraph">
<p>å¾ˆå¤šæ—¶å€™ï¼Œè®¡ç®—ç²¾ç¡®å€¼çš„æˆæœ¬éå¸¸é«˜ï¼Œè€Œè®¡ç®—è¿‘ä¼¼å€¼åˆ™éå¸¸ç®€å•ã€‚ä¾‹å¦‚ç»Ÿè®¡ç½‘ç«™çš„å½“å‰æ´»è·ƒç”¨æˆ·æ•°ã€‚</p>
</div>
</div>
<div class="sect4">
<h5 id="_æ›´å¤æ‚çš„ä¼˜åŒ–">3.7.1.5. æ›´å¤æ‚çš„ä¼˜åŒ–</h5>
<div class="paragraph">
<p>é€šå¸¸æ¥è¯´ï¼Œ <code>COUNT()</code> éƒ½éœ€è¦æ‰«æå¤§é‡çš„è¡Œæ‰èƒ½è·å–ç²¾ç¡®çš„ç»“æœï¼Œå› æ­¤å¾ˆéš¾ä¼˜åŒ–ã€‚é™¤äº†ä¸Šé¢çš„æ–¹æ³•ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ç´¢å¼•è¦†ç›–æ‰«æã€‚</p>
</div>
<div class="paragraph">
<p>å¦‚æœè¿™è¿˜ä¸å¤Ÿï¼Œå°±éœ€è¦è€ƒè™‘ä¿®æ”¹åº”ç”¨çš„æ¶æ„ï¼Œå¯ä»¥å¢åŠ æ±‡æ€»è¡¨ï¼Œæˆ–è€…å¢åŠ ç±»ä¼¼ Memcached è¿™æ ·çš„å¤–éƒ¨ç¼“å­˜ç³»ç»Ÿã€‚å¾ˆå¿«å‘ç°é™·å…¥ä¸€ä¸ªå›°å¢ƒï¼Œâ€œå¿«é€Ÿï¼Œç²¾ç¡®å’Œå®ç°ç®€å•â€ï¼Œä¸‰è€…æ°¸è¿œåªèƒ½æ»¡è¶³å…¶äºŒï¼Œå¿…é¡»èˆæ‰å…¶ä¸­ä¹‹ä¸€ã€‚</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ä¼˜åŒ–å…³è”æŸ¥è¯¢">3.7.2. ä¼˜åŒ–å…³è”æŸ¥è¯¢</h4>
<div class="ulist">
<ul>
<li>
<p>ç¡®ä¿ <code>ON</code> æˆ–è€… <code>USING</code> å­å¥çš„åˆ—ä¸Šæœ‰ç´¢å¼•ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé™¤éæœ‰å…¶ä»–ç†ç”±ï¼Œå¦åˆ™åªéœ€è¦åœ¨å…³è”é¡ºåºä¸­çš„ç¬¬äºŒä¸ªè¡¨çš„ç›¸åº”åˆ—ä¸Šåˆ›å»ºç´¢å¼•ã€‚</p>
</li>
<li>
<p>ç¡®ä¿ä»»ä½•çš„ <code>GROUP BY</code> å’Œ <code>ORDER BY</code> ä¸­çš„è¡¨è¾¾å¼åªæ¶‰åŠåˆ°ä¸€ä¸ªè¡¨ä¸­çš„åˆ—ï¼Œè¿™æ · MySQL æ‰æœ‰å¯èƒ½ä½¿ç”¨ç´¢å¼•æ¥ä¼˜åŒ–è¿™ä¸ªè¿‡ç¨‹ã€‚</p>
</li>
<li>
<p>å½“å‡çº§ MySQL çš„æ—¶å€™éœ€è¦æ³¨æ„ï¼šå…³è”è¯­æ³•ã€è¿ç®—ç¬¦ä¼˜å…ˆçº§ç­‰å…¶ä»–å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–çš„åœ°æ–¹ã€‚</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_ä¼˜åŒ–å­æŸ¥è¯¢">3.7.3. ä¼˜åŒ–å­æŸ¥è¯¢</h4>
<div class="paragraph">
<p>å­æŸ¥è¯¢ä¼˜åŒ–æœ€é‡è¦çš„ä¼˜åŒ–å»ºè®®æ˜¯å°½å¯èƒ½ä½¿ç”¨å…³è”æŸ¥è¯¢ä»£æ›¿ï¼Œè‡³å°‘å½“å‰çš„ MySQL ç‰ˆæœ¬éœ€è¦è¿™æ ·ã€‚</p>
</div>
<div class="paragraph">
<p>ä½¿ç”¨ MySQL 5.6 æˆ–è€…æ›´æ–°çš„ç‰ˆæœ¬æˆ–è€… MariaDBï¼Œåˆ™å¯ä»¥å¿½ç•¥è¿™ä¸ªå»ºè®®ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_ä¼˜åŒ–_code_group_by_code_å’Œ_code_distinct_code">3.7.4. ä¼˜åŒ– <code>GROUP BY</code> å’Œ <code>DISTINCT</code></h4>
<div class="paragraph">
<p>å®ƒä»¬éƒ½å¯ä»¥ä½¿ç”¨ç´¢å¼•æ¥ä¼˜åŒ–ï¼Œè¿™ä¹Ÿæ˜¯æœ€æœ‰æ•ˆçš„ä¼˜åŒ–åŠæ³•ã€‚</p>
</div>
<div class="paragraph">
<p>åœ¨ MySQL ä¸­ï¼Œå½“æ— æ³•ä½¿ç”¨ç´¢å¼•çš„æ—¶å€™ï¼Œ <code>GROUP BY</code> ä½¿ç”¨ä¸¤ç§ç­–ç•¥æ¥å®Œæˆï¼šä½¿ç”¨ä¸´æ—¶è¡¨æˆ–è€…æ–‡ä»¶æ’åºæ¥åˆ†ç»„ã€‚</p>
</div>
<div class="paragraph">
<p>å¦‚æœéœ€è¦å¯¹å…³è”æŸ¥è¯¢åšåˆ†ç»„ï¼Œå¹¶ä¸”æ˜¯æŒ‰ç…§æŸ¥æ‰¾è¡¨ä¸­çš„æŸä¸ªåˆ—è¿›è¡Œåˆ†ç»„ï¼Œé‚£ä¹ˆé€šå¸¸é‡‡ç”¨æŸ¥æ‰¾è¡¨çš„æ ‡è¯†åˆ—åˆ†ç»„çš„æ•ˆæœä¼šæ¯”å…¶ä»–åˆ—æ›´é«˜ã€‚ä¾‹å¦‚ï¼š</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="comment">-- è¿™ä¸ªæŸ¥è¯¢æ•ˆç‡ä¸ä¼šå¾ˆå¥½</span>
<span class="class">SELECT</span>
  actor.first_name,
  actor.last_name,
  <span class="predefined">COUNT</span>(*)
<span class="keyword">FROM</span> film_actor
  <span class="keyword">INNER</span> <span class="keyword">JOIN</span> actor <span class="keyword">USING</span> (actor_id)
<span class="keyword">GROUP</span> <span class="keyword">BY</span> actor.first_name, actor.last_name;

<span class="comment">-- è¿™ä¸ªæŸ¥è¯¢çš„æ•ˆç‡æ›´é«˜</span>
<span class="class">SELECT</span>
  actor.first_name,
  actor.last_name,
  <span class="predefined">COUNT</span>(*)
<span class="keyword">FROM</span> film_actor
  <span class="keyword">INNER</span> <span class="keyword">JOIN</span> actor <span class="keyword">USING</span> (actor_id)
<span class="keyword">GROUP</span> <span class="keyword">BY</span> film_actor.actor_id;</code></pre>
</div>
</div>
<div class="paragraph">
<p>å»ºè®®å§‹ç»ˆä½¿ç”¨å«ä¹‰æ˜ç¡®çš„è¯­æ³•ã€‚</p>
</div>
<div class="paragraph">
<p>å¦‚æœå¯†é’¥é€šè¿‡ <code>ORDER BY</code> å­å¥æ˜¾å¼åœ°æŒ‡å®šæ‹åºåˆ—ï¼Œå½“æŸ¥è¯¢ä½¿ç”¨ <code>GROUP BY</code> å­å¥çš„æ—¶å€™ï¼Œç»“æœé›†ä¼šè‡ªåŠ¨æŒ‰ç…§åˆ†ç»„çš„å­—æ®µè¿›è¡Œæ’åºã€‚å¦‚æœä¸å…³å¿ƒç»“æœé›†çš„é¡ºåºï¼Œåˆ™å¯ä»¥ä½¿ç”¨ <code>ORDER BY NULL</code>ï¼Œè®© MySQL ä¸å†è¿›è¡Œæ–‡ä»¶æ’åºã€‚ä¹Ÿå¯ä»¥åœ¨ <code>GROUP BY</code> å­å¥ä¸­ç›´æ¥ä½¿ç”¨ <code>DESC</code> å’Œ <code>ASC</code> å…³é”®å­—ï¼Œä½¿åˆ†ç»„çš„ç»“æœé›†æŒ‰éœ€è¦çš„æ–¹å‘æ’åºã€‚</p>
</div>
<div class="sect4">
<h5 id="_ä¼˜åŒ–_code_group_by_with_rollup_code">3.7.4.1. ä¼˜åŒ– <code>GROUP BY WITH ROLLUP</code></h5>
<div class="paragraph">
<p>åˆ†ç»„æŸ¥è¯¢çš„ä¸€ä¸ªå˜ç§å°±æ˜¯è¦æ±‚ MySQL å¯¹è¿”å›çš„åˆ†ç»„ç»“æœå†åšä¸€æ¬¡è¶…çº§èšåˆã€‚å¯ä»¥ä½¿ç”¨ <code>WITH ROLLUP</code> å­å¥æ¥å®ç°ï¼Œä½†å¯èƒ½ä¸å¤Ÿä¼˜åŒ–ã€‚</p>
</div>
<div class="paragraph">
<p>æœ€å¥½çš„åŠæ³•æ˜¯å°½å¯èƒ½çš„å°† <code>WITH ROLLUP</code> åŠŸèƒ½è½¬ç§»åˆ°åº”ç”¨ç¨‹åºä¸­å¤„ç†ã€‚</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ä¼˜åŒ–_code_limit_code_åˆ†é¡µ">3.7.5. ä¼˜åŒ– <code>LIMIT</code> åˆ†é¡µ</h4>
<div class="paragraph">
<p>ä¸€ä¸ªéå¸¸å¸¸è§åˆä»¤äººå¤´ç–¼çš„é—®é¢˜å°±æ˜¯ï¼Œåœ¨åç§»é‡éå¸¸å¤§çš„æ—¶å€™ï¼ŒæŸ¥è¯¢ä»£ä»·éå¸¸é«˜ã€‚è¦ä¼˜åŒ–è¿™ç§æŸ¥è¯¢ï¼Œè¦ä¹ˆæ˜¯åœ¨é¡µé¢ä¸­é™åˆ¶åˆ†é¡µçš„æ•°é‡ï¼Œè¦ä¹ˆæ˜¯ä¼˜åŒ–å¤§åç§»é‡çš„æ€§èƒ½ã€‚</p>
</div>
<div class="paragraph">
<p>ä¼˜åŒ–æ­¤ç±»åˆ†é¡µæŸ¥è¯¢çš„ä¸€ä¸ªæœ€ç®€å•çš„åŠæ³•å°±æ˜¯å°½å¯èƒ½ä½¿ç”¨ç´¢å¼•è¦†ç›–æ‰«æï¼Œè€Œä¸æ˜¯æŸ¥è¯¢æ‰€æœ‰çš„åˆ—ã€‚ç„¶åæ ¹æ®éœ€è¦åšä¸€æ¬¡å…³è”æ“ä½œå†è¿”å›æ‰€éœ€è¦çš„åˆ—ã€‚å¯¹äºåç§»é‡å¾ˆå¤§çš„æ—¶å€™ï¼Œè¿™æ ·åšçš„æ•ˆç‡ä¼šæå‡éå¸¸å¤§ã€‚</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="comment">-- æ•ˆç‡ä¸€èˆ¬</span>
<span class="class">SELECT</span>
  film_id,
  description
<span class="keyword">FROM</span> film
<span class="keyword">ORDER</span> <span class="keyword">BY</span> title
LIMIT <span class="integer">50</span>, <span class="integer">5</span>;

<span class="comment">-- å»¶è¿Ÿå…³è”ï¼Œå¤§å¤§æå‡æŸ¥è¯¢æ•ˆç‡</span>
<span class="class">SELECT</span>
  film_id,
  description
<span class="keyword">FROM</span> film
  <span class="keyword">INNER</span> <span class="keyword">JOIN</span> (
       <span class="class">SELECT</span> film_id
       <span class="keyword">FROM</span> film
       <span class="keyword">ORDER</span> <span class="keyword">BY</span> title
       LIMIT <span class="integer">50</span>, <span class="integer">5</span>
     ) <span class="keyword">AS</span> lim <span class="keyword">USING</span> (film_id);</code></pre>
</div>
</div>
<div class="paragraph">
<p>æœ‰æ—¶å€™ä¹Ÿå¯ä»¥å°† <code>LIMIT</code> æŸ¥è¯¢è½¬æ¢ä¸ºå·²çŸ¥ä½ç½®çš„æŸ¥è¯¢ï¼Œè®© MySQL é€šè¿‡èŒƒå›´æ‰«æè·å¾—åˆ°å¯¹åº”çš„ç»“æœã€‚</p>
</div>
<div class="paragraph">
<p><code>LIMIT</code> å’Œ <code>OFFSET</code> çš„é—®é¢˜ï¼Œå…¶å®æ˜¯ <code>OFFSET</code> çš„é—®é¢˜ï¼Œå®ƒä¼šå¯¼è‡´ MySQL æ‰«æå¤§é‡ä¸éœ€è¦çš„è¡Œç„¶ååœ¨æŠ›å¼ƒæ‰ã€‚å¦‚æœå¯ä»¥ä½¿ç”¨ä¹¦ç­¾è®°å½•ä¸Šæ¬¡æ•°æ®çš„ä½ç½®ï¼Œé‚£ä¹ˆä¸‹æ¬¡å°±å¯ä»¥ç›´æ¥ä»è¯¥ä¹¦ç­¾è®°å½•çš„ä½ç½®å¼€å§‹æ‰«æï¼Œè¿™æ ·å°±å¯ä»¥é¿å…ä½¿ç”¨ <code>OFFSET</code>ã€‚</p>
</div>
<div class="paragraph">
<p>å…¶ä»–ä¼˜åŒ–æ–¹æ³•è¿˜åŒ…æ‹¬ä½¿ç”¨é¢„å…ˆè®¡ç®—çš„æ±‡æ€»è¡¨ï¼Œæˆ–è€…å…³è”åˆ°ä¸€ä¸ªå†—ä½™è¡¨ï¼Œå†—ä½™è¡¨å€¼åŒ…å«ä¸»é”®åˆ—å’Œéœ€è¦åšæ’åºçš„æ•°æ®åˆ—ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_ä¼˜åŒ–_code_sql_calc_found_rows_code">3.7.6. ä¼˜åŒ– <code>SQL_CALC_FOUND_ROWS</code></h4>
<div class="paragraph">
<p>åˆ†é¡µçš„æ—¶å€™ï¼Œå¦å¤–ä¸€ä¸ªå¸¸ç”¨çš„æŠ€å·§æ˜¯åœ¨ <code>LIMIT</code> è¯­å¥ä¸­åŠ ä¸Š <code>SQL_CALC_FOUND_ROWS</code> æç¤ºï¼Œè¿™æ ·å°±å¯ä»¥è·å¾—å»æ‰ <code>LIMIT</code> ä»¥åæ»¡è¶³æ¡ä»¶çš„è¡Œæ•°ï¼Œå› æ­¤å¯ä»¥ä½œä¸ºåˆ†é¡µçš„æ€»æ•°ã€‚åŠ ä¸Šè¯¥æç¤ºï¼ŒMySQL éƒ½ä¼šæ‰«ææ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„è¡Œå†æŠ›å¼ƒä¸éœ€è¦çš„è¡Œï¼Œä»£ä»·éå¸¸é«˜ã€‚</p>
</div>
<div class="paragraph">
<p>ä¸€ä¸ªæ›´å¥½çš„è®¾è®¡æ˜¯å°†å…·ä½“çš„é¡µæ•°æ¢æˆâ€œä¸‹ä¸€é¡µâ€æŒ‰é’®ï¼Œè¿™æ ·åªéœ€è¦ä¸‹ä¸€é¡µçš„æ˜¯å¦æœ‰æ•°æ®ï¼Œå°±å†³å®šæ˜¯å¦æ˜¾ç¤ºâ€œä¸‹ä¸€é¡µâ€æŒ‰é’®ã€‚</p>
</div>
<div class="paragraph">
<p>å¦å¤–ä¸€ç§åšæ³•æ˜¯å…ˆè·å–å¹¶ç¼“å­˜è¾ƒå¤šçš„æ•°æ®ï¼Œç„¶åæ¯æ¬¡åˆ†é¡µéƒ½ä»è¿™ä¸ªç¼“å­˜ä¸­è·å–ã€‚</p>
</div>
<div class="paragraph">
<p>æœ‰æ—¶å€™ä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨ <code>EXPLAIN</code> çš„ç»“æœä¸­çš„ <code>rows</code> åˆ—çš„å€¼ä½œä¸ºç»“æœé›†æ€»æ•°çš„è¿‘ä¼¼å€¼ã€‚å½“éœ€è¦ä½¿ç”¨ç²¾ç¡®å€¼æ—¶ï¼Œå†å•ç‹¬ä½¿ç”¨ <code>COUNT(*)</code> æ¥æ»¡è¶³éœ€æ±‚ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_ä¼˜åŒ–_code_union_code_æŸ¥è¯¢">3.7.7. ä¼˜åŒ– <code>UNION</code> æŸ¥è¯¢</h4>
<div class="paragraph">
<p>MySQL æ€»æ˜¯é€šè¿‡åˆ›å»ºå¹¶å¡«å……ä¸´æ—¶è¡¨çš„æ–¹å¼æ¥æ‰§è¡Œ <code>UNION</code> æŸ¥è¯¢ã€‚ç»å¸¸éœ€è¦æ‰‹åŠ¨å°† <code>WHERE</code>ã€<code>LIMIT</code>ã€<code>ORDER BY</code> ç­‰å­å¥ä¸‹æ¨åˆ° <code>UNION</code> çš„å„ä¸ªå­æŸ¥è¯¢ä¸­ï¼Œä»¥ä¾¿ä¼˜åŒ–å™¨å¯ä»¥å……åˆ†åˆ©ç”¨è¿™äº›æ¡ä»¶è¿›è¡Œä¼˜åŒ–ã€‚</p>
</div>
<div class="paragraph">
<p>é™¤éç¡®å®éœ€è¦æœåŠ¡å™¨æ¶ˆé™¤é‡å¤çš„è¡Œï¼Œå¦åˆ™å°±ä¸€å®šè¦ä½¿ç”¨ <code>UNION ALL</code>ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_é™æ€æŸ¥è¯¢åˆ†æ">3.7.8. é™æ€æŸ¥è¯¢åˆ†æ</h4>
<div class="paragraph">
<p>Percona Toolkit ä¸­çš„ <code>pt-query-advisor</code> èƒ½å¤Ÿè§£ææŸ¥è¯¢æ—¥å¿—ã€åˆ†ææŸ¥è¯¢æ¨¡å¼ï¼Œç„¶åç»™å‡ºæ‰€æœ‰å¯èƒ½å­˜åœ¨æ½œåœ¨é—®é¢˜çš„æŸ¥è¯¢ï¼Œå¹¶ç»™å‡ºè¶³å¤Ÿè¯¦ç»†çš„å»ºè®®ã€‚</p>
</div>
</div>
<div class="sect3">
<h4 id="_ä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰å˜é‡">3.7.9. ä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰å˜é‡</h4>
<div class="paragraph">
<p><em>å¾…è¡¥å……</em></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_æ¡ˆä¾‹å­¦ä¹ ">3.8. æ¡ˆä¾‹å­¦ä¹ </h3>
<div class="paragraph">
<p><em>å¾…è¡¥å……</em></p>
</div>
<div class="sect3">
<h4 id="_ä½¿ç”¨_mysql_æ„å»ºä¸€ä¸ªé˜Ÿåˆ—è¡¨">3.8.1. ä½¿ç”¨ MySQL æ„å»ºä¸€ä¸ªé˜Ÿåˆ—è¡¨</h4>

</div>
<div class="sect3">
<h4 id="_è®¡ç®—ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»">3.8.2. è®¡ç®—ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»</h4>

</div>
<div class="sect3">
<h4 id="_ä½¿ç”¨ç”¨æˆ·å®šä¹‰å‡½æ•°">3.8.3. ä½¿ç”¨ç”¨æˆ·å®šä¹‰å‡½æ•°</h4>

</div>
</div>
<div class="sect2">
<h3 id="_æ€»ç»“_3">3.9. æ€»ç»“</h3>
<div class="paragraph">
<p>è¦æƒ³å†™ä¸€ä¸ªå¥½çš„æŸ¥è¯¢ï¼Œä½ å¿…é¡»ç†è§£ Schema è®¾è®¡ã€ç´¢å¼•è®¾è®¡ç­‰ï¼Œåä¹‹äº¦ç„¶ã€‚</p>
</div>
<div class="paragraph">
<p>ä¼˜åŒ–é€šå¸¸éƒ½éœ€è¦ä¸‰ç®¡é½ä¸‹ï¼šä¸åšã€å°‘åšã€å¿«é€Ÿåœ°åšã€‚</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mysql_code_explain_code_è¯¦è§£">4. MySQL <code>explain</code> è¯¦è§£</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>explain</code> è¯­æ³•</p>
</li>
<li>
<p><code>explain</code> è¾“å‡º</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>id</code></p>
</li>
<li>
<p><code>select_type</code></p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><code>SIMPLE</code></p>
</li>
<li>
<p><code>PRIMARY</code></p>
</li>
<li>
<p><code>UNION</code></p>
</li>
<li>
<p><code>DEPENDENT UNION</code></p>
</li>
<li>
<p><code>UNION RESULT</code></p>
</li>
<li>
<p><code>SUBQUERY</code></p>
</li>
<li>
<p><code>DEPENDENT SUBQUERY</code></p>
</li>
<li>
<p><code>DERIVED</code></p>
</li>
<li>
<p><code>MATERIALIZED</code></p>
</li>
<li>
<p><code>UNCACHEABLE SUBQUERY</code></p>
</li>
<li>
<p><code>UNCACHEABLE UNION</code></p>
</li>
</ol>
</div>
</li>
<li>
<p><code>table</code></p>
</li>
<li>
<p><code>partitions</code></p>
</li>
<li>
<p><code>type</code></p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><code>system</code></p>
</li>
<li>
<p><code>const</code></p>
</li>
<li>
<p><code>eq_ref</code></p>
</li>
<li>
<p><code>ref</code></p>
</li>
<li>
<p><code>fulltext</code></p>
</li>
<li>
<p><code>ref_or_null</code></p>
</li>
<li>
<p><code>index_merge</code></p>
</li>
<li>
<p><code>unique_subquery</code></p>
</li>
<li>
<p><code>index_subquery</code></p>
</li>
<li>
<p><code>range</code></p>
</li>
<li>
<p><code>index</code></p>
</li>
<li>
<p><code>ALL</code></p>
</li>
</ol>
</div>
</li>
<li>
<p><code>possible_keys</code></p>
</li>
<li>
<p><code>key</code></p>
</li>
<li>
<p><code>key_len</code></p>
</li>
<li>
<p><code>ref</code></p>
</li>
<li>
<p><code>rows</code></p>
</li>
<li>
<p><code>filtered</code></p>
</li>
<li>
<p><code>extra</code></p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><code>Child of 'table' pushed join@1</code></p>
</li>
<li>
<p><code>const row not found</code></p>
</li>
<li>
<p><code>Deleting all rows</code></p>
</li>
<li>
<p><code>Distinct</code></p>
</li>
<li>
<p><code>FirstMatch</code></p>
</li>
<li>
<p><code>Full scan on NULL key</code></p>
</li>
<li>
<p><code>Impossible HAVING</code></p>
</li>
<li>
<p><code>Impossible WHERE</code></p>
</li>
<li>
<p><code>Impossible WHERE noticed after reading const tables</code></p>
</li>
<li>
<p><code>LooseScan(m..n)</code></p>
</li>
<li>
<p><code>No matching min/max row</code></p>
</li>
<li>
<p><code>no matching row in const table</code></p>
</li>
<li>
<p><code>No matching rows after partition pruning</code></p>
</li>
<li>
<p><code>No tables used</code></p>
</li>
<li>
<p><code>Not exists</code></p>
</li>
<li>
<p><code>Plan isn&#8217;t ready yet</code></p>
</li>
<li>
<p><code>Range checked for each record (index map: N)</code></p>
</li>
<li>
<p><code>Scanned N databases</code></p>
</li>
<li>
<p><code>Select tables optimized away</code></p>
</li>
<li>
<p><code>Skip_open_table, Open_frm_only, Open_trigger_only, Open_full_table</code></p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p><code>Skip_open_table</code></p>
</li>
<li>
<p><code>Open_frm_only</code></p>
</li>
<li>
<p><code>Open_trigger_only</code></p>
</li>
<li>
<p><code>Open_full_table</code></p>
</li>
</ol>
</div>
</li>
<li>
<p><code>Start temporary, End temporary</code></p>
</li>
<li>
<p><code>unique row not found</code></p>
</li>
<li>
<p><code>Using filesort</code></p>
</li>
<li>
<p><code>Using index</code></p>
</li>
<li>
<p><code>Using index condition</code></p>
</li>
<li>
<p><code>Using index for group-by</code></p>
</li>
<li>
<p><code>Using join buffer (Block Nested Loop), Using join buffer (Batched Key Access)</code></p>
</li>
<li>
<p><code>Using MRR</code></p>
</li>
<li>
<p><code>Using sort_union(&#8230;&#8203;), Using union(&#8230;&#8203;), Using intersect(&#8230;&#8203;)</code></p>
</li>
<li>
<p><code>Using temporary</code></p>
</li>
<li>
<p><code>Using where</code></p>
</li>
<li>
<p><code>Using where with pushed condition</code></p>
</li>
<li>
<p><code>Zero limit</code></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="__code_explain_code_è¯­æ³•">4.1. <code>EXPLAIN</code> è¯­æ³•</h3>
<div class="paragraph">
<p><code>DESCRIBE</code> å’Œ <code>EXPLAIN</code> æ˜¯åŒä¹‰è¯ã€‚åœ¨å®è·µä¸­ï¼Œ<code>DESCRIBE</code> å¤šç”¨äºæ˜¾ç¤ºè¡¨ç»“æ„ï¼Œè€Œ <code>EXPLAIN</code> å¤šç”¨äºæ˜¾ç¤º SQL è¯­å¥çš„æ‰§è¡Œè®¡åˆ’ã€‚</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">{EXPLAIN | DESCRIBE | <span class="directive">DESC</span>}
    tbl_name [col_name | wild]

{EXPLAIN | DESCRIBE | <span class="directive">DESC</span>}
    [explain_type]
    {explainable_stmt | <span class="keyword">FOR</span> CONNECTION connection_id}

explain_type: {
    EXTENDED
  | PARTITIONS
  | FORMAT = format_name
}

format_name: {
    TRADITIONAL
  | JSON
}

explainable_stmt: {
    <span class="class">SELECT</span> statement
  | <span class="class">DELETE</span> statement
  | <span class="class">INSERT</span> statement
  | <span class="class">REPLACE</span> statement
  | <span class="class">UPDATE</span> statement
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">EXPLAIN FORMAT = JSON <span class="class">SELECT</span> <span class="keyword">DISTINCT</span> (m.user_id)
<span class="keyword">FROM</span> user_extdata m
<span class="keyword">WHERE</span> m.city_id <span class="keyword">IN</span> (<span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">3</span>, <span class="integer">4</span>) ;</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_è·å–è¡¨ç»“æ„">4.1.1. è·å–è¡¨ç»“æ„</h4>
<div class="paragraph">
<p><code>DESCRIBE</code> æ˜¯ <code>SHOW COLUMNS</code> çš„ç®€å†™å½¢å¼ã€‚</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="__code_explain_code_è¾“å‡º">4.2. <code>explain</code> è¾“å‡º</h3>
<div class="sect3">
<h4 id="__code_select_type_code">4.2.1. <code>select_type</code></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>SIMPLE</code></dt>
<dd>
<p>ç®€å•SELECT,ä¸ä½¿ç”¨UNIONæˆ–å­æŸ¥è¯¢ç­‰</p>
</dd>
<dt class="hdlist1"><code>PRIMARY</code></dt>
<dd>
<p>æŸ¥è¯¢ä¸­è‹¥åŒ…å«ä»»ä½•å¤æ‚çš„å­éƒ¨åˆ†,æœ€å¤–å±‚çš„selectè¢«æ ‡è®°ä¸ºPRIMARY</p>
</dd>
<dt class="hdlist1"><code>UNION</code></dt>
<dd>
<p>UNIONä¸­çš„ç¬¬äºŒä¸ªæˆ–åé¢çš„SELECTè¯­å¥</p>
</dd>
<dt class="hdlist1"><code>DEPENDENT UNION</code></dt>
<dd>
<p>UNIONä¸­çš„ç¬¬äºŒä¸ªæˆ–åé¢çš„SELECTè¯­å¥ï¼Œå–å†³äºå¤–é¢çš„æŸ¥è¯¢</p>
</dd>
<dt class="hdlist1"><code>UNION RESULT</code></dt>
<dd>
<p>UNIONçš„ç»“æœ</p>
</dd>
<dt class="hdlist1"><code>SUBQUERY</code></dt>
<dd>
<p>å­æŸ¥è¯¢ä¸­çš„ç¬¬ä¸€ä¸ªSELECT</p>
</dd>
<dt class="hdlist1"><code>DEPENDENT SUBQUERY</code></dt>
<dd>
<p>å­æŸ¥è¯¢ä¸­çš„ç¬¬ä¸€ä¸ªSELECTï¼Œå–å†³äºå¤–é¢çš„æŸ¥è¯¢</p>
</dd>
<dt class="hdlist1"><code>DERIVED</code></dt>
<dd>
<p>æ´¾ç”Ÿè¡¨çš„SELECT, FROMå­å¥çš„å­æŸ¥è¯¢</p>
</dd>
<dt class="hdlist1"><code>MATERIALIZED</code></dt>
<dt class="hdlist1"><code>UNCACHEABLE SUBQUERY</code></dt>
<dd>
<p>ä¸€ä¸ªå­æŸ¥è¯¢çš„ç»“æœä¸èƒ½è¢«ç¼“å­˜ï¼Œå¿…é¡»é‡æ–°è¯„ä¼°å¤–é“¾æ¥çš„ç¬¬ä¸€è¡Œ</p>
</dd>
<dt class="hdlist1"><code>UNCACHEABLE UNION</code></dt>
<dd>
<p>==== <code>table</code></p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="__code_partitions_code">4.2.2. <code>partitions</code></h4>

</div>
<div class="sect3">
<h4 id="__code_type_code">4.2.3. <code>type</code></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>system</code></dt>
<dd>
<p>å½“MySQLå¯¹æŸ¥è¯¢æŸéƒ¨åˆ†è¿›è¡Œä¼˜åŒ–ï¼Œå¹¶è½¬æ¢ä¸ºä¸€ä¸ªå¸¸é‡æ—¶ï¼Œä½¿ç”¨è¿™äº›ç±»å‹è®¿é—®ã€‚å¦‚å°†ä¸»é”®ç½®äºwhereåˆ—è¡¨ä¸­ï¼ŒMySQLå°±èƒ½å°†è¯¥æŸ¥è¯¢è½¬æ¢ä¸ºä¸€ä¸ªå¸¸é‡,systemæ˜¯constç±»å‹çš„ç‰¹ä¾‹ï¼Œå½“æŸ¥è¯¢çš„è¡¨åªæœ‰ä¸€è¡Œçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨system</p>
</dd>
<dt class="hdlist1"><code>const</code></dt>
<dt class="hdlist1"><code>eq_ref</code></dt>
<dd>
<p>ç±»ä¼¼refï¼ŒåŒºåˆ«å°±åœ¨ä½¿ç”¨çš„ç´¢å¼•æ˜¯å”¯ä¸€ç´¢å¼•ï¼Œå¯¹äºæ¯ä¸ªç´¢å¼•é”®å€¼ï¼Œè¡¨ä¸­åªæœ‰ä¸€æ¡è®°å½•åŒ¹é…ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å¤šè¡¨è¿æ¥ä¸­ä½¿ç”¨primary keyæˆ–è€… unique keyä½œä¸ºå…³è”æ¡ä»¶</p>
</dd>
<dt class="hdlist1"><code>ref</code></dt>
<dd>
<p>è¡¨ç¤ºä¸Šè¿°è¡¨çš„è¿æ¥åŒ¹é…æ¡ä»¶ï¼Œå³å“ªäº›åˆ—æˆ–å¸¸é‡è¢«ç”¨äºæŸ¥æ‰¾ç´¢å¼•åˆ—ä¸Šçš„å€¼</p>
</dd>
<dt class="hdlist1"><code>fulltext</code></dt>
<dt class="hdlist1"><code>ref_or_null</code></dt>
<dd>
<p>MySQLåœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­åˆ†è§£è¯­å¥ï¼Œæ‰§è¡Œæ—¶ç”šè‡³ä¸ç”¨è®¿é—®è¡¨æˆ–ç´¢å¼•ï¼Œä¾‹å¦‚ä»ä¸€ä¸ªç´¢å¼•åˆ—é‡Œé€‰å–æœ€å°å€¼å¯ä»¥é€šè¿‡å•ç‹¬ç´¢å¼•æŸ¥æ‰¾å®Œæˆã€‚</p>
</dd>
<dt class="hdlist1"><code>index_merge</code></dt>
<dt class="hdlist1"><code>unique_subquery</code></dt>
<dt class="hdlist1"><code>index_subquery</code></dt>
<dt class="hdlist1"><code>range</code></dt>
<dd>
<p>åªæ£€ç´¢ç»™å®šèŒƒå›´çš„è¡Œï¼Œä½¿ç”¨ä¸€ä¸ªç´¢å¼•æ¥é€‰æ‹©è¡Œ</p>
</dd>
<dt class="hdlist1"><code>index</code></dt>
<dd>
<p>Full Index Scanï¼Œindexä¸ALLåŒºåˆ«ä¸ºindexç±»å‹åªéå†ç´¢å¼•æ ‘</p>
</dd>
<dt class="hdlist1"><code>ALL</code></dt>
<dd>
<p>Full Table Scanï¼Œ MySQLå°†éå†å…¨è¡¨ä»¥æ‰¾åˆ°åŒ¹é…çš„è¡Œ</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="__code_possible_keys_code">4.2.4. <code>possible_keys</code></h4>

</div>
<div class="sect3">
<h4 id="__code_key_code">4.2.5. <code>key</code></h4>

</div>
<div class="sect3">
<h4 id="__code_key_len_code">4.2.6. <code>key_len</code></h4>

</div>
<div class="sect3">
<h4 id="__code_ref_code">4.2.7. <code>ref</code></h4>

</div>
<div class="sect3">
<h4 id="__code_rows_code">4.2.8. <code>rows</code></h4>

</div>
<div class="sect3">
<h4 id="__code_filtered_code">4.2.9. <code>filtered</code></h4>

</div>
<div class="sect3">
<h4 id="__code_extra_code">4.2.10. <code>extra</code></h4>

</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="__code_explain_code_å®è·µ">5. <code>EXPLAIN</code> å®è·µ</h2>
<div class="sectionbody">
<div class="paragraph">
<p>å¦‚æœ <code>EXPLAIN</code> æ‰§è¡Œè®¡åˆ’çš„ <code>Extra</code> åˆ—åŒ…å« â€œUsing temporaryâ€ï¼Œåˆ™è¯´æ˜è¿™ä¸ªæŸ¥è¯¢ä½¿ç”¨äº†éšå¼ä¸´æ—¶è¡¨ã€‚</p>
</div>
<div class="paragraph">
<p>å¦‚æœ <code>EXPLAIN</code> æ‰§è¡Œè®¡åˆ’çš„ <code>Extra</code> åˆ—åŒ…å« â€œUsing union(XX,YY,ZZ&#8230;&#8203;)â€ï¼Œåˆ™è¯´æ˜è¿™ä¸ªæŸ¥è¯¢ä½¿ç”¨äº†ç´¢å¼•åˆå¹¶ç­–ç•¥ï¼Œåº”è¯¥æ£€æŸ¥ä¸€ä¸‹æŸ¥è¯¢å’Œè¡¨çš„ç»“æ„ã€‚ P158</p>
</div>
<div class="paragraph">
<p>å½“å‘èµ·ä¸€ä¸ªè¢«ç´¢å¼•è¦†ç›–çš„æŸ¥è¯¢ï¼ˆä¹Ÿå«ä½œç´¢å¼•è¦†ç›–æŸ¥è¯¢ï¼‰æ—¶ï¼Œåœ¨ <code>EXPLAIN</code> çš„ <code>Extra</code> åˆ—å¯ä»¥çœ‹åˆ° â€œUsing indexâ€ çš„ä¿¡æ¯ã€‚ P172</p>
</div>
<div class="paragraph">
<p>å¾ˆå®¹æ˜“æŠŠ <code>Extra</code> åˆ—çš„ â€œUsing indexâ€ å’Œ <code>type</code> åˆ—çš„ â€œindexâ€ ææ··æ·†ã€‚å…¶å®è¿™ä¸¤è€…å®Œå…¨ä¸åŒï¼Œ <code>type</code> åˆ—å’Œè¦†ç›–ç´¢å¼•æ¯«æ— å…³ç³»ï¼›å®ƒåªæ˜¯è¡¨ç¤ºè¿™ä¸ªæŸ¥è¯¢è®¿é—®æ•°æ®çš„æ–¹å¼ï¼Œæˆ–è€…è¯´æ˜¯ MySQL æŸ¥æ‰¾è¡Œçš„æ–¹å¼ã€‚ MySQL æ‰‹å†Œä¸­ç§°ä¹‹ä¸ºè¿æ¥æ–¹å¼ï¼ˆjoin typeï¼‰ã€‚P172è„šæ³¨</p>
</div>
<div class="paragraph">
<p>å¦‚æœ <code>EXPLAIN</code> å‡ºæ¥çš„ <code>type</code> åˆ—çš„å€¼ä¸º â€œindexâ€ï¼Œåˆ™è¯´æ˜ MySQL ä½¿ç”¨äº†ç´¢å¼•æ‰«ææ¥åšæ’åºï¼ˆä¸è¦å’Œ <code>Extra</code> åˆ—çš„ â€œUsing indexâ€ ææ··æ·†ï¼‰ã€‚P175</p>
</div>
<div class="paragraph">
<p><code>EXPLAIN</code> çš„ <code>Extra</code> åˆ—å‡ºç°äº† â€œUsing whereâ€ è¡¨ç¤º MySQL æœåŠ¡å™¨å°†å­˜å‚¨å¼•æ“è¿”å›è¡Œä»¥åå†åº”ç”¨ <code>WHERE</code> è¿‡æ»¤æ¡ä»¶ã€‚P</p>
</div>
<div class="paragraph">
<p>ä» <code>EXPLAIN</code> çš„è¾“å‡ºå¾ˆéš¾åŒºåˆ† MySQL æ˜¯è¦æŸ¥è¯¢èŒƒå›´å€¼ï¼Œè¿˜æ˜¯æŸ¥è¯¢åˆ—è¡¨å€¼ã€‚ <code>EXPLAIN</code> ä½¿ç”¨åŒæ ·çš„è¯â€œrangeâ€æ¥æè¿°è¿™ä¸¤ç§æƒ…å†µã€‚å¯¹äºèŒƒå›´æ¡ä»¶æŸ¥è¯¢ï¼Œ MySQL æ— æ³•å†ä½¿ç”¨èŒƒå›´åˆ—åé¢çš„å…¶ä»–ç´¢å¼•åˆ—äº†ï¼Œä½†æ˜¯å¯¹äºâ€œå¤šä¸ªç­‰å€¼æ¡ä»¶æŸ¥è¯¢â€åˆ™æ²¡æœ‰è¿™ä¸ªé™åˆ¶ã€‚</p>
</div>
<div class="paragraph">
<p>åœ¨ <code>EXPLAIN</code> è¯­å¥ä¸­çš„ <code>type</code> åˆ—ååº”äº†è®¿é—®ç±»å‹ã€‚è®¿é—®ç±»å‹æœ‰å¾ˆå¤šç§ï¼Œä»å…¨è¡¨æ‰«æåˆ°ç´¢å¼•æ‰«æã€èŒƒå›´æ‰«æã€å”¯ä¸€ç´¢å¼•æŸ¥è¯¢ã€å¸¸æ•°å¼•ç”¨ç­‰ã€‚</p>
</div>
<div class="paragraph">
<p>åœ¨ <code>EXPLAIN</code> è¯­å¥ä¸­çš„ <code>type</code> åˆ—ååº”äº†è®¿é—®ç±»å‹ã€‚è®¿é—®ç±»å‹æœ‰å¾ˆå¤šç§ï¼Œä»å…¨è¡¨æ‰«æåˆ°ç´¢å¼•æ‰«æã€èŒƒå›´æ‰«æã€å”¯ä¸€ç´¢å¼•æŸ¥è¯¢ã€å¸¸æ•°å¼•ç”¨ç­‰ã€‚P199</p>
</div>
<div class="paragraph">
<p>ç¬¬äº”ç«  å¤šåˆ—ç´¢å¼• å¦‚æœåœ¨ EXPLAIN ä¸­çœ‹åˆ°æœ‰ç´¢å¼•åˆå¹¶ã€‚å¦‚ä½•æŸ¥çœ‹ï¼Ÿå“ªäº›æŒ‡æ ‡è¡¨æ˜è¿™ä¸ªé—®é¢˜ï¼Ÿ</p>
</div>
<div class="paragraph">
<p>å–æœ€å¤§å€¼æˆ–è€…æœ€å°å€¼æ—¶ï¼Œå¦‚æœæœ‰ç´¢å¼•ï¼Œåˆ™å¯ä»¥ç›´æ¥ä» B-Tree ç´¢å¼•çš„ä¸¤ç«¯å–æ•°æ®ï¼Œåœ¨ <code>EXPLAIN</code> ä¸­å°±å¯ä»¥çœ‹åˆ° <code>Select tables optimized away</code>ã€‚ä»å­—é¢æ„æ€å¯ä»¥çœ‹å‡ºï¼Œå®ƒè¡¨ç¤ºä¼˜åŒ–å™¨å·²ç»ä»æ‰§è¡Œè®¡åˆ’ä¸­ç§»é™¤äº†è¯¥è¡¨ï¼Œå¹¶ä»¥ä¸€ä¸ªå¸¸æ•°å–è€Œä»£ä¹‹ã€‚P211</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">EXPLAIN
<span class="class">SELECT</span>
  f.film_id,
  fa.actor_id
<span class="keyword">FROM</span> film f
  <span class="keyword">INNER</span> <span class="keyword">JOIN</span> film_actor fa <span class="keyword">USING</span> (film_id)
<span class="keyword">WHERE</span> f.film_id = <span class="integer">1</span> <span class="error">\</span>G

*************************** <span class="error">1</span>. <span class="type">row</span> ***************************
           id: <span class="integer">1</span>
  select_type: SIMPLE
        <span class="type">table</span>: f
   partitions: <span class="predefined-constant">NULL</span>
         type: const
possible_keys: <span class="directive">PRIMARY</span>
          <span class="type">key</span>: <span class="directive">PRIMARY</span>
      key_len: <span class="integer">2</span>
          ref: const
         rows: <span class="integer">1</span>
     filtered: <span class="float">100.00</span>
        Extra: <span class="keyword">Using</span> <span class="type">index</span>
*************************** <span class="error">2</span>. <span class="type">row</span> ***************************
           id: <span class="integer">1</span>
  select_type: SIMPLE
        <span class="type">table</span>: fa
   partitions: <span class="predefined-constant">NULL</span>
         type: ref
possible_keys: idx_fk_film_id
          <span class="type">key</span>: idx_fk_film_id
      key_len: <span class="integer">2</span>
          ref: const
         rows: <span class="integer">10</span>
     filtered: <span class="float">100.00</span>
        Extra: <span class="keyword">Using</span> <span class="type">index</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>MySQL åˆ†ä¸¤æ­¥æ¥æ‰§è¡ŒæŸ¥è¯¢ã€‚ç¬¬ä¸€æ­¥ä» <code>film</code> è¡¨æ‰¾åˆ°éœ€è¦çš„è¡Œã€‚å› ä¸ºåœ¨ <code>film_id</code> å­—æ®µä¸Šæœ‰ä¸»é”®ç´¢å¼•ï¼Œæ‰€ä»¥ MySQL ä¼˜åŒ–å™¨çŸ¥é“è¿™åªä¼šè¿”å›ä¸€è¡Œæ•°æ®ï¼Œä¼˜åŒ–å™¨åœ¨ç”Ÿæˆæ‰§è¡Œè®¡åˆ’çš„æ—¶å€™ï¼Œå°±å·²ç»é€šè¿‡ç´¢å¼•ä¿¡æ¯çŸ¥é“å°†è¿”å›å¤šå°‘è¡Œæ•°æ®ã€‚å› ä¸ºä¼˜åŒ–å™¨å·²ç»æ˜ç¡®çŸ¥é“æœ‰å¤šå°‘ä¸ªå€¼ï¼ˆ <code>WHERE</code> æ¡ä»¶ä¸­çš„å€¼ï¼‰éœ€è¦åšç´¢å¼•æŸ¥è¯¢ï¼Œæ‰€ä»¥è¿™é‡Œçš„è¡¨è®¿é—®ç±»å‹æ˜¯ <code>const</code>ã€‚<br>
ç¬¬äºŒæ­¥ï¼ŒMySQL å°†ç¬¬ä¸€æ­¥ä¸­è¿”å›çš„ <code>film_id</code> åˆ—å½“åšä¸€ä¸ªå·²çŸ¥å–å€¼çš„åˆ—æ¥å¤„ç†ã€‚å› ä¸ºä¼˜åŒ–å™¨æ¸…æ¥šå†ç¬¬ä¸€æ­¥æ‰§è¡Œå®Œæˆåï¼Œè¯¥å€¼å°±ä¼šæ˜¯æ˜ç¡®çš„äº†ã€‚æ³¨æ„åˆ°æ­£å¦‚ç¬¬ä¸€æ­¥ä¸­ä¸€æ ·ï¼Œä½¿ç”¨ <code>film_actor</code> å­—æ®µå¯¹è¡¨çš„è®¿é—®ç±»å‹ä¹Ÿæ˜¯ <code>const</code>ã€‚P212</p>
</div>
<div class="paragraph">
<p>å¦‚æœ <code>ORDER BY</code> å­å¥ä¸­çš„æ‰€æœ‰åˆ—éƒ½æ¥è‡ªå…³è”çš„ç¬¬ä¸€ä¸ªè¡¨ï¼Œé‚£ä¹ˆ MySQL åœ¨å…³è”å¤„ç†ç¬¬ä¸€ä¸ªè¡¨çš„æ—¶å€™å°±è¿›è¡Œæ–‡ä»¶æ’åºã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œé‚£ä¹ˆåœ¨ MySQL çš„ <code>EXPLAIN</code> ç»“æœä¸­å¯ä»¥çœ‹åˆ° <code>Extra</code> å­—æ®µä¼šæœ‰ <code>Using filesort</code>ã€‚é™¤æ­¤ä¹‹å¤–çš„æ‰€æœ‰æƒ…å†µï¼ŒMySQL éƒ½ä¼šå…ˆå°†ç®¡ç†çš„ç»“æœå­˜æ”¾åˆ°ä¸€ä¸ªä¸´æ—¶è¡¨ä¸­ï¼Œç„¶ååœ¨æ‰€æœ‰çš„å…³è”éƒ½ç»“æŸåï¼Œå†è¿›è¡Œæ–‡ä»¶æ’åºã€‚è¿™æ—¶ï¼Œåœ¨ MySQL çš„ <code>EXPLAIN</code> ç»“æœçš„ <code>Extra</code> å­—æ®µå¯ä»¥çœ‹åˆ° <code>Using temporary; Using filesort</code>ã€‚<code>LIMIT</code> ä¼šåœ¨æ’åºååº”ç”¨ã€‚P222</p>
</div>
<div class="paragraph">
<p>MySQL 5.6 å½“è¿˜éœ€è¦è¿”å›éƒ¨åˆ†æŸ¥è¯¢ç»“æœæ—¶ï¼Œä¸å†å¯¹æ‰€æœ‰ç»“æœè¿›è¡Œæ’åºã€‚</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
ä»è¿™å¥è¯ä¸­ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œå¦‚æœå¯ä»¥ï¼Œå°½é‡ä½¿ç”¨ä¸€å¼ è¡¨ä¸­çš„å­—æ®µã€‚
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>MySQL 5.0 ä¹‹åçš„ç‰ˆæœ¬ï¼Œåœ¨æŸäº›ç‰¹æ®Šçš„åœºæ™¯ä¸‹æ˜¯å¯ä»¥ä½¿ç”¨æ¾æ•£ç´¢å¼•æ‰«æçš„ï¼Œä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªåˆ†ç»„æŸ¥è¯¢ä¸­éœ€è¦æ‰¾åˆ°åˆ†ç»„çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼š</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">EXPLAIN
<span class="class">SELECT</span>
  actor_id,
  <span class="predefined">max</span>(film_id)
<span class="keyword">FROM</span> film_actor
<span class="keyword">GROUP</span> <span class="keyword">BY</span> actor_id <span class="error">\</span>G

*************************** <span class="error">1</span>. <span class="type">row</span> ***************************
           id: <span class="integer">1</span>
  select_type: SIMPLE
        <span class="type">table</span>: film_actor
   partitions: <span class="predefined-constant">NULL</span>
         type: range
possible_keys: <span class="directive">PRIMARY</span>,idx_fk_film_id
          <span class="type">key</span>: <span class="directive">PRIMARY</span>
      key_len: <span class="integer">2</span>
          ref: <span class="predefined-constant">NULL</span>
         rows: <span class="integer">201</span>
     filtered: <span class="float">100.00</span>
        Extra: <span class="keyword">Using</span> <span class="type">index</span> <span class="keyword">for</span> <span class="keyword">group</span>-<span class="keyword">by</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>åœ¨ <code>EXPLAIN</code> çš„ <code>Extra</code> å­—æ®µæ˜¾ç¤º â€œUsing index for group-byâ€ï¼Œè¡¨ç¤ºè¿™é‡Œå°†ä½¿ç”¨æ¾æ•£ç´¢å¼•æ‰«æã€‚å¦‚æœ MySQL èƒ½å†™ä¸Š â€œloose index probeâ€ï¼Œç›¸ä¿¡ä¼šæ›´å¥½ç†è§£ã€‚P231</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_å‚è€ƒèµ„æ–™">é™„å½• A: å‚è€ƒèµ„æ–™</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://book.douban.com/subject/23008813/">é«˜æ€§èƒ½MySQL</a>&#8201;&#8212;&#8201;å¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªæ–‡æ¡£å°±æ˜¯è¿™æœ¬ä¹¦çš„è¯»ä¹¦ç¬”è®°ã€‚ğŸ˜†</p>
</li>
<li>
<p><a href="https://book.douban.com/subject/24708143/">MySQLæŠ€æœ¯å†…å¹•</a>&#8201;&#8212;&#8201;å’Œä¸Šé¢çš„é‚£æœ¬å‚è€ƒçœ‹æ›´çˆ½ã€‚</p>
</li>
<li>
<p><a href="https://book.douban.com/subject/26419771/">æ•°æ®åº“ç´¢å¼•è®¾è®¡ä¸ä¼˜åŒ–</a>&#8201;&#8212;&#8201;ç¬¬ä¸€æœ¬ä¹¦å¼•ç”¨äº†è¿™æœ¬ä¹¦ï¼Œå»å¹´åˆšåˆšç¿»è¯‘è¿‡æ¥ï¼Œè¯„åˆ†æ¯”ç¬¬ä¸€æœ¬éƒ½é«˜ï¼Œ9.4ï¼ŒæƒŠä¸ºç¥ä½œï¼Œä¸å¯ä¸è¯»ã€‚</p>
</li>
<li>
<p><a href="http://blog.jobbole.com/100349/">å¦‚æœæœ‰äººé—®ä½ æ•°æ®åº“çš„åŸç†ï¼Œå«ä»–çœ‹è¿™ç¯‡æ–‡ç« </a></p>
</li>
<li>
<p><a href="http://blog.codinglabs.org/articles/theory-of-mysql-index.html">MySQLç´¢å¼•èƒŒåçš„æ•°æ®ç»“æ„åŠç®—æ³•åŸç†</a></p>
</li>
<li>
<p><a href="http://bluehawk.monmouth.edu/rclayton/web-pages/s10-305-503/treaps.html">Treaps: CS 305 &amp; 503 Lecture notes</a></p>
</li>
<li>
<p><a href="http://www.csie.ntnu.edu.tw/~u91029/Order.html">æ¼”ç®—æ³•ç­†è¨˜ - Order</a></p>
</li>
<li>
<p><a href="http://blog.csdn.net/tianxueer/article/details/2689117">ç¡¬ç›˜å†…éƒ¨ç¡¬ä»¶ç»“æ„å’Œå·¥ä½œåŸç†è¯¦è§£</a></p>
</li>
<li>
<p><a href="http://elf8848.iteye.com/blog/1731274">ç£ç›˜æ€§èƒ½æŒ‡æ ‡&#8212;&#8203;IOPS ç†è®º</a></p>
</li>
<li>
<p><a href="http://harrywu304.blog.163.com/blog/static/845660320101024111941414/">ç¡¬ä»¶æ€§èƒ½è§£æ(1)-å­˜å‚¨é‡‘å­—å¡”</a></p>
</li>
<li>
<p><a href="http://www.cnblogs.com/zuoxiaolong/p/computer3.html">æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿï¼ˆ1.3ï¼‰---é‡‘å­—å¡”å½¢çš„å­˜å‚¨è®¾å¤‡ã€æ“ä½œç³»ç»Ÿçš„æŠ½è±¡æ¦‚å¿µ</a></p>
</li>
<li>
<p><a href="http://wdxtub.com/vault/csapp-10.html">æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ ç¬¬ 10 è¯¾ Memory Hierarchy</a></p>
</li>
<li>
<p><a href="http://www.daenotes.com/electronics/digital-electronics/magnetic-bubble-memories">Magnetic Bubble Memories</a></p>
</li>
<li>
<p><a href="https://www.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/10_MassStorage.html">Operating Systems: Mass-Storage Structure</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ç‰ˆæƒå£°æ˜">é™„å½• B: ç‰ˆæƒå£°æ˜</h2>
<div class="sectionbody">
<pre>
                                 Apache License
                           Version 2.0, January 2004
                        http://www.apache.org/licenses/

   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

   1. Definitions.

      "License" shall mean the terms and conditions for use, reproduction,
      and distribution as defined by Sections 1 through 9 of this document.

      "Licensor" shall mean the copyright owner or entity authorized by
      the copyright owner that is granting the License.

      "Legal Entity" shall mean the union of the acting entity and all
      other entities that control, are controlled by, or are under common
      control with that entity. For the purposes of this definition,
      "control" means (i) the power, direct or indirect, to cause the
      direction or management of such entity, whether by contract or
      otherwise, or (ii) ownership of fifty percent (50%) or more of the
      outstanding shares, or (iii) beneficial ownership of such entity.

      "You" (or "Your") shall mean an individual or Legal Entity
      exercising permissions granted by this License.

      "Source" form shall mean the preferred form for making modifications,
      including but not limited to software source code, documentation
      source, and configuration files.

      "Object" form shall mean any form resulting from mechanical
      transformation or translation of a Source form, including but
      not limited to compiled object code, generated documentation,
      and conversions to other media types.

      "Work" shall mean the work of authorship, whether in Source or
      Object form, made available under the License, as indicated by a
      copyright notice that is included in or attached to the work
      (an example is provided in the Appendix below).

      "Derivative Works" shall mean any work, whether in Source or Object
      form, that is based on (or derived from) the Work and for which the
      editorial revisions, annotations, elaborations, or other modifications
      represent, as a whole, an original work of authorship. For the purposes
      of this License, Derivative Works shall not include works that remain
      separable from, or merely link (or bind by name) to the interfaces of,
      the Work and Derivative Works thereof.

      "Contribution" shall mean any work of authorship, including
      the original version of the Work and any modifications or additions
      to that Work or Derivative Works thereof, that is intentionally
      submitted to Licensor for inclusion in the Work by the copyright owner
      or by an individual or Legal Entity authorized to submit on behalf of
      the copyright owner. For the purposes of this definition, "submitted"
      means any form of electronic, verbal, or written communication sent
      to the Licensor or its representatives, including but not limited to
      communication on electronic mailing lists, source code control systems,
      and issue tracking systems that are managed by, or on behalf of, the
      Licensor for the purpose of discussing and improving the Work, but
      excluding communication that is conspicuously marked or otherwise
      designated in writing by the copyright owner as "Not a Contribution."

      "Contributor" shall mean Licensor and any individual or Legal Entity
      on behalf of whom a Contribution has been received by Licensor and
      subsequently incorporated within the Work.

   2. Grant of Copyright License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      copyright license to reproduce, prepare Derivative Works of,
      publicly display, publicly perform, sublicense, and distribute the
      Work and such Derivative Works in Source or Object form.

   3. Grant of Patent License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      (except as stated in this section) patent license to make, have made,
      use, offer to sell, sell, import, and otherwise transfer the Work,
      where such license applies only to those patent claims licensable
      by such Contributor that are necessarily infringed by their
      Contribution(s) alone or by combination of their Contribution(s)
      with the Work to which such Contribution(s) was submitted. If You
      institute patent litigation against any entity (including a
      cross-claim or counterclaim in a lawsuit) alleging that the Work
      or a Contribution incorporated within the Work constitutes direct
      or contributory patent infringement, then any patent licenses
      granted to You under this License for that Work shall terminate
      as of the date such litigation is filed.

   4. Redistribution. You may reproduce and distribute copies of the
      Work or Derivative Works thereof in any medium, with or without
      modifications, and in Source or Object form, provided that You
      meet the following conditions:

      (a) You must give any other recipients of the Work or
          Derivative Works a copy of this License; and

      (b) You must cause any modified files to carry prominent notices
          stating that You changed the files; and

      (c) You must retain, in the Source form of any Derivative Works
          that You distribute, all copyright, patent, trademark, and
          attribution notices from the Source form of the Work,
          excluding those notices that do not pertain to any part of
          the Derivative Works; and

      (d) If the Work includes a "NOTICE" text file as part of its
          distribution, then any Derivative Works that You distribute must
          include a readable copy of the attribution notices contained
          within such NOTICE file, excluding those notices that do not
          pertain to any part of the Derivative Works, in at least one
          of the following places: within a NOTICE text file distributed
          as part of the Derivative Works; within the Source form or
          documentation, if provided along with the Derivative Works; or,
          within a display generated by the Derivative Works, if and
          wherever such third-party notices normally appear. The contents
          of the NOTICE file are for informational purposes only and
          do not modify the License. You may add Your own attribution
          notices within Derivative Works that You distribute, alongside
          or as an addendum to the NOTICE text from the Work, provided
          that such additional attribution notices cannot be construed
          as modifying the License.

      You may add Your own copyright statement to Your modifications and
      may provide additional or different license terms and conditions
      for use, reproduction, or distribution of Your modifications, or
      for any such Derivative Works as a whole, provided Your use,
      reproduction, and distribution of the Work otherwise complies with
      the conditions stated in this License.

   5. Submission of Contributions. Unless You explicitly state otherwise,
      any Contribution intentionally submitted for inclusion in the Work
      by You to the Licensor shall be under the terms and conditions of
      this License, without any additional terms or conditions.
      Notwithstanding the above, nothing herein shall supersede or modify
      the terms of any separate license agreement you may have executed
      with Licensor regarding such Contributions.

   6. Trademarks. This License does not grant permission to use the trade
      names, trademarks, service marks, or product names of the Licensor,
      except as required for reasonable and customary use in describing the
      origin of the Work and reproducing the content of the NOTICE file.

   7. Disclaimer of Warranty. Unless required by applicable law or
      agreed to in writing, Licensor provides the Work (and each
      Contributor provides its Contributions) on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
      implied, including, without limitation, any warranties or conditions
      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
      PARTICULAR PURPOSE. You are solely responsible for determining the
      appropriateness of using or redistributing the Work and assume any
      risks associated with Your exercise of permissions under this License.

   8. Limitation of Liability. In no event and under no legal theory,
      whether in tort (including negligence), contract, or otherwise,
      unless required by applicable law (such as deliberate and grossly
      negligent acts) or agreed to in writing, shall any Contributor be
      liable to You for damages, including any direct, indirect, special,
      incidental, or consequential damages of any character arising as a
      result of this License or out of the use or inability to use the
      Work (including but not limited to damages for loss of goodwill,
      work stoppage, computer failure or malfunction, or any and all
      other commercial damages or losses), even if such Contributor
      has been advised of the possibility of such damages.

   9. Accepting Warranty or Additional Liability. While redistributing
      the Work or Derivative Works thereof, You may choose to offer,
      and charge a fee for, acceptance of support, warranty, indemnity,
      or other liability obligations and/or rights consistent with this
      License. However, in accepting such obligations, You may act only
      on Your own behalf and on Your sole responsibility, not on behalf
      of any other Contributor, and only if You agree to indemnify,
      defend, and hold each Contributor harmless for any liability
      incurred by, or claims asserted against, such Contributor by reason
      of your accepting any such warranty or additional liability.

   END OF TERMS AND CONDITIONS

   APPENDIX: How to apply the Apache License to your work.

      To apply the Apache License to your work, attach the following
      boilerplate notice, with the fields enclosed by brackets "{}"
      replaced with your own identifying information. (Don't include
      the brackets!)  The text should be enclosed in the appropriate
      comment syntax for the file format. We also recommend that a
      file or class name and description of purpose be included on the
      same "printed page" as the copyright notice for easier
      identification within third-party archives.

   Copyright {yyyy} {name of copyright owner}

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
</pre>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.1.0<br>
æœ€åæ›´æ–°æ—¶é—´ 2017-02-17 15:19:02 CST
</div>
</div>
</body>
</html>